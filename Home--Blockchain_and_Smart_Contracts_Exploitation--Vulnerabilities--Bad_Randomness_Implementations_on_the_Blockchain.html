<!doctype html>
<html>

<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <title>Bad Randomness Implementations on the Blockchain</title>
  <meta name="generator" content="CherryTree">
  <link rel="stylesheet" href="res/styles3.css" type="text/css" />
</head>

<body>
  <div class='page'>
    <h1 class='title'>Bad Randomness Implementations on the Blockchain</h1><br /><br /><br /><strong>
      <h3>Cryptographic Implementations and Predictable PRNGs</h3>
    </strong><br />Within operations that require random values we generally need a form of randomness coupled with our
    algorithm. If we do not have sufficient randomness and large character sets, we would end up with cryptographic
    collisions or predictable values depending what we are doing. This Is often the case in video game operations and
    data security encryption schemes.<br /><br />What you need to understand is that certain functions often used as
    randomness on the blockchain is not suitable as a source of randomness<br /><br />For Example, the following
    non-exhaustive but often used list of values are not suitable for randomness within sensitive operations. Usage of
    these types of values for any sort of calculation is always suspect for closer review:<br /> ◇ Secret keys in
    private variables<br /> ◇ Block Timestamps<br /> ◇ Block Numbers<br /> ◇ Block Hash values<br /><br /><br /><strong>
      <h3>BlockHash</h3>
    </strong><br />While a hash of a block might seem like a good idea as a random number there are numerous issues with
    it. Firstly a blocknumber is a known value set by a miner that persists for a set length of time and can be queried
    and used in an attacker’s similar algorithm to produce the same result and bypass controls. But there is also an
    underlying vulnerability to this approach when coupled with a blockhash which we will take a look at
    below.<br /><strong><span style="color:#a5452a;">Terrible idea (example)</span></strong><br />
    <div class="codebox">
      <div class="codebox">Function&nbsp;checkWinner()&nbsp;public&nbsp;payable&nbsp;<span
          style="color:#000000;font-weight:400">{</span>&nbsp;<br />&nbsp;&nbsp;&nbsp;&nbsp;If&nbsp;(blockhash(blockNumber)&nbsp;%&nbsp;2&nbsp;==&nbsp;0)&nbsp;{<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Msg.sender.transfer(balance);<br />&nbsp;&nbsp;&nbsp;&nbsp;}<br /><span
          style="color:#000000;font-weight:400">}</span></div>
    </div><br />The issue with this calculation is if that blockNumber <span style="text-decoration:underline;">variable
      is more(&gt;) than 256 blocks(after the 257th block) old it will return Zero</span> and based on the calculation
    the if statement will return true every single time<br /><br />Bibliography:<br />• <a
      href="http://console-cowboys.blogspot.com/2020/10/smart-contract-hacking-final-free.html" target="_blank">http://console-cowboys.blogspot.com/2020/10/smart-contract-hacking-final-free.html</a><br />•
    <a
      href="https://docs.chain.link/docs/get-a-random-number" target="_blank">https://docs.chain.link/docs/get-a-random-number</a><br />•
    <a href="https://nvd.nist.gov/vuln/detail/CVE-2018-14715" target="_blank">https://nvd.nist.gov/vuln/detail/CVE-2018-14715</a><br />•
    <a
      href="https://github.com/cclabsInc/BlockChainExploitation/tree/master/2020_BlockchainFreeCourse/bad_randomness" target="_blank">https://github.com/cclabsInc/BlockChainExploitation/tree/master/2020_BlockchainFreeCourse/bad_randomness</a><br /><br />
  </div>
</body>

</html>