<!doctype html>
<html>
<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <title>example: enumerate Authentication Bypass </title>
  <meta name="generator" content="CherryTree">
  <link rel="stylesheet" href="res/styles3.css" type="text/css" />
</head>
<body>
<div class='page'><h1 class='title'>example: enumerate Authentication Bypass </h1><br/><strong><h3>Authentication Bypass on all the accounts</h3></strong><br />Once we are able to predict the value of Session Tokens of other accounts, we can try to Perform authentication bypass all the accounts!<br />This could be done manually via Burp Repeater, but hat would be quite tedious. <span style="text-decoration:underline;">Let&#39;s automate via Burp Intruder</span>.<br /><br />1. Intercept the request with the vulnerable cookie and send it to Burp Intruder<br />    <a href=""><img src="images/1530-1.png" alt="images/1530-1.png" /></a><br />2. Intruder → Options<br />    <a href=""><img src="images/1530-2.png" alt="images/1530-2.png" /></a><br />3. Configure Intruder to <strong>Grep</strong> the vulnerable cookie<br />    Let&#39;s have Burp automatically detect when the string &quot;Logged-In-User:&quot; appears in the response header (meaning that authentication bypass was potentially successful). <br />    <a href=""><img src="images/1530-3.png" alt="images/1530-3.png" /></a><br />    Scroll down to &quot;Grep - Match&quot;<br />      ▪ Click &quot;Clear&quot; and click &quot;Yes&quot; when asked to conﬁrm<br />      ▪ Enter &quot;Logged-In-User:&quot; in the ﬁeld next to the &quot;Add&quot; button<br />      ▪ Check &quot;Flag result items with responses matching these expressions:&quot; <br />      ▪ Uncheck &quot;Exclude HTTP headers&quot;<br />    <a href=""><img src="images/1530-4.png" alt="images/1530-4.png" /></a><br />4. Configure Intruder change the value of the vulnerable cookie with a Payload<br />   1) Positions → Clear §<br />       <a href=""><img src="images/1530-5.png" alt="images/1530-5.png" /></a><br />   2) Select the value of the cookie to change → Add §<br />       <a href=""><img src="images/1530-6.png" alt="images/1530-6.png" /></a><br />   3) Payloads → Payloads Sets → Payload Type → [chooseThePayload]<br />       <a href=""><img src="images/1530-7.png" alt="images/1530-7.png" /></a><br />   4) Start attack<br />       <a href=""><img src="images/1530-8.png" alt="images/1530-8.png" /></a><br />5.Results<br />    &quot;Payload&quot; column →  we see which value is been used for the vulnerable cookie (uid in our case)<br />    “Logged-In User” column→ This is the Grep that we have configured, if the the box is checked means that “Logged-In User” is contained in the response<br />    <a href=""><img src="images/1530-9.png" alt="images/1530-9.png" /></a></div>
</body>
</html>
