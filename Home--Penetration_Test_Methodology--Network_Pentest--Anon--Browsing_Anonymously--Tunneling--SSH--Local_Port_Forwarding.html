<!doctype html>
<html>
<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <title>Local Port Forwarding</title>
  <meta name="generator" content="CherryTree">
  <link rel="stylesheet" href="res/styles3.css" type="text/css" />
</head>
<body>
<div class='page'><h1 class='title'>Local Port Forwarding</h1><br/><strong>Local Port Forwarding</strong><br />Syntax:<br /><div class="codebox"><div class="codebox">ssh&nbsp;-L&nbsp;&lt;AttackerInterfaceIP&gt;:&lt;AttackerPort&gt;:&lt;TargetIP&gt;:&lt;TargetPort&gt;&nbsp;user@<span style="color:#000000;font-weight:400">&lt;</span>IP_SSH_Server<span style="color:#000000;font-weight:400">&gt;</span></div></div><br />or if we want that our Attacker machine will listen on all interfaces neglect &lt;AttackerInterfaceIP&gt;<br /><div class="codebox"><div class="codebox">ssh&nbsp;-L&nbsp;:&lt;AttackerPort&gt;:&lt;TargetIP&gt;:&lt;TargetPort&gt;&nbsp;user@<span style="color:#000000;font-weight:400">&lt;</span>IP_SSH_Server<span style="color:#000000;font-weight:400">&gt;</span></div></div><br /><a href=""><img src="images/980-1.png" alt="images/980-1.png" /></a><br /><span style="color:#a5452a;">Example:</span><br />We want to tunnel the telnet traffic from our local port 3000, to port 23 of the remote machine 10.0.3.5. The traffic will pass through our SSH server 192.162.6.5<br /><div class="codebox"><div class="codebox">ssh&nbsp;–L&nbsp;3000:10.0.3.5:23&nbsp;root@192.162.6.5</div></div><br />Once the SSH tunnel is up and running, we will have the local port 3000 listening on our machine.<br />We can now establish the connection to the 10.0.3.5 telnet server and the traffic will automatically go through the SSH tunnel, now encrypted.<br /><div class="codebox"><div class="codebox">telnet&nbsp;127.0.0.1:3000</div></div><br /><br /><strong>Local Port Forwarding(to a service)</strong><br />When a service on a target is configured to accept only local connections (127.0.0.1), we can use a SSH tunnel to forward the connection from our machine to the service<br />If we want to target a service that listens on &lt;Service_Port&gt; on the &lt;IP_SSH_Server&gt; and not a Target machine we have to set as &lt;TargetIP&gt; <span style="text-decoration:underline;">localhost</span> or <span style="text-decoration:underline;">127.0.0.1</span> that both refers to the &lt;IP_SSH_Server&gt; itself.<br />Any connection made by an application to the local &lt;AttackerPort&gt; is forwarded to the &lt;IP_SSH_Server&gt; on &lt;Service_Port&gt; where is running the target service<br /><div class="codebox"><div class="codebox">ssh&nbsp;-L&nbsp;&lt;AttackerPort&gt;:localhost:&lt;Service_Port&gt;&nbsp;user@<span style="color:#000000;font-weight:400">&lt;</span>IP_SSH_Server<span style="color:#000000;font-weight:400">&gt;</span></div></div><br />In this way the application running on the Attacker machine believes that the service it is connecting to is running on the Attacker machine itself.<br />While the service on the &lt;IP_SSH_Server&gt; end believes that the connection is coming from the &lt;IP_SSH_Server&gt; itself<br /><span style="color:#a5452a;">Example:</span><br />We want to tunnel the MySQL traffic from our local port 3000, to port 3306 MySQL service on the SSH_Server 192.162.6.5.<br /><div class="codebox"><div class="codebox">ssh&nbsp;–L&nbsp;3000:localhost:3306&nbsp;root@192.162.6.5</div></div><br />Once the SSH tunnel is up and running, we will have the local port 3000 listening on our machine.<br />Now every incoming connection on the localport 3000 will then be forwarded to the service on port localhost:3306 of the SSH_server 192.162.6.5 <br /><div class="codebox"><div class="codebox">mysql&nbsp;-h&nbsp;127.0.0.1&nbsp;-P&nbsp;3000&nbsp;-u&nbsp;root</div></div><br /></div>
</body>
</html>
