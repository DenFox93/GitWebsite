<!doctype html>
<html>
<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <title>hook function pointer (IRP patching)</title>
  <meta name="generator" content="CherryTree">
  <link rel="stylesheet" href="res/styles3.css" type="text/css" />
</head>
<body>
<div class='page'><h1 class='title'>hook function pointer (IRP patching)</h1><br/><span style="text-decoration:underline;">Rootkit hook the Function Pointer of an existing driver(IRP patching)</span>: every driver in the Driver chain has a specific structure named DRIVER_OBJECT<br />    By modifying the addresses of the dispatch routines in <span style="color:#f6ff00;">MajorFunction</span> and <span style="color:#f6ff00;">FastIoDispatch</span> tables, the rootkit code is invoked each time an event occurs.<br />    <a href="file://C:/CherryTree/screenshots2/PTP-elearnsecurity/1. System Security/6 - Malware/IRP patching.png"><img src="images/568-1.png" alt="images/568-1.png" /></a><br /><br /><br /><br /><br /><br /><br />Bibliography: <br />1. Crimeware: Understanding New Attacks and Defenses<br />2. Windows Driver Development Kit<br />3. Rootkit subverting the Windows Kernel by Greg Hoglund<br /></div>
</body>
</html>
