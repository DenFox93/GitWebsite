<!doctype html>
<html>

<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <title>sslstrip+</title>
  <meta name="generator" content="CherryTree">
  <link rel="stylesheet" href="res/styles3.css" type="text/css" />
</head>

<body>
  <div class='page'>
    <h1 class='title'>sslstrip+</h1><br /><strong>
      <h3>HTTP Strict Transport Security (HSTS)</h3>
    </strong><br />SSL Stripping (or SSL Downgrade) does not work anymore with some websites and with newer web browser
    because of a new security feature: HSTS<br />HTTP Strict Transport Security (HSTS) [<a
      href="https://tools.ietf.org/html/rfc6797" target="_blank">https://tools.ietf.org/html/rfc6797</a>] is a security feature
    specified by the <span style="color:#ff8700;">web application</span> or the <span
      style="color:#a020f0;">browser</span> that prevents the protocol downgrade from HTTPS to HTTP<br />These are the
    <span style="color:#a020f0;">browsers</span> that support HSTS: <a
      href="https://caniuse.com/#feat=stricttransportsecurity" target="_blank">https://caniuse.com/#feat=stricttransportsecurity</a><br />The
    HSTS feature anyway does not work if the victim tries the connection to the web application for the first time! This
    because the web browser does not know if the web application use or not a secure connection, since it never received
    the HSTS header.<br /> In order to defeat this issue, web browser implemented the so called “<span
      style="color:#00ff00;">preload lists</span>”, which contain sites that have to be accessed with a secure
    connection, even if it is the first time<br /><strong><span style="color:#00ff00;">preload lists</span></strong>
    <br /> ◇ Chrome → github:<a
      href="https://github.com/chromium/hstspreload" target="_blank">https://github.com/chromium/hstspreload</a> site:<a
      href="https://hstspreload.org/">https://hstspreload.org/</a><br /> ◇ Chromium → <a
      href="https://src.chromium.org/viewvc/chrome/trunk/src/net/http/transport_security_state_static.json" target="_blank">https://src.chromium.org/viewvc/chrome/trunk/src/net/http/transport_security_state_static.json</a><br />
    ◇ Firefox → <a
      href="https://hg.mozilla.org/mozilla-central/file/tip/security/manager/ssl/nsSTSPreloadList.inc" target="_blank">https://hg.mozilla.org/mozilla-central/file/tip/security/manager/ssl/nsSTSPreloadList.inc</a><br /><br /><strong>
      <h3>Bypass HSTS with SSL Stripping+ </h3>
    </strong><br />In order to (partially) bypass HSTS security feature, Leonardo Nve Egea presented at <a
      href="https://www.blackhat.com/docs/asia-14/materials/Nve/Asia-14-Nve-Offensive-Exploiting-DNS-Servers-Changes.pdf" target="_blank">Black
      Hat 2014</a> a new version of the original sslstrip, named <a
      href="https://github.com/singe/sslstrip2" target="_blank">sslstrip+</a>.<br /><a
      href="https://github.com/byt3bl33d3r/MITMf" target="_blank">MitMf</a> is one of the tool that implement <a
      href="https://github.com/singe/sslstrip2" target="_blank">sslstrip+</a> <br /><span style="text-decoration:underline;">How works
      the attack</span><br />1. The attacker first performs a ARP Poisoning MITM attack on the connection between the
    victim and the server, with a tool like arpspoof<br />3. When the victim navigates to <span
      style="color:#0000ff;">www.example.com</span> (not in the HSTS preload list)<br />4. The (attacker) intercept the
    traffic and change <span style="color:#0000ff;">www.example.com</span> to <span
      style="color:#ff1b00;">wwww.example.com</span> (notice the four &#39;<span
      style="color:#ff1b00;">wwww</span>&#39;)<br />5. The victim makes a DNS request for the domain <span
      style="color:#ff1b00;">wwww.example.com</span>, since this <span style="color:#ff1b00;">new link</span> is not in
    any <span style="color:#00ff00;">preload HSTS list</span> of the browser, we can do the SSL downgrade from HTTPS to
    HTTP by sending a response back with our proxy DNS<br />6. We intercept the request, forward the real DNS request
    (<span style="color:#0000ff;">www.example.com</span>) and respond to the victim with a fake domain and the IP
    address<br /><br />
  </div>
</body>

</html>