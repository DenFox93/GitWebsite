<!doctype html>
<html>

<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <title>Insecure Service Executables (insecure file permissions)</title>
  <meta name="generator" content="CherryTree">
  <link rel="stylesheet" href="res/styles3.css" type="text/css" />
</head>

<body>
  <div class='page'>
    <h1 class='title'>Insecure Service Executables (insecure file permissions)</h1><br /><br /><strong>
      <h3>Insecure Service Executables: Replace Service executable with a malicious executable</h3>
    </strong><br />If the user has permissions to write a file into the folder of where the binary of the service is
    located then it is possible to just replace the binary with the a custom payload and then restart the service in
    order to escalate privileges<br />Remember to <span style="text-decoration:underline;">create a backup of the
      original executable</span> if you are exploiting this in a real
    system!<br /><br /><strong>Remediation</strong><br />Privilege escalation through <span
      style="text-decoration:underline;">weak service permission</span> can be re-mediated with properly configuring the
    service permissions and the folders where the service exist. <br /> ◇ Normal user should not be able to start or
    stop the service<br /> ◇ Administrator should only have access to the folder where the binary is stored.<br />If you
    need to take these steps then take a look at Microsoft’s guide:<br /><span style="color:#404040;"> </span><a
      href="https://www.betaarchive.com/wiki/index.php/Microsoft_KB_Archive/914392#Best_practices_and_guidance_for_writers_of_service_discretionary_access_control_lists" target="_blank">https://www.betaarchive.com/wiki/index.php/Microsoft_KB_Archive/914392#Best_practices_and_guidance_for_writers_of_service_discretionary_access_control_lists</a>
  </div>
</body>

</html>