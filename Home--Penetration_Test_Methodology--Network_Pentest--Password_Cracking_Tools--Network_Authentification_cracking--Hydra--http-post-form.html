<!doctype html>
<html>
<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <title>http-post-form</title>
  <meta name="generator" content="CherryTree">
  <link rel="stylesheet" href="res/styles3.css" type="text/css" />
</head>
<body>
<div class='page'><h1 class='title'>http-post-form</h1><br/><strong><h3>Login page</h3></strong><br />In the HTML code of a login page usually we find:<br />• <strong>&lt;form&gt;</strong> tag is used to create an HTML form for user input. The attributes of this tag in which we are interested are:<br />    <table class="table"><tr><th>Attribute</th><th>Value</th><th>Description</th></tr><tr><td>method</td><td>get
post</td><td>Specifies the HTTP method to use when sending form-data</td></tr><tr><td>action</td><td>URL</td><td>Specifies where to send the form-data when a form is submitted</td></tr></table><br />    <a href=""><img src="images/402-1.png" alt="images/402-1.png" /></a><br /><br />   ◇ <strong>&lt;input&gt;</strong> tag specifies an input field where the user can enter data. These elements are used within a &lt;form&gt; element<br />    The attributes of this tag in which we are interested are:<br />    <table class="table"><tr><th>Attribute</th><th>Value</th><th>Description</th></tr><tr><td>name</td><td>text</td><td>Specifies the name of an &lt;input&gt; element</td></tr></table><br />    <a href=""><img src="images/402-2.png" alt="images/402-2.png" /></a><br />    <a href=""><img src="images/402-3.png" alt="images/402-3.png" /></a><br /><br /><br /><strong><h3>Hydra</h3></strong><br />Syntax:<strong> </strong><br /><div class="codebox"><div class="codebox">hydra&nbsp;&lt;server&gt;&nbsp;http-post-form&nbsp;&quot;&lt;url&gt;:&lt;usernameParameter&gt;=^USER^&amp;&lt;passwordParameter&gt;=^PASS^:&lt;condition&nbsp;string&gt;&quot;&nbsp;-L&nbsp;&lt;userList&gt;&nbsp;-P&nbsp;&lt;passwordList&gt;&nbsp;-V&nbsp;-f</div></div><br />• <strong>&lt;server&gt;</strong> → is the target: DNS, IP or 192.168.0.0/24 (this or the -M option)<br />• <strong>http-post-form</strong> → is the <span style="text-decoration:underline;">service</span> that in this case we want to crack<br />• <strong><span style="color:#00ff00;">url</span></strong><strong> </strong>→ url where the form of the application redirect(we can find it also in the parameter action of the &lt;form&gt; element)<br />• <strong><span style="color:#ff0000;">&lt;usernameParameter&gt;</span></strong>=^USER^<strong><span style="color:#ff0000;">&amp;&lt;passwordParameter&gt;</span></strong>=^PASS^<span style="color:#ff0000;"> </span>→ usernameParameter and passwordParameter are the name parameters used for username and password within the form input. While ^USER^ and ^PASS^ are placeholder used by Hydra to know where usernames and passwords that we want to try have to be inserted<br />• <strong>condition string</strong> → pattern string that hydra search in the response to check if a login is invalid(default) or valid<br />    <span style="color:#ff8700;text-decoration:underline;">Invalid</span><span style="text-decoration:underline;"> condition login</span> check (default) is preceded by<span style="color:#ff0000;"> </span><strong><span style="color:#ff8700;">F=</span></strong> →  when hydra tries an username and password, if the response contains the string specified, the login credentials used are marked as <span style="text-decoration:underline;">invalid</span><br />    <span style="color:#0000ff;text-decoration:underline;">Successful</span><span style="text-decoration:underline;"> condition login</span> check is preceded by <strong><span style="color:#0000ff;">S=</span></strong> → when hydra tries an username and password, if the response contains the string specified, the login credentials used are marked as <span style="text-decoration:underline;">valid</span><br />• <strong>-f</strong> → tells to hydra to exit after the first found login<br />• <strong><span style="color:#ff9d00;">|&amp;</span></strong><strong> </strong><strong><span style="color:#ff9d00;">tee</span></strong><strong> output.txt</strong> → the output will be displayed on the screen and also redirected on file<br /><br /><strong>example 1:</strong><br /><code>hydra 10.125.211.99 http-post-form &quot;</code><code><span style="color:#00ff00;">/login.php</span></code><code>:</code><code><span style="color:#ff0000;">email</span></code><code>=^USER^&amp;</code><code><span style="color:#ff0000;">password</span></code><code>=^PASS^:</code><code><span style="color:#ff8700;">F=wrong credentials!</span></code><code>&quot; -L users.usr -P password.txt -V |&amp; tee output.txt</code><br /><br /><strong>example 2:</strong><br /><code>hydra 10.125.211.99 http-post-form &quot;</code><code><span style="color:#00ff00;">/login.php</span></code><code>:</code><code><span style="color:#ff0000;">email</span></code><code>=^USER^&amp;</code><code><span style="color:#ff0000;">password</span></code><code>=^PASS^:</code><code><span style="color:#0000ff;">S=Welcome!</span></code><code>&quot; -L users.usr -P password.txt -V |&amp; tee output.txt</code><br /><br /><strong>command to see which are the valid credentials saved in the output file</strong>:<br /><code>cat output.txt | grep http-post-form</code></div>
</body>
</html>
