<!doctype html>
<html>

<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <title>Bypassing two-factor authentication</title>
  <meta name="generator" content="CherryTree">
  <link rel="stylesheet" href="res/styles3.css" type="text/css" />
</head>

<body>
  <div class='page'>
    <h1 class='title'>Bypassing two-factor authentication</h1><br /><br />This is the same LAB &amp; vulnerability seen
    in the <a
      href="ws--Users_won't_always_follow_the_intended_sequence--2FA_simple_bypass_After_2FA_request_go_directly_to_the_webpage_account_of_the_victim.html">Busisness
      Logic Flaws → User&#39;s won&#39;t always follow the intended sequence
    </a><br /><br />----------------<br /><br />Sometimes the implementation of two-factor authentication is flawed to
    the point where it can be bypassed entirely.<br /><br />If the user is first prompted to enter a password, and <span
      style="text-decoration:underline;">then prompted to enter a verification code on a separate page</span>, the user
    is effectively in a &quot;logged in&quot; state before they have entered the verification code. In this case, it is
    worth testing to see if you can directly skip to &quot;logged-in only&quot; pages after completing the first
    authentication step. Occasionally, you will find that a website doesn&#39;t actually check whether or not you
    completed the second step before loading the page<br /><br /><br /><br /><strong>
      <h3>After 2FA request go directly to the webpage account of the victim</h3>
    </strong><br />In this LAB once we have done the request to login with valid credentials, we try to bypass the
    workflow of the 2FA code and go directly to the account page of the victim.<br /><br /><strong>Discover WebApp 2FA
      Workflow</strong><br />Access with our account to check which pages are visited during the 2FA authentication
    workflow<br />1. POST request to login with our credentials (username &amp; password)<br /> <a href=""><img
        src="images/2085-1.png" alt="images/2085-1.png" /></a><br />2. GET request to get 2FA code on our email<br /> <a
      href=""><img src="images/2085-2.png" alt="images/2085-2.png" /></a><br />3. POST request with our 2FA code
    received in the email<br /> <a href=""><img src="images/2085-3.png" alt="images/2085-3.png" /></a><br />4. GET
    request for the /my-account page<br /> <a href=""><img src="images/2085-4.png"
        alt="images/2085-4.png" /></a><br /><br /><br /><strong>
      <h3>Exploit</h3>
    </strong><br />In the workflow above there is not anything that tie step 3 and 4. <br />What if when we have
    inserted stolen credentials of our victim we can bypass 2FA code by going directly to step 4?<br />1.<br /> <a
      href=""><img src="images/2085-5.png" alt="images/2085-5.png" /></a> <br />2.<br /> <a href=""><img
        src="images/2085-6.png" alt="images/2085-6.png" /></a><br />3. Here, because we have not access to the email of
    the victim with the 2FA code,<br /> <span style="color:#ff0000;">We try to change the URL to navigate
      to /my-account</span>.<br /> <a href=""><img src="images/2085-7.png" alt="images/2085-7.png" /></a><br /> edited
    request below<br /> <a href=""><img src="images/2085-8.png" alt="images/2085-8.png" /></a><br /> Yes we have got
    access to the account of the victim!<br /><br /><br /><strong>Bibliography:</strong><br /><a
      href="https://portswigger.net/web-security/authentication/multi-factor/lab-2fa-simple-bypass" target="_blank">https://portswigger.net/web-security/authentication/multi-factor/lab-2fa-simple-bypass</a><br /><a
      href="https://portswigger.net/web-security/authentication/multi-factor" target="_blank">https://portswigger.net/web-security/authentication/multi-factor</a>
  </div>
</body>

</html>