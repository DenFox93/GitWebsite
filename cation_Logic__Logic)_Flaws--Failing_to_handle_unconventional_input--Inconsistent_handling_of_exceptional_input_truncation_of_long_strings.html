<!doctype html>
<html>
<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <title>Inconsistent handling of exceptional input: truncation of long strings</title>
  <meta name="generator" content="CherryTree">
  <link rel="stylesheet" href="res/styles3.css" type="text/css" />
</head>
<body>
<div class='page'><h1 class='title'>Inconsistent handling of exceptional input: truncation of long strings</h1><br/><br /><h6>WebApp doesn&#39;t adequately validate user input. It truncate very long string.<br />In this WebApp we can realize it when we login to the account with the new registered account<br /></h6><br /><br /><br /><strong>Description of the Web Application</strong><br />• The email client on the site can display all emails @[YOUR-EMAIL-ID].web-security-academy.net and all subdomains, this mean also:<br />   ◇ @a.<span style="color:#ffa500;">[YOUR-EMAIL-ID]</span>.web-security-academy.net<br />   ◇ @b.<span style="color:#ffa500;">[YOUR-EMAIL-ID]</span>.web-security-academy.net<br />   ◇ @a.a.<span style="color:#ffa500;">[YOUR-EMAIL-ID]</span>.web-security-academy.net<br />   ◇ ...<br />• DontWannaCry users have access privileges and the domain of their address is @dontwannacry.com<br /><br /><br /><strong><h3>Vulnerability Check</h3></strong><br /><span style="text-decoration:underline;">If we register with a very long email, how the Server handle it?</span><br /><span style="color:#ff0000;">IC5zZ5rTVgjybsjLfOj2CYkCwgw67qRdFEQ3xJ6vRYGuwYk3lnIrVlJ5yTW6Lngd5uSTfmm9RrO0NWn55R44N7YRVOgt6lqxZA1rWY5d8BxHmSrXGCdKPOepnofcA6vG0wbEqRTAXxHTFu8V6UDFS2YIV2BzJvvwEvPG29nRgYk0cEHgX233dUhNLRL3HMk53eJI97XualkLbzG6qqL3q6pCcw42nQRAfrQumHpTkA4mNB6zmLjxZ4oTUMdqffQFiJpIuhXuQOxaDQju3K0wCah8kos8u0UsotuBluyzVtGu</span>@<span style="color:#ffa500;">exploit-acd11f891e26bd5981851e480196005f</span>.web-security-academy.net<br />    <a href=""><img src="images/1886-1.png" alt="images/1886-1.png" /></a><br />    <a href=""><img src="images/1886-2.png" alt="images/1886-2.png" /></a><br />We can see that our email is been truncated to the <strong>255th</strong> character by eliminating the final part!<br /><br /><strong><h3>Exploit</h3></strong><br />• We want to register with an administrator account with email <span style="color:#a020f0;">@dontwannacry.com</span><br />• To do that register a new account with another long email address, but this time include <span style="color:#a020f0;">dontwannacry.com</span> as a subdomain in your email address as follows:<br />    <span style="color:#ff0000;">[very-long-string]</span><span style="color:#a020f0;">@dontwannacry.com</span>.<span style="color:#ffa500;">[YOUR-EMAIL-ID]</span>.web-security-academy.net<br />• We need to be sure that the very-long-string is the right number of characters so that the &quot;m&quot; at the end of @dontwannacry.com is character 255 exactly. <br />• Because <span style="color:#a020f0;">@dontwannacry.com</span> is 17 characters long, we need a <span style="color:#ff0000;">[very-long-string]</span> of 255-<span style="color:#a020f0;">17</span>=238 characters long<br /> <span style="color:#a52a2a;">example</span>: 00wqKQF7nbf6VqW4w3S91AAJlKQrA1KP7WlYNTTdtAF7XcS4Sir95t0I9tSSIRlPqFq2NuS1hEVKfzgy2Ea2qUJjvatXBlBdPQxDYon22JsLtPLvmkAbFyveUFX80vRaBdZuHOyVPzwLQoReancIqWg0oTnrKt0wa9UoWeWdpa5AmB2JTOoSQNvMngpJZHUg1wavpse8uH4WkUH66c6ZNSkSKoqAil4mDLVXLyJuyHQQWw<span style="color:#a020f0;">@dontwannacry.com</span>.<span style="color:#ffa500;">exploit-acd11f891e26bd5981851e480196005f</span>.web-security-academy.net<br /><br />Great our email now is:<br />     <a href=""><img src="images/1886-3.png" alt="images/1886-3.png" /></a><br /><br />Now we could have access to some parts of the site that before we could not access! Like an Admin Panel!<br />    <a href=""><img src="images/1886-4.png" alt="images/1886-4.png" /></a></div>
</body>
</html>
