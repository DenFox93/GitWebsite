<!doctype html>
<html>

<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <title>Intercept SSL traffic</title>
  <meta name="generator" content="CherryTree">
  <link rel="stylesheet" href="res/styles3.css" type="text/css" />
</head>

<body>
  <div class='page'>
    <h1 class='title'>Intercept SSL traffic</h1><br /><br />To see how SSL work go to this chapter: <a
      href="Cryptography_and_Password_Cracking--Cryptography--Public_Key_Infrastructure_(PKI)--Trust_Chain_(Hierarchical)--Secure_Sockets_Layer_(SSL).html">Secure
      Sockets Layer(SSL)</a><br /><br />When we sniff unencrypted traffic we do no not manipulate the traffic, we just
    intercept it and forward it to the target machine.<br /><br />• <strong>
      <h3>Self signed(fake) certificate:</h3>
    </strong><br />When we have SSL encrypted traffic we have to generate a <span
      style="color:#ff0000;">self-signed(fake)</span> SSL certificate that will be sent to the victim machine every time
    it tries to establish an SSL connections. If the victim user accepts the certificate, then we will be able to
    decrypt the traffic.<br />The problem to generate a <span style="color:#ff0000;">self-signed(fake)</span> SSL
    certificate is that it will likely cause a security exception on the victims machine, most unconscious users anyway
    will just bypass this warning :)<br /><br />• <strong>
      <h3>SSL stripping(SSL downgrade):</h3>
    </strong><br />sslstrip is a MITM tool of Moxie Marlinspike&#39;s that implement the SSL stripping attacks (<a
      href="https://www.blackhat.com/presentations/bh-dc-09/Marlinspike/BlackHat-DC-09-Marlinspike-Defeating-SSL.pdf" target="_blank">Black
      Hat 2009</a>)<br />SSL stripping is a technique by which a website is downgraded from https to http. This is also
    known as SSL downgrading.<br /><br />1. The attacker first performs a MITM attack on the connection between the
    victim and the server. <br />2. Users don’t typically come to SSL-secured sites by typing in a full URL or using a
    bookmarked https://url. Many arrive via a redirect (like the 302 redirect) or an HTTP site which provides a link to
    the secured site. <br />3. The attacker intercepts the insecure HTTP request from the victim and creates an
    independent, legitimate connection to the destination server through HTTPS protocol<br />4. When attackers receive
    the server’s response, the attacker send it to the victim in unencrypted format, posing as the
    server<br /><br />Check this <a
      href="Home--Penetration_Test_Methodology--Network_Pentest--Sniffing-Spoofing-Poisoning--Tools--Sslstrip.html">CHAPTER</a>
    to see how sslstrip work(tool outdated)<br /><a href=""><img src="images/714-1.png"
        alt="images/714-1.png" /></a><br /><br />
    <h3>• </h3><strong>
      <h3>SSL stripping+ to bypass HSTS</h3>
    </strong><br />SSL Stripping (or SSL Downgrade) does not work anymore with some websites and with newer web browser
    because of a new security feature: HSTS<br />HTTP Strict Transport Security (HSTS) [<a
      href="https://tools.ietf.org/html/rfc6797" target="_blank">https://tools.ietf.org/html/rfc6797</a>] is a security feature
    specified by the <span style="color:#ff8700;">web application</span> or the <span
      style="color:#a020f0;">browser</span> that prevents the protocol downgrade from HTTPS to HTTP<br />These are the
    <span style="color:#a020f0;">browsers</span> that support HSTS: <a
      href="https://caniuse.com/#feat=stricttransportsecurity" target="_blank">https://caniuse.com/#feat=stricttransportsecurity</a><br />The
    HSTS feature anyway does not work if the victim tries the connection to the web application for the first time! This
    because the web browser does not know if the web application use or not a secure connection, since it never received
    the HSTS header.<br /> In order to defeat this issue, web browser implemented the so called “<span
      style="color:#00ff00;">preload lists</span>”, which contain sites that have to be accessed with a secure
    connection, even if it is the first time<br /><strong><span style="color:#00ff00;">preload lists</span></strong>
    <br /> ◇ Chrome → github:<a
      href="https://github.com/chromium/hstspreload" target="_blank">https://github.com/chromium/hstspreload</a> site:<a
      href="https://hstspreload.org/" target="_blank">https://hstspreload.org/</a><br /> ◇ Chromium → <a
      href="https://src.chromium.org/viewvc/chrome/trunk/src/net/http/transport_security_state_static.json" target="_blank">https://src.chromium.org/viewvc/chrome/trunk/src/net/http/transport_security_state_static.json</a><br />
    ◇ Firefox → <a
      href="https://hg.mozilla.org/mozilla-central/file/tip/security/manager/ssl/nsSTSPreloadList.inc" target="_blank">https://hg.mozilla.org/mozilla-central/file/tip/security/manager/ssl/nsSTSPreloadList.inc</a><br /><br />In
    order to (partially) bypass HSTS security feature, Leonardo Nve Egea presented at <a
      href="https://www.blackhat.com/docs/asia-14/materials/Nve/Asia-14-Nve-Offensive-Exploiting-DNS-Servers-Changes.pdf" target="_blank">Black
      Hat 2014</a> a new version of sslstrip, named <a href="https://github.com/singe/sslstrip2" target="_blank">sslstrip+</a>.<br /><a
      href="https://github.com/byt3bl33d3r/MITMf" target="_blank">MitMf</a> is one of the tool that implement <a
      href="https://github.com/singe/sslstrip2" target="_blank">sslstrip+</a> <br /><br /><br /><br />Bibliography:<br /><a
      href="https://www.venafi.com/blog/what-are-ssl-stripping-attacks" target="_blank">https://www.venafi.com/blog/what-are-ssl-stripping-attacks</a><br /><br />
  </div>
</body>

</html>