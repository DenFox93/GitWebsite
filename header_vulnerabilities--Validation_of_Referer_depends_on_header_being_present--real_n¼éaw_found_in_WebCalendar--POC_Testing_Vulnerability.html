<!doctype html>
<html>

<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <title>POC: Testing Vulnerability</title>
  <meta name="generator" content="CherryTree">
  <link rel="stylesheet" href="res/styles3.css" type="text/css" />
</head>

<body>
  <div class='page'>
    <h1 class='title'>POC: Testing Vulnerability</h1><br /><strong>
      <h3>POC: Trsting Vulnerability</h3>
    </strong><br />For this test we will use the functionaity of ZAP “Generate Anti CSRF Test FORM” that will create a
    POC based on the POST request. <br />This POC of ZAP will create a webpage that will send a POST request without the
    &quot;Referer&quot; header<br /><br /><br />1. Login to the vulnerable Website<br /> <a href=""><img
        src="images/1607-1.png" alt="images/1607-1.png" /></a><br />2. Go to Settings → MyProfile<br /> <a href=""><img
        src="images/1607-2.png" alt="images/1607-2.png" /></a><br />3. Set a new password<br /> <a href=""><img
        src="images/1607-3.png" alt="images/1607-3.png" /></a><br /> <a href=""><img src="images/1607-4.png"
        alt="images/1607-4.png" /></a><br />4. In ZAP:Double-click on the POST to
    https://example.org/webcalendar/edit_user_handler.php <br /> <a href=""><img src="images/1607-5.png"
        alt="images/1607-5.png" /></a><br /> Then check “Request” to take note of the referer:
    <code>Referer: https://example.org/webcalendar/edit_user.php </code><br /> <a href=""><img src="images/1607-6.png"
        alt="images/1607-6.png" /></a><br />5. Right-click on the POST and choose &quot;<strong>Generate Anti CSRF Test
      FORM</strong>&quot;<br /> <a href=""><img src="images/1607-7.png" alt="images/1607-7.png" /></a><br /> <a
      href=""><img src="images/1607-8.png" alt="images/1607-8.png" /></a><br /> Click on Submit<br /> <a href=""><img
        src="images/1607-9.png" alt="images/1607-9.png" /></a><br />6. This worked because WebCalendar attempts to uses
    the HTTP Referer to check that requests are originating fromsame server… However, this can be easily <span
      style="text-decoration:underline;">defeated by just not sending a referer</span><br /> ZAP does not set a referer
    via the Anti-CSRF Test Form, and a blank referer also passes WebCalendar&#39;s (weak) check.<br /> If fact we can
    check that there is not a &quot;Referer&quot; in the POST sent by the Anti-CSRF Test Form<br /> <a href=""><img
        src="images/1607-10.png" alt="images/1607-10.png" /></a><br />6.
  </div>
</body>

</html>