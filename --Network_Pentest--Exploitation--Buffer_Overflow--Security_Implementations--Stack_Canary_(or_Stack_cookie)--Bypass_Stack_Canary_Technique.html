<!doctype html>
<html>

<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <title>Bypass Stack Canary Technique</title>
  <meta name="generator" content="CherryTree">
  <link rel="stylesheet" href="res/styles3.css" type="text/css" />
</head>

<body>
  <div class='page'>
    <h1 class='title'>Bypass Stack Canary Technique</h1><br /><br />In order to bypass the <strong>Stack Canary</strong>
    Technique, one can try to:<br />• retrieve, guess or calculate the canary value and add it to the payload<br />•
    <span style="color:#ff8700;">overwrite the Exception Handler Structure (SEH)</span><br /><br /><strong>
      <h3>Overwrite the Exception Handler Structure (SEH)</h3>
    </strong><br />This is a method developed by <a
      href="https://www.blackhat.com/presentations/bh-asia-03/bh-asia-03-litchfield.pdf" target="_blank">David Litchfield</a> and is
    based on the fact that when the canary does not match the <span style="color:#a020f0;">exception handler</span> is
    triggered. <br />This security measure can be surpassed if the attacker can overwrite the <span
      style="color:#a020f0;">Structure Exception Handler (SEH)</span> and trigger an exception before the canary value
    is checked; in this way the buffer overflow could still be executed<br />To avoid the overwrite of the Exception
    Handler Structure a new security measure is been introduced: SafeSEH<br /><br /><br /><strong>Interesting
      Articles:</strong><br />bypass Stack Canary Technique: <a
      href="https://www.corelan.be/index.php/2009/09/21/exploit-writing-tutorial-part-6-bypassing-stack-cookies-safeseh-hw-dep-and-aslr/" target="_blank">https://www.corelan.be/index.php/2009/09/21/exploit-writing-tutorial-part-6-bypassing-stack-cookies-safeseh-hw-dep-and-aslr/</a><br />Paper
    of David Litchfield: <a
      href="https://www.blackhat.com/presentations/bh-asia-03/bh-asia-03-litchfield.pdf" target="_blank">https://www.blackhat.com/presentations/bh-asia-03/bh-asia-03-litchfield.pdf</a><br />SEH:
    <a
      href="https://docs.microsoft.com/en-us/windows/win32/debug/structured-exception-handling?redirectedfrom=MSDN" target="_blank">https://docs.microsoft.com/en-us/windows/win32/debug/structured-exception-handling?redirectedfrom=MSDN</a><br />SafeSEH:
    <a
      href="https://docs.microsoft.com/en-us/cpp/build/reference/safeseh-image-has-safe-exception-handlers?redirectedfrom=MSDN&view=vs-2019"  target="_blank">https://docs.microsoft.com/en-us/cpp/build/reference/safeseh-image-has-safe-exception-handlers?redirectedfrom=MSDN&amp;view=vs-2019</a>
  </div>
</body>

</html>