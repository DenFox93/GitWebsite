<!doctype html>
<html>

<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <title>Preventig Session Hijacking via XSS</title>
  <meta name="generator" content="CherryTree">
  <link rel="stylesheet" href="res/styles3.css" type="text/css" />
</head>

<body>
  <div class='page'>
    <h1 class='title'>Preventig Session Hijacking via XSS</h1><br /><br /><strong>
      <h3>Prevention</h3>
    </strong><br />In order to prevent cookie stealing through XSS, we need to set the <strong>HttpOnly</strong> flag.
    That tells the browser to expose the cookie only through HTTP (and HTTPS) requests (no JavaScript, Flash,
    Java)<br /><span style="text-decoration:underline;">Attack Scenario</span> seen in <a
      href="Home--Penetration_Test_Methodology--WebApp_Pentest--Exploitation--Server-side--Session_Tokens_stealing--Session_Abuse.html">XSS
      → How Discovery XSS → Session Abuse</a><br /><br />Before any session-related operation is performed, you should
    run the following instruction:<br />• PHP 5.2.0 and later<br />
    <div class="codebox">
      <div class="codebox"><span
          style="color:#000000;font-weight:400">&lt;</span>?php<br />&nbsp;&nbsp;&nbsp;&nbsp;ini_set(&quot;session.cookie_httponly&quot;,&nbsp;1);<br />?<span
          style="color:#000000;font-weight:400">&gt;</span></div>
    </div><br /> When session_start() is invoked, if a valid session does not already exist, a new one will be
    created.<br />• Tomcat (a Java Servlet and JSP server) version 6.0.19 and later<br />
    <div class="codebox">
      <div class="codebox">
        &lt;Context&gt;<br />&nbsp;&nbsp;&nbsp;&nbsp;&lt;Manager&nbsp;useHttpOnly=&quot;true&quot;&nbsp;/&gt;<br /><span
          style="color:#000000;font-weight:400">&lt;</span>/Context<span
          style="color:#000000;font-weight:400">&gt;</span></div>
    </div><br />• javaee6.0<br /> ◇ setHttpOnly() → This method is used to mark or unmark the cookie HttpOnly<br /> ◇
    isHttpOnly() → This method is used to identify for whether the cookie has been noticed for HttpOnly<br />
    <div class="codebox">
      <div class="codebox">
        Cookie.setHttpOnly(true);<br />boolean&nbsp;bol&nbsp;=&nbsp;cookie.isHttpOnly();<br />out.println(&quot;&lt;br&gt;Cookie&nbsp;is&nbsp;Marked&nbsp;as&nbsp;HttpOnly&nbsp;=&nbsp;&quot;&nbsp;+&nbsp;bol);
      </div>
    </div><br />• .NET<br /> By default, starting from .NET 2.0, the framework sets the HttpOnly attribute for both
    SessionIDs and Forms Authentication cookie<br /><br /><br /><br /><br /><br />Bibliography:<br />• <a
      href="https://owasp.org/www-community/HttpOnly" target="_blank">https://owasp.org/www-community/HttpOnly</a><br />• <a
      href="https://www.programmersought.com/article/42067480022/" target="_blank">https://www.programmersought.com/article/42067480022/</a><br />•
    java ee: <a
      href="https://www.roseindia.net/java/javaee6/servlet3CookieExample.shtml" target="_blank">https://www.roseindia.net/java/javaee6/servlet3CookieExample.shtml</a><br />•
    <a
      href="https://hub.packtpub.com/blocking-common-attacks-using-modsecurity-25-part-2/" target="_blank">https://hub.packtpub.com/blocking-common-attacks-using-modsecurity-25-part-2/</a>
  </div>
</body>

</html>