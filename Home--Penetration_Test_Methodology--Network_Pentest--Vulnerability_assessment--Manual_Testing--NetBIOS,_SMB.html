<!doctype html>
<html>

<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <title>NetBIOS, SMB</title>
  <meta name="generator" content="CherryTree">
  <link rel="stylesheet" href="res/styles3.css" type="text/css" />
</head>

<body>
  <div class='page'>
    <h1 class='title'>NetBIOS, SMB</h1><br /><br />Windows file sharing explanation here: <strong> </strong><a
      href="Home--Penetration_Test_Methodology--Network_Pentest--Vulnerability_assessment--Manual_Testing--NetBIOS,_SMB---p137,139_NetBIOS.html">NetBIOS</a><strong>
    </strong>and <a
      href="Home--Penetration_Test_Methodology--Network_Pentest--Vulnerability_assessment--Manual_Testing--NetBIOS,_SMB---p445_SMB.html">SMB</a><br /><br /><a
      href="https://en.wikipedia.org/wiki/Samba_(software)" target="_blank">Samba</a> is a free software re-implementation of the SMB
    protocol. The name Samba comes from SMB (<a href="https://en.wikipedia.org/wiki/Server_Message_Block" target="_blank">Server Message
      Block</a>), the name of the proprietary protocol used by the Microsoft Windows network file
    system.<br /><br /><strong>
      <h3>Null Sessions Vulnerability</h3>
    </strong><br />Null sessions vulnerability rely on Common Internet File System (CIFS) and Server Message Block (SMB)
    API, that<strong> return information even to an unauthenticated user</strong><br />This type of connection can not
    be established to any typical share but only against <strong><span
        style="text-decoration:underline;">IPC$</span></strong><span style="text-decoration:underline;"> ( inter process
      communication)</span> which allow Windows process to communicate with other process that are on the
    network.<br />Modern OSs are immune from this kind of attack but legacy OSs can still be vulnerable<br />Null
    session attack can be used to enumerate informations like: passwords, system users, system groups, running system
    processes<br /><br />If we find username,password and SMB service active on the remote machine we can gain a shell!
    To do it see this chapter: <br /> <a
      href="Home--Penetration_Test_Methodology--Network_Pentest--Post_Exploitation--Maintain_Access--remote_commands_(Windows).html">Windows
      command line → remote commands</a><br /><br /><strong>
      <h3>Windows machine vulnerable to null sessions</h3>
    </strong><br />0. Find hosts in a network with open TCP ports for file sharing(NetBIOS,SMB)<br /> ◇ nmap -sS -p
    135,139,445 &lt;networkAddresses&gt;<br /> <a href=""><img src="images/407-1.png"
        alt="images/407-1.png" /></a><br />1. List the remote machine table<br /> ◇ Windows: nbtstat -A
    &lt;address&gt;<br /> ◇ Linux: nbtscan -v &lt;address&gt;<br /> ◇ Linux: nmblookup -A &lt;address&gt;<br /> ◇ Linux:
    enum4linux -n &lt;address&gt;<br />2. checking for null session vulnerability.<br /> If we can login successfully
    anonymously but we can not enumerate the shares, we can try to bruteforce and check for weak credentials with
    metasploit module <strong>smb_login</strong><br /> ◇ Windows: net use \\&lt;IP address&gt;\IPC$ &#39;&#39;
    /u:&#39;&#39;<br /> ◇ Linux: smbclient -N -L &lt;address&gt;<br /> ◇ Linux: smbclient //&lt;address&gt;/ipc$
    -N<br />4. enumerating shares(this i<br /> ◇ Windows: net view &lt;address&gt;<br /> ◇ Windows: enum -S
    &lt;address&gt;<br /> ◇ Linux: enum4linux -S &lt;address&gt; <br />5. Copy file on the local machine<br /> ◇ Linux:
    get &lt;remote_file&gt; /home/kali/Desktop/&lt;save_local_file&gt;
  </div>
</body>

</html>