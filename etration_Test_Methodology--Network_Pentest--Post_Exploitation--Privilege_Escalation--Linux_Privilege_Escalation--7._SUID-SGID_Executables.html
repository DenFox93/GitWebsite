<!doctype html>
<html>

<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <title>7. SUID/SGID Executables</title>
  <meta name="generator" content="CherryTree">
  <link rel="stylesheet" href="res/styles3.css" type="text/css" />
</head>

<body>
  <div class='page'>
    <h1 class='title'>7. SUID/SGID Executables</h1><br />To abuse of these executables we do not need to run them with
    sudo like in the chapter <a
      href="Home--Penetration_Test_Methodology--Network_Pentest--Post_Exploitation--Privilege_Escalation--Linux_Privilege_Escalation--5._Sudo.html">Sudo</a><br /><br />•
    <strong>S</strong><strong><span style="color:#1e90ff;">U</span></strong><strong>ID</strong> files get executed with
    the privileges of the file <span style="color:#1e90ff;">owner(user)</span>.<br />• <strong>S</strong><strong><span
        style="color:#ff8700;">G</span></strong><strong>ID</strong> files get executed with the privileges of the file
    <span style="color:#ff8700;">group</span>. If the file is owned by root, it gets executed with root privileges, and
    we may be able to use it to escalate privileges.<br /><br /><strong>Shell Escape Sequences</strong><br />Just as we
    were able to use <a
      href="st_Methodology--Network_Pentest--Post_Exploitation--Privilege_Escalation--Linux_Privilege_Escalation--5._Sudo--shell_escape_(awk_example).html">shell
      escape sequences with programs running via sudo</a>, we can do the same with SUID/SGID files.<br />A list of
    programs with their shell escape sequences can be found here: <a
      href="https://gtfobins.github.io/" target="_blank">https://gtfobins.github.io/</a><br /><br /><strong>No LD_PRELOAD &amp;
      LD_LIBRARY_PATH for executables</strong><br />We cannot use the same LD_PRELOAD and LD_LIBRARY_PATH environment
    variables tricks used in <a
      href="on_Test_Methodology--Network_Pentest--Post_Exploitation--Privilege_Escalation--Linux_Privilege_Escalation--5._Sudo--environment_variables.html">Sudo
      Privilege Escalation</a> because they are disabled by default for SUID files executable, due the obvious security
    risk.<br /><br /><strong>Manually locate files with the SUID or SGID bits set:</strong><br />• SUID and SGID<br />
    <div class="codebox">
      <div class="codebox">
        target@debian:~$&nbsp;find&nbsp;/&nbsp;-type&nbsp;f&nbsp;-a&nbsp;\(&nbsp;-perm&nbsp;-u+s&nbsp;-o&nbsp;-perm&nbsp;-g+s&nbsp;\)&nbsp;-exec&nbsp;ls&nbsp;-l&nbsp;{}&nbsp;\;&nbsp;2&gt;&nbsp;/dev/null&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&lt;---&nbsp;BETTER
      </div>
    </div><br />
    <div class="codebox">
      <div class="codebox">
        target@debian:~$&nbsp;find&nbsp;/&nbsp;-perm&nbsp;-u+s&nbsp;-o&nbsp;-perm&nbsp;-g+s&nbsp;-type&nbsp;f&nbsp;2&gt;/dev/null&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#alternative
      </div>
    </div><br /> <a href=""><img src="images/1305-1.png" alt="images/1305-1.png" /></a><br /> <a href=""><img
        src="images/1305-2.png" alt="images/1305-2.png" /></a><br />• Only SUID <br />
    <div class="codebox">
      <div class="codebox">target@debian:~$&nbsp;find&nbsp;/&nbsp;-perm&nbsp;-u+s&nbsp;-type&nbsp;f&nbsp;2&gt;/dev/null
      </div>
    </div><br />
    <div class="codebox">
      <div class="codebox">
        target@debian:~$&nbsp;find&nbsp;/&nbsp;-perm&nbsp;-04000&nbsp;-type&nbsp;f&nbsp;2&gt;/dev/null&nbsp;&nbsp;&nbsp;&nbsp;#alternative
      </div>
    </div><br />• Only SGID<br />
    <div class="codebox">
      <div class="codebox">target@debian:~$&nbsp;find&nbsp;/&nbsp;-perm&nbsp;-g+s&nbsp;-type&nbsp;f&nbsp;2&gt;/dev/null
      </div>
    </div><br /><br /><br /><strong>Tools:</strong><br />• <a
      href="https://github.com/Anon-Exploiter/SUID3NUM" target="_blank">https://github.com/Anon-Exploiter/SUID3NUM</a><br />
    differentiate from default binaries and more interesting files with SUID<br /> <a href=""><img
        src="images/1305-3.png"
        alt="images/1305-3.png" /></a><br /><br /><br /><br /><strong>Bibliography:</strong><br />• TCM Security: Linux
    Privilege Escalation for Beginners (<a
      href="https://academy.tcm-sec.com/p/linux-privilege-escalation" target="_blank">https://academy.tcm-sec.com/p/linux-privilege-escalation</a>)<br />•
    Tib3rius: Linux Privilege Escalation for OSCP &amp; Beyond! (<a
      href="https://www.udemy.com/course/linux-privilege-escalation/" target="_blank">https://www.udemy.com/course/linux-privilege-escalation/</a>)<br />
  </div>
</body>

</html>