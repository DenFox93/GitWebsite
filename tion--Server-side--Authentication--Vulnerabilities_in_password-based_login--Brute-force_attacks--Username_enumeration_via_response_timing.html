<!doctype html>
<html>

<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <title>Username enumeration via response timing</title>
  <meta name="generator" content="CherryTree">
  <link rel="stylesheet" href="res/styles3.css" type="text/css" />
</head>

<body>
  <div class='page'>
    <h1 class='title'>Username enumeration via response timing</h1><br /><br /><strong>Response times are different when
      insert a password of different length (for a valid account)</strong><br />• To analyze the Response Timing in Burp
    Intruder we need to select the two columns: Response received, Response Completed<br /> <a href=""><img
        src="images/2033-1.png" alt="images/2033-1.png" /></a><br />• Note the Web application has a <span
      style="text-decoration:underline;">IP-based brute-force protection</span> but sometimes we can bypass it if accept
    the header <strong>X-Forwarded-For</strong><br /> <a href=""><img src="images/2033-2.png"
        alt="images/2033-2.png" /></a><br /> In the option grep the error phrase:<br /> <a href=""><img
        src="images/2033-3.png" alt="images/2033-3.png" /></a><br /> <a href=""><img src="images/2033-4.png"
        alt="images/2033-4.png" /></a><br /> Add this header in the response → X-Forwarded-For: §IPaddress§<br /> Here
    we can find a proxy list: <a
      href="https://github.com/ShiftyTR/Proxy-List" target="_blank">https://github.com/ShiftyTR/Proxy-List</a><br /><br /><strong><span
        style="color:#a52a2a;">Example</span></strong><br />1. Pay particular attention to the response times. Notice
    that when the username is invalid, the response time is roughly the same. However, when you enter a valid username
    (your own), the response time is increased depending on the length of the password you entered.<br /> <strong>Pitch
      Fork attack</strong><br /> ◇ X-Forwarded-For header:<br /> <a href=""><img src="images/2033-5.png"
        alt="images/2033-5.png" /></a><br /> ◇ usernames<br /> <a href=""><img src="images/2033-6.png"
        alt="images/2033-6.png" /></a><br /> ◇ password payload options: payloads with increased length<br /> <a
      href=""><img src="images/2033-7.png" alt="images/2033-7.png" /></a><br /><br />2.<strong> Attack to understand the
      behavior of the application</strong>: In <span style="color:#00ff00;">green</span> the correct(our) username, in
    <span style="color:#ff0000;">red</span> the wrong ones<br /> <a href=""><img src="images/2033-8.png"
        alt="images/2033-8.png" /></a><br /> <span style="color:#ffa500;text-decoration:underline;">Note the response
      times</span>. Notice that when the username is invalid, the response time is roughly the same. However, when you
    enter a valid username (your own), the response time is increased depending on the length of the password you
    entered.<br /><br />3. <strong>Enumerate Usernames</strong>. Payloads with different <span
      style="text-decoration:underline;">usernames</span> and different proxies(<span
      style="text-decoration:underline;">X-Forwarded-For</span>) but do not add <span
      style="text-decoration:underline;">password</span> to the payloads(for the password use a long one)<br /> <a
      href=""><img src="images/2033-9.png" alt="images/2033-9.png" /></a><br /> After the attack take note of the
    usernames that have higher Response Time.<br /> repeat 2-3 times to be sure<br /> <a href=""><img
        src="images/2033-10.png" alt="images/2033-10.png" /></a><br /> <a href=""><img src="images/2033-11.png"
        alt="images/2033-11.png" /></a><br /> <a href=""><img src="images/2033-12.png"
        alt="images/2033-12.png" /></a><br /> The usernames that repeat always are “user” and “wiener”(as expected
    because is our username)<br /><br />3. <strong>Password bruteforce on the username found</strong><br /> *Use a
    password wordlist <br /> <a href=""><img src="images/2033-13.png" alt="images/2033-13.png" /></a><br /> Start the
    Burp Intruder attack<br /> <a href=""><img src="images/2033-14.png" alt="images/2033-14.png" /></a><br />
    &quot;klaster&quot; should be the password. So let&#39;s try the combination user:klaster<br /> <a href=""><img
        src="images/2033-15.png" alt="images/2033-15.png" /></a><br /> YES<br />
    <br /><br /><br /><br /><br /><br /><br /><br /><strong>Bibliography:</strong><br /><a
      href="https://portswigger.net/web-security/authentication/password-based/lab-username-enumeration-via-response-timing" target="_blank">https://portswigger.net/web-security/authentication/password-based/lab-username-enumeration-via-response-timing</a>
  </div>
</body>

</html>