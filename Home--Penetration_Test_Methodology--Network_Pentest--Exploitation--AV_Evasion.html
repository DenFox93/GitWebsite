<!doctype html>
<html>

<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <title>AV Evasion</title>
  <meta name="generator" content="CherryTree">
  <link rel="stylesheet" href="res/styles3.css" type="text/css" />
</head>

<body>
  <div class='page'>
    <h1 class='title'>AV Evasion</h1><br /><strong>Some Tactics:</strong><br />• <span
      style="text-decoration:underline;">Ghost Writing</span>: altering the malicious executable in a disassembler or
    hex editor with innocuous machine language instructions(like NOPs instructions) that preserve the behavior of the
    file but alter the file contents so that it doesn&#39;t match antivirus signatures. <br />• <span
      style="text-decoration:underline;">Encoding\encrypting the malware so it does not match signatures</span>: the
    malicious executable can be encoded or encrypted and then applying a decoding/decrypting header in front of
    it<br />• <span style="text-decoration:underline;">Fileless Malware</span>: the malware is directly loaded into
    memory without rely on files and because of that it does not leave footprints.<br /> Without an executable, there is
    no signature for antivirus software to detect and remove. <br /> Usually the initial payload file is often a small
    script that trigger a chain of malware downloads that will be hard to detect because they run in memory(like in
    Powershell)<br />• <span style="text-decoration:underline;">Custom compile the malware</span>: by custom compiling
    the malware and choosing different instructions and different compiler options, the resulting malware likely
    won&#39;t match the antivirus signature<br /><br /><br /><strong>Approach for evading AV</strong>(Antivirus)<br />•
    In a penetration test, we don not need to evade every possible AV product, we need to evade only the one(or two)
    used by the target organization!<br />• To determine the antivirus used by the target organization we can:<br /> ◇
    emails footers that proclaims the antivirus product that scanned files attachments with the email<br /> <a
      href=""><img src="images/1076-1.png" alt="images/1076-1.png" /></a><br /> ◇ <a
      href="Home--Penetration_Test_Methodology--Network_Pentest--Vulnerability_assessment--Manual_Testing--DNS--DNS_Cache_Snooping.html">DNS
      cache snooping</a> (this is instead the module <a
      href="est--Recoinnaissance_(OSINT_Open_Source_Information_Gathering)--Infrastructure_Information_Gathering--Tool_recon-ng--Modules--cache_snoop.html">cache_snoop</a>
    of Recon-ng)<br /> ◇ Simply ask to the the target organization&#39;s employees <br /><br /><strong>VirusTotal.com
      and other online Virus Scanners </strong><br />Virustotal.com lets you scan uploaded files with more than 50
    different AV engines<br />• Note that Virustotal will share the received samples with the antivirus vendors who
    participate in its service<br /> This can be counterproductive for pen testers because Vendors can then create a
    signature and block that file from executing going forward, which could severely limit your penetration test in the
    next future<br />• with virustotal.com, so you can send also only <a
      href="https://www.virustotal.com/gui/home/search" target="_blank">the hash of the file</a> (instead of the file itself) to see if
    it matches the hashes of any known malware. Also if the hash may not be detected, while your malware might be
    detected<br /><br />There are also other online scanners, some of which have a policy of NOT sharing with antivirus
    vendors the received samples<br />These smaller sites unfortunately tend to appear and then disappear
    frequently<br />Because of that is better buying a copy of the target&#39;s Antivirus tool and run it in our
    lab<br /><br /><strong>To know more:</strong><br />• <a
      href="https://wikileaks.org/ciav7p1/cms/files/BypassAVDynamics.pdf" target="_blank">https://wikileaks.org/ciav7p1/cms/files/BypassAVDynamics.pdf</a>
  </div>
</body>

</html>