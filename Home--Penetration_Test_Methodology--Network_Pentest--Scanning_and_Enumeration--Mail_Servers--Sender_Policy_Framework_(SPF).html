<!doctype html>
<html>

<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <title>Sender Policy Framework (SPF)</title>
  <meta name="generator" content="CherryTree">
  <link rel="stylesheet" href="res/styles3.css" type="text/css" />
</head>

<body>
  <div class='page'>
    <h1 class='title'>Sender Policy Framework (SPF)</h1><br /><br /><strong>Sender Policy Framework (SPF)
    </strong><br />SPF prevent attacker(usually spammers) from spoofing their source email addresses and changing it
    with a reputable address.<br />Creating an SPF record block spammers to use your domain. The SPF record will be
    checked by other servers<br />A mail transfer agent(MTA) can perform a DNS lookup to verify this information before
    accepting any mail.<br />An SPF record is a TXT record stored in the DNS zone file. A TXT record can contain
    free-form or formatted text,however, an SPF record is written in a specific format.<br /><br /><span
      style="text-decoration:underline;">To check if the source Ip address of an email is been spoofed</span><br />1.
    First we have to check the <a
      href="gy--Network_Pentest--Recoinnaissance_(OSINT_Open_Source_Information_Gathering)--Document_Metadata_Analysis--email_metadata--Email_headers.html">metadata
      of the email</a><br />2. In particular check the header <strong>Received-SPF</strong><br /> <a href=""><img
        src="images/1045-1.png" alt="images/1045-1.png" /></a><br /> <span style="color:#00ff00;">pass</span> mean that
    the recipient’s mail server (google.com) has checked and everything is in order<br />3. What we have to control is
    that the <span style="color:#a020f0;">client-ip</span> is the SPF record of the <span
      style="color:#ff0000;">domain</span><br />
    <div class="codebox">
      <div class="codebox">
        dig&nbsp;-t&nbsp;TXT&nbsp;bounce.comms.vueling.com&nbsp;+short<br />dig&nbsp;-t&nbsp;TXT&nbsp;cust-spf.exacttarget.com&nbsp;+short
      </div>
    </div><br /> <a href=""><img src="images/1045-2.png" alt="images/1045-2.png" /></a><br /> YES
    verified!<br /><br /><em>Domain Keys Identified Mail (DKIM) and Domain-based Message Authentication, Reporting, and
      Conformance (DMARC) are additional technologies that work with Public Key Infrastructure (PKI) to prevent phishing
      attacks by adding authentication that an email originated from a target domain<br /><br /></em><strong>
      <h3>Vulnerability:</h3>
    </strong><br />1. First we have to check that a domain have a Mail Server(MX) otherwise means that is not used for
    emails<br />
    <div class="codebox">
      <div class="codebox">dig&nbsp;-t&nbsp;mx&nbsp;dell.com&nbsp;+short</div>
    </div><br />3. Check SPF record<br /> 1) To check spf record is possible use <a
      href="https://www.kitterman.com/" target="_blank">https://www.kitterman.com/</a> or dig<br />
    <div class="codebox">
      <div class="codebox">dig&nbsp;-t&nbsp;txt&nbsp;dell.com&nbsp;|&nbsp;grep&nbsp;v=spf1</div>
    </div><br /> 2) To test if an spf record is valid we can use <a
      href="https://www.kitterman.com/" target="_blank">https://www.kitterman.com/</a><br />2. forge fake email using <a
      href="https://emkei.cz/" target="_blank">https://emkei.cz/</a> , set the domain of the email equal to the domain of the
    target<br /> If we use this or any public website to forge fake email, the emails will be marked anyway as spam
    because received from the MTA emkei.cz that usually is associated with fake emails<br /> <a href=""><img
        src="images/1045-3.png" alt="images/1045-3.png" /></a><em><br /></em>4. A mail server could be vulnerable if it
    use ?all or +all instead of -all. Or could be vulnerable if it not use “all” at all<br /> If the email does not go
    in the spam folder, the mail server is vulnerable because the TXT record is malformed<br /> ◇ Temporary email like
    <a href="https://getnada.com/" target="_blank">https://getnada.com/</a> should anyway receive fake emails because they are not
    filtered<br /> ◇ Gmail will put spam email in the SPAM folder<em><br /><br /><br />Bibliography:<br />• </em><a
      href="https://www.pair.com/support/kb/what-is-an-spf/" target="_blank">https://www.pair.com/support/kb/what-is-an-spf/</a>
  </div>
</body>

</html>