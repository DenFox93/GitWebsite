<!doctype html>
<html>
<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <title>Bypass Login</title>
  <meta name="generator" content="CherryTree">
  <link rel="stylesheet" href="res/styles3.css" type="text/css" />
</head>
<body>
<div class='page'><h1 class='title'>Bypass Login</h1><br/><strong><h3>Usually used for:</h3></strong><br />• <a href="on_Test_Methodology--WebApp_Pentest--Exploitation--Server-side--SQL_injections(SQLi)--Visibility_of_SQLi--In-Band-Inline-UNION_based_SQLi.html">In-Band/Inline based SQLi</a><br />• <a href="ology--WebApp_Pentest--Exploitation--Server-side--SQL_injections(SQLi)--Visibility_of_SQLi--Blind_SQLi_Boolean-Binary_Based_SQL_injection.html">Blind SQLi: Boolean/Binary Based SQL injection</a><br /><br /><strong><h3>Bypass login Logic<br /></h3></strong>Example of a normal SQL query that validate the login<br /><code>SELECT * FROM users WHERE username = ‘</code><code><span style="color:#f6ff00;">admin</span></code><code>’ AND password = ‘password’</code><br />if an attacker don&#39;t know the password but only that exist an username <span style="color:#f6ff00;">admin</span><br />Can try to exploit the database and instead of <span style="color:#f6ff00;">admin</span> we insert the payload <span style="color:#f6ff00;">admin’--</span><br />So that the first string terminator(<strong><span style="color:#f6ff00;">&#39;</span></strong>) will end the username parameter requested, and the SQL comment (<strong><span style="color:#f6ff00;">--</span></strong>) <strong>causes the last part of the query to be </strong><strong><span style="text-decoration:underline;">ignored</span></strong><strong> and the password check is bypassed</strong><br />So the modified query is:<br /><code>SELECT * FROM users WHERE username = ‘</code><code><span style="color:#f6ff00;">admin’--</span></code><code> AND password = ‘idonotknow’</code><br />That is equal to:<br /><code>SELECT * FROM users WHERE username = ‘</code><code><span style="color:#f6ff00;">admin’</span></code><br /><strong><h3><br />• Bypass Login:  If we do </h3></strong><strong><h3>not know</h3></strong><strong><h3> any username </h3></strong><br />    if an attacker don&#39;t know anything neither the username neither the password <br />    Can try to exploit the database and instead of the <span style="color:#f6ff00;">username</span> we insert the payload <span style="color:#f6ff00;">’ or 1=1;--</span> <span style="color:#f6ff00;">-</span><br />    <strong><span style="color:#f6ff00;">&#39; </span></strong>→ the string terminator will end the empty username parameter, <br />    <span style="color:#f6ff00;">or 1=1</span> → the boolean condition is always true and so the username will be always valid <br />    <strong><span style="color:#f6ff00;">;-- - </span></strong>→  the SQL comment () <strong>causes the last part of the query to be </strong><strong><span style="text-decoration:underline;">ignored</span></strong><strong> and the password check is bypassed</strong><br />    So the modified query is:<br />    <code>SELECT * FROM users WHERE username = ‘</code><code><span style="color:#f6ff00;">’ or 1=1;--</span></code><code> </code><code><span style="color:#f6ff00;">-</span></code><code> AND password = ‘idonotknow’;</code><br />    That is equal to:<br />    <code>SELECT * FROM users WHERE username = ‘</code><code><span style="color:#f6ff00;">’ or 1=1;--</span></code><code> </code><code><span style="color:#f6ff00;">-</span></code><br />    <a href=""><img src="images/1536-1.png" alt="images/1536-1.png" /></a><br />    <a href=""><img src="images/1536-2.png" alt="images/1536-2.png" /></a><br /><br /><br /><br />• <strong><h3>Bypass Login: if we </h3></strong><strong><h3>know</h3></strong><strong><h3> a username<br /></h3></strong>    Example of a normal SQL query that validate the login<br />    <code>SELECT * FROM users WHERE username = ‘</code><code><span style="color:#f6ff00;">admin@ecorp.com</span></code><code>’ AND password = ‘password’;</code><br />    if an attacker don&#39;t know the password but only that exist an username <span style="color:#f6ff00;">admin@ecorp.com</span><br />    Can try to exploit the database and instead of <span style="color:#f6ff00;">admin@ecorp.com</span> we insert the payload <span style="color:#f6ff00;">admin@ecorp.com</span><span style="color:#f6ff00;">’;--</span> <span style="color:#f6ff00;">-</span><br />    So that the string terminator(<strong><span style="color:#f6ff00;">&#39;</span></strong>) will end the username parameter requested, and the SQL comment (<strong><span style="color:#f6ff00;">;-- -</span></strong>) <strong>causes the last part of the query to be </strong><strong><span style="text-decoration:underline;">ignored</span></strong><strong> and the password check is bypassed</strong><br />    So the modified query is:<br />    <code>SELECT * FROM users WHERE username = ‘</code><code><span style="color:#f6ff00;">admin@ecorp.com</span></code><code><span style="color:#f6ff00;">’;--</span></code><code> </code><code><span style="color:#f6ff00;">-</span></code><code> AND password = ‘idonotknow’;</code><br />    That is equal to:<br />    <code>SELECT * FROM users WHERE username = ‘</code><code><span style="color:#f6ff00;">admin@ecorp.com</span></code><code><span style="color:#f6ff00;">’;--</span></code><code> </code><code><span style="color:#f6ff00;">-</span></code><br /><br />    <a href=""><img src="images/1536-3.png" alt="images/1536-3.png" /></a><br />    <a href=""><img src="images/1536-4.png" alt="images/1536-4.png" /></a><br /><br /><br /><br /><br /><strong><br />bibliography:</strong><br />    The Web Application Hacker&#39;s Handbook</div>
</body>
</html>
