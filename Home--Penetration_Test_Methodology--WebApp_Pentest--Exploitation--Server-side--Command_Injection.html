<!doctype html>
<html>

<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <title>Command Injection</title>
  <meta name="generator" content="CherryTree">
  <link rel="stylesheet" href="res/styles3.css" type="text/css" />
</head>

<body>
  <div class='page'>
    <h1 class='title'>Command Injection</h1><br /><br /><strong>Testing for Command Injection (OTG-INPVAL-013)</strong>:
    <a
      href="https://wiki.owasp.org/index.php/Testing_for_Command_Injection_(OTG-INPVAL-013)" target="_blank">https://wiki.owasp.org/index.php/Testing_for_Command_Injection_(OTG-INPVAL-013)</a><br />Command
    injection enables us to input operating system commands through the web application<br />Commands sent in are geared
    to two types of results:<br /> ◇ Local Results<br /> ◇ Remote Results<br /><br />Command injection involves
    attacker-controlled input being used in OS commands. <br />Focus particularly on resources that appear to be used on
    the system<br /> ▪ New accounts require a directory to store configs<br /> ▪ Application accepts a username
    parameter<br /> ▪ It then runs mkdir username<br /> ▪ ...<br /><br /><strong>An injection can cause two types of
      results</strong><br /> ◇ <span style="text-decoration:underline;">Visible Results</span>: results are returned to
    the browser<br /> <span style="color:#a5452a;">example</span>:<br /> ▪ <code>; ls /etc</code> → <code>;</code> ends
    previous command while <code>ls /etc</code> lists the files in the machine<br /> ▪ <a
      href="Home--Penetration_Test_Methodology--WebApp_Pentest--Exploitation--Server-side--Command_Injection--example_DNS_Lookup_(Visible_Results).html">example:
      DNS Lookup (Visible Results)</a><br /> ◇ <span style="text-decoration:underline;">Blind Results</span>: results
    aren&#39;t displayed in the browser<br /> <span style="color:#a5452a;">example</span>:<br /> ▪
    <code>; ping &lt;attackerAddress&gt;</code> → <code>;</code> ends previous command and then ping our address. To
    intercept the request we need to run a sniffer on our machine and look for ICMP echo requests from the
    target.<br /><br /><br /><strong>&amp;&amp; or ;</strong><br />One of the Method to exploit some command injection
    ﬂaws is to append commands with &quot;&amp;&amp;&quot; or &quot;;&quot;<br /> ◇ &amp;&amp; → Double ampersand means:
    run the second command if the ﬁrst command exits without error<br /> ◇ ; → Semicolon means: run the second command
    after the ﬁrst command (regardless of any errors)
  </div>
</body>

</html>