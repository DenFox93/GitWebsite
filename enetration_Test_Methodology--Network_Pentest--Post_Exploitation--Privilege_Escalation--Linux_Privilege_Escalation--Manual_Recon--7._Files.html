<!doctype html>
<html>

<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <title>7. Files</title>
  <meta name="generator" content="CherryTree">
  <link rel="stylesheet" href="res/styles3.css" type="text/css" />
</head>

<body>
  <div class='page'>
    <h1 class='title'>7. Files</h1><br /><br /><strong>Files and directories that have world-writable
      permissions</strong><br />Files with world-writable permissions can be modified by any user on the system<br /> ◇
    <span style="text-decoration:underline;">world writable directories</span>:<br />
    <div class="codebox">
      <div class="codebox">
        find&nbsp;/&nbsp;\(&nbsp;-wholename&nbsp;&#39;/home/homedir*&#39;&nbsp;-prune&nbsp;\)&nbsp;-o&nbsp;\(&nbsp;-type&nbsp;d&nbsp;-perm&nbsp;-0002&nbsp;\)&nbsp;-exec&nbsp;ls&nbsp;-ld&nbsp;&#39;{}&#39;&nbsp;&#39;;&#39;&nbsp;2&gt;/dev/null&nbsp;|&nbsp;grep&nbsp;-v&nbsp;root
      </div>
    </div><br /> ◇ <span style="text-decoration:underline;">world writable directories for root</span>:<br />
    <div class="codebox">
      <div class="codebox">
        find&nbsp;/&nbsp;\(&nbsp;-wholename&nbsp;&#39;/home/homedir*&#39;&nbsp;-prune&nbsp;\)&nbsp;-o&nbsp;\(&nbsp;-type&nbsp;d&nbsp;-perm&nbsp;-0002&nbsp;\)&nbsp;-exec&nbsp;ls&nbsp;-ld&nbsp;&#39;{}&#39;&nbsp;&#39;;&#39;&nbsp;2&gt;/dev/null&nbsp;|&nbsp;grep&nbsp;root&nbsp;
      </div>
    </div><br /> ◇ <span style="text-decoration:underline;">world writable files</span>:<br />
    <div class="codebox">
      <div class="codebox">
        find&nbsp;/&nbsp;\(&nbsp;-wholename&nbsp;&#39;/home/homedir/*&#39;&nbsp;-prune&nbsp;-o&nbsp;-wholename&nbsp;&#39;/proc/*&#39;&nbsp;-prune&nbsp;\)&nbsp;-o&nbsp;\(&nbsp;-type&nbsp;f&nbsp;-perm&nbsp;-0002&nbsp;\)&nbsp;-exec&nbsp;ls&nbsp;-l&nbsp;&#39;{}&#39;&nbsp;&#39;;&#39;&nbsp;2&gt;/dev/null
      </div>
    </div><br /> ◇ <span style="text-decoration:underline;">world-writable files in /etc:</span><br />
    <div class="codebox">
      <div class="codebox">find&nbsp;/etc&nbsp;-perm&nbsp;-2&nbsp;-type&nbsp;f&nbsp;2&gt;/dev/null</div>
    </div><br /> ◇ <span style="text-decoration:underline;">searches for world-writable directories:</span><br />
    <div class="codebox">
      <div class="codebox">find&nbsp;/&nbsp;-writable&nbsp;-type&nbsp;d&nbsp;2&gt;/dev/null</div>
    </div><br /><br /><strong>Find files that are own by other users</strong><br /> ◇ readable by our actual user but
    own by another user<br />
    <div class="codebox">
      <div class="codebox">find&nbsp;/&nbsp;-perm&nbsp;/u=r&nbsp;-user&nbsp;[USER]&nbsp;2&gt;/dev/null</div>
    </div><br /> ◇ writable by our actual user but own by another user<br />
    <div class="codebox">
      <div class="codebox">find&nbsp;/&nbsp;-perm&nbsp;/u=w&nbsp;-user&nbsp;[USER]&nbsp;2&gt;/dev/null</div>
    </div><br /><br /><br /><br /><br /><strong>list open files</strong>(<a
      href="https://en.wikipedia.org/wiki/Lsof" target="_blank">https://en.wikipedia.org/wiki/Lsof</a>)<br />
    <div class="codebox">
      <div class="codebox">target@linux:~$&nbsp;lsof</div>
    </div><br /><br /><br /><strong>Find files</strong><br /> ◇ Find Files with “history” In Their Name (.bash_history,
    etc.)<br />
    <div class="codebox">
      <div class="codebox">find&nbsp;/*&nbsp;-name&nbsp;*.*history*&nbsp;-print&nbsp;2&gt;&nbsp;/dev/null</div>
    </div><br /> ◇ Find Files Owned By A Particular User<br />
    <div class="codebox">
      <div class="codebox">find&nbsp;/&nbsp;-user&nbsp;$user</div>
    </div><br /> <span style="color:#a5452a;">example:</span> find / -user www-data<br /> ◇ Apache access.log file, grep
    for “user” and “pass” strings<br />
    <div class="codebox">
      <div class="codebox">cat&nbsp;/var/log/apache/access.log&nbsp;|grep&nbsp;-E&nbsp;&quot;^user|^pass&quot;</div>
    </div><br /> ◇ Dump cleartext Pre-Shared Wireless Keys from Network Manager<br />
    <div class="codebox">
      <div class="codebox">
        cat&nbsp;/etc/NetworkManager/system-connections/*&nbsp;|grep&nbsp;-E&nbsp;&quot;^id|^psk&quot;</div>
    </div><br /> ◇ Find Files Owned By A Particular Group<br />
    <div class="codebox">
      <div class="codebox">find&nbsp;/&nbsp;-group&nbsp;$group</div>
    </div><br /> <span style="color:#a5452a;">example:</span> find / -group sudo <br /> ◇ Find File Types Owned by a
    Particular User<br />
    <div class="codebox">
      <div class="codebox">find&nbsp;/&nbsp;-user&nbsp;admin&nbsp;-name&nbsp;“*.sh”</div>
    </div><br /> ◇ search for id_rsa file<br />
    <div class="codebox">
      <div class="codebox">find&nbsp;/&nbsp;-name&nbsp;id_rsa&nbsp;2&gt;&nbsp;/dev/null</div>
    </div><br /> <a href=""><img src="images/917-1.png" alt="images/917-1.png" /></a><br />
  </div>
</body>

</html>