<!doctype html>
<html>

<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <title>Example Exploitation JSON</title>
  <meta name="generator" content="CherryTree">
  <link rel="stylesheet" href="res/styles3.css" type="text/css" />
</head>

<body>
  <div class='page'>
    <h1 class='title'>Example Exploitation JSON</h1><br /><br />Vulnerable VM Multidae: <a
      href="https://sourceforge.net/projects/mutillidae/" target="_blank">https://sourceforge.net/projects/mutillidae/</a><br /> OWASP
    2017 → A1 - Injection (Other) → JavaScript Object Notation (JSON) Injection → Pen Test Tool Lookup (AJAX)
    <br /><br />Click on “Lookup Tool”<br /><a href=""><img src="images/1600-1.png"
        alt="images/1600-1.png" /></a><br /><br />Check Response in the proxy<br /><a href=""><img
        src="images/1600-2.png" alt="images/1600-2.png" /></a><br /><br /><strong>
      <h3>Exploit an XSS ﬂaw in the JSON AJAX object and create a JavaScript alert</h3>
    </strong><br />1. Intercept the traffic with Burp<br />2. Try to force an error by appending a double quote to the
    request we are doing. We use double quote instead of a single because JSON objects uses double quotes<br /> <a
      href=""><img src="images/1600-3.png" alt="images/1600-3.png" /></a><br />3. Go back on the Browser and check for
    errors<br /> <a href=""><img src="images/1600-4.png" alt="images/1600-4.png" /></a><br /> Notice:<br /> ▪ the extra
    double quote &quot; after the tool number in the error message<br /> ▪ The error says: Error Message: missing }
    after property list JSON Response<br />4. Because of the previous error says missing } next step to us is append a }
    with the Interception Proxy<br /> <a href=""><img src="images/1600-5.png" alt="images/1600-5.png" /></a><br />5. Go
    back on the Browser and check for errors<br /> <a href=""><img src="images/1600-6.png"
        alt="images/1600-6.png" /></a><br /> Notice:<br /> ▪ the extra &quot;} after the tool number in the error
    message<br /> ▪ The error says: Error Message: missing } after property list JSON Response<br />6. Let&#39;s follow
    the error and append another &quot;}&quot;. Two &quot;}&quot; characters make sense, as they would balance the two
    &quot;{&quot; characters in the original JSON object of the response.<br /> <a href=""><img src="images/1600-7.png"
        alt="images/1600-7.png" /></a><br /> <a href=""><img src="images/1600-8.png"
        alt="images/1600-8.png" /></a><br />7. Go back on the Browser and check for errors<br /> <a href=""><img
        src="images/1600-9.png" alt="images/1600-9.png" /></a><br /> Notice:<br /> ▪ the extra &quot;}} after the tool
    number in the error message<br /> ▪ The error says: Error Message: missing ) after property list JSON Response
    <br />8. Let&#39;s follow the error and append &quot;)&quot;. Because we don&#39;t see an opening &quot;(&quot; in
    the original object of the response. It is probably part of the earlier AJAX code, which we don&#39;t see. Let&#39;s
    append a )<br /> <a href=""><img src="images/1600-10.png" alt="images/1600-10.png" /></a><br />9. Go back on the
    Browser and check for errors<br /> <a href=""><img src="images/1600-11.png" alt="images/1600-11.png" /></a><br />
    Notice:<br /> ▪ The string “unexpected token: string literal JSON Response” implies that our JSON is now
    broken.<br />10. Append &quot;;//&quot; because probably is the rest of the code that is giving us problem. To avoid
    the execution of the remaining code we can use ;//<br /> <a href=""><img src="images/1600-12.png"
        alt="images/1600-12.png" /></a><br />11. Go back on the Browser and check for errors<br /> NO ERRORS THIS TIME!
    :)<br />12. Now we can try to inject a JavaScript alert<br />
    <div class="codebox">
      <div class="codebox">ToolID=16&quot;}});alert(1337);//</div>
    </div><br /> <a href=""><img src="images/1600-13.png" alt="images/1600-13.png" /></a><br />13. Go back on the
    Browser<br /> <a href=""><img src="images/1600-14.png" alt="images/1600-14.png" /></a><br />
    BINGO!<br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br />
  </div>
</body>

</html>