<!doctype html>
<html>
<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <title>Inline hooking</title>
  <meta name="generator" content="CherryTree">
  <link rel="stylesheet" href="res/styles3.css" type="text/css" />
</head>
<body>
<div class='page'><h1 class='title'>Inline hooking</h1><br/>Inline hooking is more difficult to do than IAT- EAT hooking because the way it works.<br /><br />Instead of replacing the address of the hooked function with a pointer to the rootkit code like done in <a href="hodology--System_Security_(Windows_&_Linux)--Malware--Techniques_used_by_malware--User-mode_hooking_techniques_(API_hooking)--IAT_hooking.html">IAT</a> - <a href="hodology--System_Security_(Windows_&_Linux)--Malware--Techniques_used_by_malware--User-mode_hooking_techniques_(API_hooking)--EAT_hooking.html">EAT</a> hooking,<br /><strong>Inline hooking</strong> technique take control of the function itself. By modifying the function, the rootkit code can then be executed irrespective of the manner in which the function is invoked.<br />The first few instructions of the function are overwritten with a JMP (unconditional branch) to a <span style="color:#ff1b00;">our Detour code</span>. Then the <span style="color:#ff1b00;">Detour code</span> will call the <span style="color:#1e90ff;">trampoline</span> that store the original instructions of the function. <br /><br /><a href="file:///CherryTree/screenshots2/PTP-elearnsecurity/1. System Security/6 - Malware/inline hooking.png"><img src="images/574-1.png" alt="images/574-1.png" /></a><br /><br />Bibliography: <br />1. Crimeware: Understanding New Attacks and Defenses</div>
</body>
</html>
