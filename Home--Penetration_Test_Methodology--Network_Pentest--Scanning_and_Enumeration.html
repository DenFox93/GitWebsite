<!doctype html>
<html>

<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <title>Scanning and Enumeration</title>
  <meta name="generator" content="CherryTree">
  <link rel="stylesheet" href="res/styles3.css" type="text/css" />
</head>

<body>
  <div class='page'>
    <h1 class='title'>Scanning and Enumeration</h1><br />Ports, Protocols, and Services (PPS) help us in identifying the
    types of applications running on a system and subsequently any potential weaknesses<br />In this phase we will use
    most of the time <strong>nmap</strong>(Network mapper) that is also available with a GUI called <a
      href="https://nmap.org/zenmap/" target="_blank">Zenmap</a><br /><br /><strong>
      <h3>These are step to follow during the Scanning Phase</h3>
    </strong><br />1. <strong>Network Sweeping</strong>: identify potential targets and the addresses they use<br />2.
    <strong>Network Tracing</strong>: determine network topology and draw a map<br />3. <strong>Port Scans</strong>:
    identifying openings in the targets<br />4. <strong>OS Fingerprinting</strong>: what kinds of target machines we are
    testing<br />5. <strong>Version Scans</strong>: discern the services and protocols we face<br />6.
    <strong>Vulnerability Scans</strong>:<br /> <br /><br /><strong>
      <h3>Footprinting and Scanning all in one</h3>
    </strong><br /><span style="color:#a020f0;">0.</span> Scan the LAN<br />
    <div class="codebox">
      <div class="codebox">netdiscover&nbsp;-i&nbsp;tap0&nbsp;-r&nbsp;10.10.10.0/24</div>
    </div><br /> <a href=""><img src="images/143-1.png" alt="images/143-1.png" /></a><br />
    <div class="codebox">
      <div class="codebox">route&nbsp;-n</div>
    </div><br /><span style="color:#a020f0;">1.</span> <br />
    <div class="codebox">
      <div class="codebox">nmap&nbsp;-PE&nbsp;-sn&nbsp;-n&nbsp;-T4&nbsp;&lt;address-range&gt;&nbsp;-oN&nbsp;output.nmap
      </div>
    </div><br />For additional information use these:<br />
    <div class="codebox">
      <div class="codebox">
        nmap&nbsp;-n&nbsp;-T4&nbsp;--disable-arp-ping&nbsp;-PS21,22,25,53,80,110,111,135,139,443,445&nbsp;&lt;address-range&gt;&nbsp;&nbsp;&nbsp;#TCP&nbsp;SYN&nbsp;&quot;Ping&quot;
      </div>
    </div><br />
    <div class="codebox">
      <div class="codebox">
        nmap&nbsp;-n&nbsp;-T4&nbsp;--disable-arp-ping&nbsp;-PA21,22,25,53,80,110,111,135,139,443,445&nbsp;&lt;address-range&gt;&nbsp;&nbsp;&nbsp;#TCP&nbsp;ACK&nbsp;&quot;Ping&quot;
      </div>
    </div><br />
    <div class="codebox">
      <div class="codebox">
        nmap&nbsp;-sS&nbsp;-sU&nbsp;--source-port&nbsp;53&nbsp;-p53&nbsp;-n&nbsp;&lt;netblock&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#scan&nbsp;for&nbsp;DNS
      </div>
    </div><br /> <strong>-oN</strong> → Output scan in normal format to the given filename( in this case
    output.nmap)<br /><span style="color:#a020f0;">2.</span><br />
    <div class="codebox">
      <div class="codebox">
        cat&nbsp;output.nmap&nbsp;|&nbsp;grep&nbsp;&quot;Nmap&nbsp;scan&nbsp;report&nbsp;for&quot;&nbsp;|&nbsp;cut&nbsp;-d&nbsp;&quot;&nbsp;&quot;&nbsp;-f&nbsp;5&nbsp;|&amp;&nbsp;tee&nbsp;ips.txt
      </div>
    </div> <br /> with thi command we save only the addresses found in the network <br /> ◇ <strong>cut -d &quot; &quot;
      -f 5 </strong> →<strong> -d</strong> split text separated by a space, <strong>-f</strong> then select the fifth
    element<br /> ◇ <strong>|&amp; tee ips.txt</strong> → save output in the ips.txt file and show it on the
    terminal<br /><span style="color:#a020f0;">3.</span><br />
    <div class="codebox">
      <div class="codebox">
        nmap&nbsp;-sS&nbsp;-n&nbsp;-Pn&nbsp;-T4&nbsp;-iL&nbsp;ips.txt&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#TCP&nbsp;scan
      </div>
    </div><br />
    <div class="codebox">
      <div class="codebox">
        nmap&nbsp;-Pn&nbsp;-T4&nbsp;-n&nbsp;-sU&nbsp;--top-ports&nbsp;20&nbsp;-iL&nbsp;ips.txt&nbsp;&nbsp;&nbsp;#UDP&nbsp;scan
      </div>
    </div><br />or the point 4 that is more complete<br /><span style="color:#a020f0;">4.</span> <br />
    <div class="codebox">
      <div class="codebox">
        nmap&nbsp;--osscan-guess&nbsp;-O&nbsp;-sV&nbsp;-sC&nbsp;--traceroute&nbsp;--version-intensity&nbsp;9&nbsp;-T4&nbsp;-p-&nbsp;-n&nbsp;-iL&nbsp;ips.txt
      </div>
    </div><br /> take some time, like 10 mins for target<br /><br /><strong>
      <h3>Scanning Tips</h3>
    </strong><br />• Configure scanning tools to use target IP addresses (10.10.20.20) or address ranges, not its domain
    names (<a href="http://www.example.com)" target="_blank">www.example.com)</a><br /> This because many networks use DNS to perform
    load balancing and other traffic distribution schemes across multiple targets. <br /> So if we attack a single
    domain name, <a href="http://www.example.com," target="_blank">www.example.com,</a> we may actually be going after multiple hosts
    simultaneously without knowing it. <br /> This could lead to highly erroneous results because the result may contain
    merged results from multiple machines.<br /> ◇ This is not valid for web applications tests because shared web
    server host multiple target applications and use an IP address as your target causes your web scanning tools to omit
    the proper host header to access the right target content.<br />
  </div>
</body>

</html>