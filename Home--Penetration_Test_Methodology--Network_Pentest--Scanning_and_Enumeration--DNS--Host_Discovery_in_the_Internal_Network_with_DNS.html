<!doctype html>
<html>

<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <title>Host Discovery in the Internal Network with DNS</title>
  <meta name="generator" content="CherryTree">
  <link rel="stylesheet" href="res/styles3.css" type="text/css" />
</head>

<body>
  <div class='page'>
    <h1 class='title'>Host Discovery in the Internal Network with DNS</h1><br /><br /><br /><strong>
      <h3>1. Forward DNS Lookup of possible Subdomains</h3>
    </strong><br />Usually useful if we are in an internal network <br />If we have a Domain(with its ip address) and we
    <span style="text-decoration:underline;">want to find the ip address of its possible subdomains</span><br />We can
    use a commands like this<br />
    <div class="codebox">
      <div class="codebox">
        wget&nbsp;https://raw.githubusercontent.com/mschwager/fierce/master/fierce/lists/default.txt<br />for&nbsp;subdomain&nbsp;in&nbsp;$(cat&nbsp;default.txt);&nbsp;do&nbsp;host&nbsp;$subdomain.[DOMAIN_FQDN]&nbsp;[DNS_IP_ADDRESS]&nbsp;-W&nbsp;2;&nbsp;done&nbsp;|&nbsp;grep&nbsp;&#39;has&nbsp;address&#39;
      </div>
    </div><br /> <a href=""><img src="images/2109-1.png" alt="images/2109-1.png" /></a><br /><br /> ◇
    <strong>nmap</strong><br />
    <div class="codebox">
      <div class="codebox">
        nmap&nbsp;--dns-servers&nbsp;172.16.5.10&nbsp;--script&nbsp;dns-brute&nbsp;--script-args&nbsp;dns-brute.domain=sportsfoo.com
      </div>
    </div><br /><br /><br /><strong>Wordlists:</strong><br />• <a
      href="https://github.com/mschwager/fierce/tree/master/fierce/lists" target="_blank">https://github.com/mschwager/fierce/tree/master/fierce/lists</a><br />
    ◇ Default(1598 words): <a
      href="https://raw.githubusercontent.com/mschwager/fierce/master/fierce/lists/default.txt" target="_blank">https://raw.githubusercontent.com/mschwager/fierce/master/fierce/lists/default.txt</a><br /><br /><br /><strong>
      <h3>2. Reverse DNS Lookup of possible Ip address</h3>
    </strong><br />From the the point 1 in this scenario we have discovered that there a lot of ip address in the range
    172.16.5.0/24<br />Create a list of this possible ip address<br />
    <div class="codebox">
      <div class="codebox">seq&nbsp;-f&nbsp;&quot;172.16.5.%g&quot;&nbsp;1&nbsp;255&nbsp;&gt;&nbsp;iplist.txt</div>
    </div><br />script to do a reverse dns lookup of these addresses:<br />
    <div class="codebox">
      <div class="codebox">nano&nbsp;reverse_dns.sh</div>
    </div><br />File:<br />
    <div class="codebox">
      <div class="codebox">
        #!/bin/bash<br />for&nbsp;ip&nbsp;in&nbsp;$(cat&nbsp;iplist.txt);&nbsp;do&nbsp;dig&nbsp;@172.16.5.10&nbsp;-x&nbsp;$ip&nbsp;+nocookie;&nbsp;done
      </div>
    </div><br />enable execution:<br />
    <div class="codebox">
      <div class="codebox">chmod&nbsp;+x&nbsp;reverse_dns.sh</div>
    </div><br />execute it:<br />
    <div class="codebox">
      <div class="codebox">./reverse_dns.sh&nbsp;|&nbsp;grep&nbsp;sportsfoo.com&nbsp;|&nbsp;grep&nbsp;PTR</div>
    </div><br /> <a href=""><img src="images/2109-2.png" alt="images/2109-2.png" /></a><br /><br /> ◇
    <strong>nmap</strong><br />
    <div class="codebox">
      <div class="codebox">dnsrecon&nbsp;-n&nbsp;172.16.5.10&nbsp;-r&nbsp;172.16.5.1-172.16.5.99</div>
    </div><br /><br /><strong>
      <h3>3. Check which Hosts are alive</h3>
    </strong><br /> ◇ nmap<br /> This step with nmap is not related with the previous one<br />
    <div class="codebox">
      <div class="codebox">
        nmap&nbsp;-sn&nbsp;172.16.5.*&nbsp;-oG&nbsp;-&nbsp;|&nbsp;awk&nbsp;&#39;/Up/{print&nbsp;$2}&#39;&nbsp;&gt;&nbsp;alive.txt&nbsp;&amp;&amp;&nbsp;cat&nbsp;alive.txt
      </div>
    </div><br /> <a href=""><img src="images/2109-3.png" alt="images/2109-3.png" /></a><br />
  </div>
</body>

</html>