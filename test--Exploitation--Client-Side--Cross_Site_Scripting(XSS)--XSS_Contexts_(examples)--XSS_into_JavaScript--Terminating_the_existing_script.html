<!doctype html>
<html>

<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <title>Terminating the existing script</title>
  <meta name="generator" content="CherryTree">
  <link rel="stylesheet" href="res/styles3.css" type="text/css" />
</head>

<body>
  <div class='page'>
    <h1 class='title'>Terminating the existing script</h1><br /><br /><br />In the simplest case, it is possible to
    simply close the script tag (with <span style="color:#ff0000;">&lt;/script&gt;</span>) that is enclosing the
    existing JavaScript, and <span style="color:#1e90ff;">introduce some new HTML tags</span> that will trigger
    execution of JavaScript. For example, if the XSS context is as follows:<br />
    <div class="codebox">
      <div class="codebox">
        &lt;script&gt;<br />...<br />var&nbsp;input&nbsp;=&nbsp;&#39;controllable&nbsp;data&nbsp;here&#39;;<br />...<br /><span
          style="color:#000000;font-weight:400">&lt;</span>/script<span
          style="color:#000000;font-weight:400">&gt;</span></div>
    </div><br />then you can use the following payload to break out of the existing JavaScript and execute your
    own:<br /><span style="color:#ff0000;">&lt;/script&gt;</span><span style="color:#1e90ff;">&lt;img</span> src=1
    onerror=alert(document.domain)&gt;<br />The reason this works is that the browser:<br />1. first performs HTML
    parsing to identify the page elements including blocks of script<br />2. and only later performs JavaScript parsing
    to understand and execute the embedded scripts. <br />The above payload leaves the original script broken, with an
    unterminated string literal. But that doesn&#39;t prevent the subsequent script being parsed and executed in the
    normal way.<br /><br /><br /><br /><br /><br /><br /><strong>Bibliography:</strong><br />• <a
      href="https://portswigger.net/web-security/cross-site-scripting/contexts/lab-javascript-string-single-quote-backslash-escaped" target="_blank">https://portswigger.net/web-security/cross-site-scripting/contexts/lab-javascript-string-single-quote-backslash-escaped</a><br />•
    <a
      href="https://portswigger.net/web-security/cross-site-scripting/contexts" target="_blank">https://portswigger.net/web-security/cross-site-scripting/contexts</a>
  </div>
</body>

</html>