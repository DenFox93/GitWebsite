<!doctype html>
<html>
<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <title>nmap</title>
  <meta name="generator" content="CherryTree">
  <link rel="stylesheet" href="res/styles3.css" type="text/css" />
</head>
<body>
<div class='page'><h1 class='title'>nmap</h1><br/><br />Syntax of nmap:<br /><div class="codebox"><div class="codebox">nmap&nbsp;[Scan&nbsp;Type(s)]&nbsp;[Options]&nbsp;<span style="color:#000000;font-weight:400">{</span>target(s)<span style="color:#000000;font-weight:400">}</span></div></div><br /><br />TARGETS:<br />• DNS names<br />    <div class="codebox"><div class="codebox">nmap&nbsp;&lt;scan&nbsp;type&gt;&nbsp;target1.domain1.com&nbsp;target2.domain2.com</div></div><br />• IP addresses<br />    <div class="codebox"><div class="codebox">nmap&nbsp;&lt;scan&nbsp;type&gt;&nbsp;192.168.1.23&nbsp;172.100.34.87&nbsp;10.10.2.1&nbsp;10.10.2.7</div></div><br />• CIDR notation<br />    <div class="codebox"><div class="codebox">nmap&nbsp;&lt;scan&nbsp;type&gt;&nbsp;10.0.0.0/8&nbsp;192.168.1.0/24&nbsp;200.200.1.0/16</div></div><br />• wildcards<br />    <div class="codebox"><div class="codebox">nmap&nbsp;&lt;scan&nbsp;type&gt;&nbsp;192.168.1.*&nbsp;#astersc&nbsp;converted&nbsp;to&nbsp;a&nbsp;range&nbsp;of&nbsp;0-255</div></div><br />    <div class="codebox"><div class="codebox">nmap&nbsp;&lt;scan&nbsp;type&gt;&nbsp;192.168.*.3&nbsp;#astersc&nbsp;converted&nbsp;to&nbsp;a&nbsp;range&nbsp;of&nbsp;0-255</div></div><br />• ranges<br />    <div class="codebox"><div class="codebox">nmap&nbsp;&lt;scan&nbsp;type&gt;&nbsp;10.13.22.0-32&nbsp;10.11.83.200-255</div></div><br />• octets lists<br />    <div class="codebox"><div class="codebox">nmap&nbsp;&lt;scan&nbsp;type&gt;&nbsp;192.168.1.3,5,57&nbsp;#hosts&nbsp;with&nbsp;IP&nbsp;ending&nbsp;with&nbsp;3,5&nbsp;and&nbsp;57</div></div><br />    <div class="codebox"><div class="codebox">nmap&nbsp;&lt;scan&nbsp;type&gt;&nbsp;192.168,169.1,5.3,5,57&nbsp;</div></div><br />• input file<br />    <div class="codebox"><div class="codebox">nmap&nbsp;&lt;scan&nbsp;type&gt;&nbsp;-iL&nbsp;hosts.txt</div></div><br /><br /><br /><br /><strong>PORTS:</strong><br />By default when we chose a target nmap scan the <strong>most 1000 common ports</strong><br />If we want to scan custom ports we have to specify <strong>-p</strong> option<br />• ports comma separated list<br />    <div class="codebox"><div class="codebox">nmap&nbsp;–p&nbsp;22,24,53,80,111,135,139,441,443,445,711,1025,1026,1029&nbsp;-sS&nbsp;<span style="color:#000000;font-weight:400">&lt;</span>target<span style="color:#000000;font-weight:400">&gt;</span></div></div><br />    <div class="codebox"><div class="codebox">nmap&nbsp;–p&nbsp;22,24,53,80,111,135,139,441,443,445,711,1025,1026,1029&nbsp;-sT&nbsp;<span style="color:#000000;font-weight:400">&lt;</span>target<span style="color:#000000;font-weight:400">&gt;</span></div></div><br />• port interval<br />    <div class="codebox"><div class="codebox">nmap&nbsp;–p&nbsp;200-700&nbsp;-sS&nbsp;<span style="color:#000000;font-weight:400">&lt;</span>target<span style="color:#000000;font-weight:400">&gt;</span></div></div><br />    <div class="codebox"><div class="codebox">nmap&nbsp;–p&nbsp;200-700&nbsp;-sT&nbsp;<span style="color:#000000;font-weight:400">&lt;</span>target<span style="color:#000000;font-weight:400">&gt;</span></div></div><br />• all ports(from 1 through 65535)<br />    <div class="codebox"><div class="codebox">nmap&nbsp;–p-&nbsp;-sS&nbsp;<span style="color:#000000;font-weight:400">&lt;</span>target<span style="color:#000000;font-weight:400">&gt;</span></div></div><br /><br /><strong><h3>Local Area Network</h3></strong><br />If we run a scan in a local network, nmap perform few more operations before performing the scan: ARP ping scan, DNS resolution of the target. nmap does these operations because is the faster way to discover live host in a local area network <br /><strong>--disable-arp-ping</strong> or <strong>--send-ip</strong> → The only way to perform a ICMP (ping sweep) with nmap is use these option, that the the inverse of -PR. <br />    -PR is the default scan type when scanning ethernet hosts that Nmap detects are on a local ethernet network.<br /><strong>-n</strong> → Never do DNS resolution. This is a HOST DISCOVERY option but we can use it with all SCAN TECHNIQUES<br />     <span style="text-decoration:underline;">When resolving IP addresses to hostnames is not required</span> we can use -n to decrease our scan times, and also help us stay a bit more “under the radar”, as reverse DNS lookups can generate more noise than necessary<br />     <br /><strong><h3>Output options</h3></strong><br />Instead of specify the file we ca use “-” and the correspondent output will be displayed directlyon the shell<br />• <strong>-oN &lt;file.nmap&gt;</strong> → Normal output: The normal human-readable output typically displayed on the screen will be stored into a file<br />• <strong>-oX &lt;file.xml&gt;</strong> → XML output: Creates an XML output that can be easily parsed by various tools.<br />• <strong>-oG &lt;file.gnmap&gt;</strong>→ Grepable output: Although deprecated (replaced by XML), it is still popular. This output lists each host on one line and can be easily used to search and parse with Unix tools such as grep, awl, cut, etc.<br />• <strong>-oA</strong> &lt;file.nmap&gt;: Output in normal, XML, and grepable formats at once.<br /><span style="color:#a5452a;">example:</span><br /><div class="codebox"><div class="codebox">nmap&nbsp;-n&nbsp;-sT&nbsp;192.168.1.97&nbsp;-oA&nbsp;/tmp/192.168.1.97_connect_scan</div></div><br /><div class="codebox"><div class="codebox">ls&nbsp;/tmp/192.168.1.97_connect_scan*</div></div><br />    <a href=""><img src="images/416-1.png" alt="images/416-1.png" /></a><br /><div class="codebox"><div class="codebox">gedit&nbsp;/tmp/192.168.1.97_connect_scan.gnmap</div></div><br /><br /><br /><strong><h3>Use DNS of the internal Network</h3></strong><br />Find DNS into the network<br /><div class="codebox"><div class="codebox">nmap&nbsp;-p&nbsp;53&nbsp;-sV&nbsp;-sS&nbsp;<span style="color:#000000;font-weight:400">[</span>InternalNetwork<span style="color:#000000;font-weight:400">]</span></div></div><br /><strong>--dns-servers</strong><br />By default, Nmap determines your DNS servers (for rDNS resolution) from your resolv.conf file (Unix) or the Registry (Win32). Alternatively, you may use this option to specify alternate servers.<br />If we find DNS name server into the network we could use them to try reverse DNS (determine the domain name associated with an IP address). <br /><div class="codebox"><div class="codebox">nmap&nbsp;-sS&nbsp;-sV&nbsp;--dns-servers&nbsp;[IpDNS]&nbsp;<span style="color:#000000;font-weight:400">[</span>addressRange<span style="color:#000000;font-weight:400">]</span></div></div><br /></div>
</body>
</html>
