<!doctype html>
<html>

<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <title>Ruby scripts (pattern_create.rb & pattern_offset.rb)</title>
  <meta name="generator" content="CherryTree">
  <link rel="stylesheet" href="res/styles3.css" type="text/css" />
</head>

<body>
  <div class='page'>
    <h1 class='title'>Ruby scripts (pattern_create.rb & pattern_offset.rb)</h1><br /><strong>
      <h2>Ruby scripts</h2>
    </strong><br /><br />To make this task of find the offset more easier we can use some scripts like:<br />1. <a
      href="https://github.com/lattera/metasploit/blob/master/tools/pattern_create.rb" target="_blank">pattern_create.rb</a>: Ruby
    script to <strong>create the payload</strong> long as the number we specify (big number preferably). <br /> â—‡ on
    Linux this script is pre-installed with metasploit in the folder /usr/share/metasploit-framework/tools/exploit<br />
    <a href=""><img src="images/509-1.png" alt="images/509-1.png" /></a><br />
    <div class="codebox">
      <div class="codebox">msf-pattern_create&nbsp;-l&nbsp;100</div>
    </div><br /> <a href=""><img src="images/509-2.png" alt="images/509-2.png" /></a><br />3. We start to <span
      style="text-decoration:underline;">debug the application</span>, for example with Immunity Debugger, and we use
    the pattern created by <a
      href="https://github.com/lattera/metasploit/blob/master/tools/pattern_create.rb" target="_blank">pattern_create.rb</a> as argument
    (payload).<br /> We have to run the application and once that is crashed we have to annotate which is the <span
      style="color:#ffff00;">EIP address</span> with an access violation(overwritten).<br /> EIP is been overwritten
    because we have used a random big number(100) <br /> <a href=""><img src="images/509-3.png"
        alt="images/509-3.png" /></a> <a href=""><img src="images/509-4.png" alt="images/509-4.png" /></a><br />6. <a
      href="https://github.com/lattera/metasploit/blob/master/tools/pattern_offset.rb" target="_blank">pattern_offset.rb</a> : Ruby
    script to which we have to input the <span style="color:#ffff00;">EIP address</span> found. This script will give us
    the exact number of junk Bytes(offset) that we need to reach the <span style="color:#ffff00;">EIP</span> but not
    overwrite it.<br /> <a href=""><img src="images/509-5.png" alt="images/509-5.png" /></a><br />
    <div class="codebox">
      <div class="codebox">msf-pattern_offset&nbsp;-q&nbsp;61413761</div>
    </div><br /> <a href=""><img src="images/509-6.png" alt="images/509-6.png" /></a><br /> Return 22 that is is the
    offset to overwrite both the <span style="color:#00ff2d;">data</span> and <span style="color:#00ff2d;">EBP</span>
    but not <span style="color:#ffff00;">EIP</span><br /><br />
  </div>
</body>

</html>