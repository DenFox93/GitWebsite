<!doctype html>
<html>
<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <title>tcpdump</title>
  <meta name="generator" content="CherryTree">
  <link rel="stylesheet" href="res/styles3.css" type="text/css" />
</head>
<body>
<div class='page'><h1 class='title'>tcpdump</h1><br/><br />Tcpdump is a free, open-source sniffer that is quite flexible and fast. It runs on most Linux and UNIX variants (in fact, it is installed by default on many Linux distributions) and has been ported to Windows as WinDump)<br />site Tcpdump(Linux): <a href="http://www.tcpdump.org">http://www.tcpdump.org</a><br />site WinDump(Windows): <a href="http://www.winpcap.org/windump/default.htm">http://www.winpcap.org/windump/default.htm</a><br /><br /><div class="codebox"><div class="codebox">tcpdump&nbsp;[options]&nbsp;<span style="color:#000000;font-weight:400">[</span>filter&nbsp;expression<span style="color:#000000;font-weight:400">]</span></div></div><br />    <span style="color:#a5452a;">example:</span><br />    <div class="codebox"><div class="codebox">tcpdump&nbsp;-n&nbsp;-s&nbsp;0&nbsp;-i&nbsp;eth0&nbsp;-w&nbsp;file.pcap</div></div><br />OPTIONS: <a href="http://www.tcpdump.org/manpages/tcpdump.1.html">http://www.tcpdump.org/manpages/tcpdump.1.html</a><br />• -D: list of the interfaces available<br />• <strong>-n</strong>: Disable name resolution of the hosts (passive scan)<br />•<strong> -i &lt;interface&gt;</strong>: Sniff on a specific network interface, such as the local loopback interface (usually, lo) or the local ethernet (often, eth0). For a list of interfaces, you can run &quot;tcpdump -D&quot;.<br />• dst &lt;Ip_address&gt;: Shows only the communications with the destination specified<br />• src &lt;Ip_address&gt;: Shows only the communications with the sorce specified. We can specify both src and dst using between them “and”<br />• -v: Print verbose output (shows the TTL, IP ID, Total Length, and IP options). -vv shows more, -vvv even more.<br />• <strong>-w &lt;file&gt;</strong>: Write packets to a file (which can be read later with the -r option).<br />• <strong>-r &lt;file&gt;</strong>: read packets  from files<br />• -x: Print out packet settings in hexadecimal form.<br />• -X: Print out packet settings in both hex and ASCII.<br />• -A: Print out packet settings in ASCII. (This option doesn&#39;t work in all versions of tcpdump. If it doesn&#39;t work in a given instance, consider using the -X option to get ASCII and Hex.)<br />• -S: Print absolute, rather than relative, TCP sequence numbers<br />• <strong>-s &lt;snaplen&gt;</strong>: Snarf snaplen bytes of data from each packet rather than the default of 68. 68 bytes is adequate for IP, ICMP, TCP and UDP but may truncate protocol information from name server and NFS packets  Setting snaplen to 0 means use the required length to catch whole packets<br /><br /><span style="color:#a5452a;">examples</span><br /><div class="codebox"><div class="codebox">tcpdump&nbsp;-i&nbsp;eth0&nbsp;-xxAXXS&nbsp;dst&nbsp;<span style="color:#000000;font-weight:400">&lt;</span>IP_Address<span style="color:#000000;font-weight:400">&gt;</span></div></div><br /><div class="codebox"><div class="codebox">tcpdump&nbsp;-i&nbsp;eth0&nbsp;-vvvASs&nbsp;0&nbsp;dst&nbsp;<span style="color:#000000;font-weight:400">&lt;</span>IP_Address<span style="color:#000000;font-weight:400">&gt;</span></div></div><br /><br />OPTIONS TO FOCUS ON SPECIFIC PACKETS:<br />• Protocol:<br />   ◇ ether, ip, ip6, arp, rarp, tcp, udp →  protocol type<br />• Type:<br />   ◇ host [host] →  Only give me packets to or from that host<br />   ◇ net [network] →  Only packets for a given network<br />   ◇ port [portnum] →  Only packets for that port<br />   ◇ portrange [start-end] →  Only packets in that range of ports<br />• Direction:<br />   ◇ src [host or port] →  Only give me packets from that host or port<br />   ◇ dst [host or port] →  Only give me packets to that host<br />• Boolen logic:<br />   ◇ Use &quot;and&quot; or &quot;or&quot; to combine these together<br />   ◇ Use &quot;not&quot; to negate<br />   ◇ Wrap in parentheses to group elements together</div>
</body>
</html>
