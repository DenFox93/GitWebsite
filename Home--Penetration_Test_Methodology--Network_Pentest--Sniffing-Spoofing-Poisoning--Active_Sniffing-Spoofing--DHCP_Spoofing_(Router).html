<!doctype html>
<html>
<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <title>DHCP Spoofing (Router)</title>
  <meta name="generator" content="CherryTree">
  <link rel="stylesheet" href="res/styles3.css" type="text/css" />
</head>
<body>
<div class='page'><h1 class='title'>DHCP Spoofing (Router)</h1><br/><a href="Home--Pentesting_Basics--networking--protocols--protocol_layers--IP_protocol_suite_(TCP-IP)--Application_layer--DHCP.html">DHCP</a>(Application layer 7) is a service usually running on <a href="Basics--networking--protocols--protocol_layers--IP_protocol_suite_(TCP-IP)--Internet_Layer-Internet_Protocol_(IP)--Router_&_routing_table.html">routers</a> to dynamically assign or revoke IP address to new hosts on the network.<br /><a href=""><img src="images/690-1.png" alt="images/690-1.png" /></a><br /><br />All the packets exchanged between client and server <span style="text-decoration:underline;">are sent in broadcast</span>, thus everyone in the network receives the DHCP packets, <span style="text-decoration:underline;">even the hosts not involved in the communication!</span><br /><br /><strong>How take advantage(exploit) from this DHCP protocol behaviour?<br />How we have seen in the </strong><a href="Home--Pentesting_Basics--networking--protocols--protocol_layers--IP_protocol_suite_(TCP-IP)--Application_layer--DHCP.html">DHCP</a> chapter, if there are more than one DHCP Server that make a <strong>DHCP Offer</strong> will win the DHCP server that offer a greater Lease Time.<br />So what we have to do is act as a DHCP server and send a greater <span style="text-decoration:underline;">Lease Time</span>(&gt;3600 seconds). This will lure the victim to choose our offer and then set the configurations we will send.<br /><br />DHCP Servers not only offer IP addresses but they can also provide a default gateway for the network. By competing with legit DHCP servers (and winning by increasing the lease time), <span style="text-decoration:underline;">we can set ourselves as the default gateway</span><br />In this way all the traffic leaving the network from the client host will reach our machine (attacker) and then the real gateway of the network<br /><br /><br /><br /></div>
</body>
</html>
