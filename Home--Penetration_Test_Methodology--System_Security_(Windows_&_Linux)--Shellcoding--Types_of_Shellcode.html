<!doctype html>
<html>
<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <title>Types of Shellcode</title>
  <meta name="generator" content="CherryTree">
  <link rel="stylesheet" href="res/styles3.css" type="text/css" />
</head>
<body>
<div class='page'><h1 class='title'>Types of Shellcode</h1><br/><strong><h3>• Local </h3></strong><h3>Shellcode:</h3><br />   ◇ Also known as <span style="text-decoration:underline;">Privilege Escalation Shellcode</span><br />   ◇ Use an exploit of a local process(on local machine) to inject a Shellcode into the local process and execute it<br />   ◇ The goal is get <span style="text-decoration:underline;">higher privileges on the local machine</span><strong><br /></strong><strong><h3>• Remote </h3></strong><h3>Shellcode</h3><br />   ◇ Also known as <span style="text-decoration:underline;">Remote Code Execution</span><br />   ◇ Use an exploit of a remote process(on remote machine) to send and inject a Shellcode into the remote process and execute it<br />   ◇ The goal of RCE have remote <span style="text-decoration:underline;">access to the exploited machin</span>e<br />   ◇ Types of RCE:<br />      ▪ <strong>Connect Back</strong> Shellcode →  initiates a connection back to the attacker&#39;s machine<br />      ▪ <strong>Bind Shell</strong> Shellcode → binds a shell to a port on which the attacker can connect<br />      ▪ <strong>Socket Reuse</strong> Shellcode → establishes a connection to a vulnerable process that does not close before the shellcode is run. The shellcode can then re-use this connection to communicate with the attacker. However, due to their complexity, they are generally not used<br /><br /><strong><h3>Staged</h3></strong><h3> Shellcode</h3><br />Used when the shellcode size is bigger than the space that an attacker can use for injection (within the process), so the Shellcode is divided in more parts<br />Staged shellcode can be <strong><span style="color:#1e90ff;">local</span></strong> or <strong><span style="color:#ff0000;">remote</span></strong> and can be divided into two sub-types:<br />• <strong>Egg-hunt</strong> Shellcode:<br />   ◇ <span style="text-decoration:underline;">Stage1</span> (<strong><span style="color:#00ff2d;">egg-hunter</span></strong>): a <span style="color:#00ff2d;">small shellcode</span> is executed in the space that the attacker can use for injection. It start searching for the <span style="color:#ff8700;">bigger shellcode (egg)</span> within the process address space.<br />   ◇ <span style="text-decoration:underline;">Stage2</span> (<strong><span style="color:#ff8700;">egg</span></strong>): a <span style="color:#ff8700;">bigger shellcode</span> can be injected into the process but, it is unknown where in the process this shellcode will be actually injected<br />• <strong>Omelet</strong> Shellcode<br />   ◇ <span style="text-decoration:underline;">Stage1</span> (<strong><span style="color:#00ff2d;">egg-hunter</span></strong>): a <span style="color:#00ff2d;">small shellcode</span> is executed in the space that the attacker can use for injection. It start searching for the <span style="color:#f6ff00;">smaller shellcodes(eggs)</span> within the process address space.<br />   ◇ <span style="text-decoration:underline;">Stage2</span> (<strong><span style="color:#f6ff00;">eggs</span></strong>):<span style="color:#ff0000;"> </span><span style="color:#f6ff00;">smaller shellcodes</span> are combined together and executed<br /><br /><a href=""><img src="images/526-1.png" alt="images/526-1.png" /></a><br /><br /><strong><h3>Download and execute</h3></strong><h3> Shellcodes</h3><br />They do not immediately create a shell when executed. <br />Instead, they download an executable file from the Internet, execute it and create a Shellcode.</div>
</body>
</html>
