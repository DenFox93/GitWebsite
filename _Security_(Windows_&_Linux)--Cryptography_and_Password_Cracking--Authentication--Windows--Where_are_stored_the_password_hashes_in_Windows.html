<!doctype html>
<html>

<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <title>Where are stored the password hashes in Windows</title>
  <meta name="generator" content="CherryTree">
  <link rel="stylesheet" href="res/styles3.css" type="text/css" />
</head>

<body>
  <div class='page'>
    <h1 class='title'>Where are stored the password hashes in Windows</h1><br /><strong>
      <h3>Where are stored the hashes in Windows</h3>
    </strong><br />By default, the SAM file is locked on a running system, and inaccessible to all users including
    administrative users! Since we cannot read the file directly on the disk volume, there are a few alternative tricks
    to get hold of the data. The local security authentication sub-system process (LSASS.EXE) on a running windows
    system reads this data and caches it in memory.<br />LANMAN and NT Hashes are stored:<br />• in the SAM file:
    <code>C:\Windows\System32\config\sam</code><br />• in the SAM registry: <code>HKEY_LOCAL_MACHINE\SAM</code><br />•
    If an NT file system recovery was performed in the past, and the Administrator has not removed the backup data, you
    might be able to find the SAM file in the directory:<br /> <code>%SystemRoot%\repair</code> or
    <code>C:\windows\repair</code> or <code>C:\winnt\repair</code><br />• In Active Directory, password representations
    (both LANMAN and NT hashes by default) are stored in the file <code>%systemroot%\ntds\ntds.dit</code> in the Domain
    Controller.<br /> With the ntds.dit file, a penetration tester can run a suite of tools by Csaba Barta, which are
    designed for a forensics analysis of ntds.dit files. These tools have the capability to locate and pull out hashes
    from a copy of the ntds.dit file<br /><br /><strong>How to Dump password hashes</strong><br />• To dump them we can
    execute from the Windows machine pwdump tool like this one:<br /> <a
      href="https://download.openwall.net/pub/projects/john/contrib/pwdump/pwdump8-8.2.zip" target="_blank" >https://download.openwall.net/pub/projects/john/contrib/pwdump/pwdump8-8.2.zip</a><br />
    pwdump8 by Fulvio Zanetti and Andrea Petralia of blackMath.it<br /> Supported machines: Windows
    2000/XP/Vista/7/2008/8/8.1/10/2012/2016/2019<br />• If we have a meterpreter session we can use <br />
    <div class="codebox">
      <div class="codebox">run&nbsp;hashdump</div>
    </div><br /><br />Bibliography:<br />• <a
      href="http://blog.packetheader.net/2014/10/post-exploitation-metasploit-and.html"  >http://blog.packetheader.net/2014/10/post-exploitation-metasploit-and.html</a>
  </div>
</body>

</html>