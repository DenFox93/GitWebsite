<!doctype html>
<html>

<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <title>DNS tunneling Data Exfiltration</title>
  <meta name="generator" content="CherryTree">
  <link rel="stylesheet" href="res/styles3.css" type="text/css" />
</head>

<body>
  <div class='page'>
    <h1 class='title'>DNS tunneling Data Exfiltration</h1><br /><strong><span style="color:#0000ff;">DNS
        ports</span></strong> (port 53) are a stealthier exfiltration way because the DNS protocol is often less
    monitored in comparison to other Internet protocols (ex: HTTP, FTP, and mail transfer protocols) because create
    lesser risks and because block UDP port 53 traffic would break most, if not all, network communication.<br /> Anyway
    a<span style="color:#0000ff;text-decoration:underline;"> DNS tunneling</span> can be discovered because can cause a
    significant change in the DNS traffic with regards to: <br /> • volume<br /> • messages length (queries that have
    more than 64 characters can be suspicious)<br /> • shorter mean time between messages <br /><br /><a href=""><img
        src="images/101-1.png" alt="images/101-1.png" /></a><br /><br /><br />The core techniques used by all DNS
    tunneling utilities include:<br />• <span style="color:#00ff00;">server side component</span><span
      style="color:#1e90ff;"> </span><span style="color:#00ff00;">(authoritative DNS server)</span><br /> The Malicious
    actors(MA) registers a <span style="color:#ff0000;">domain (example.com)</span> and creates an authoritative DNS
    server for that domain<br />• <span style="color:#1e90ff;">client side component (Victim computer)</span><br />
    hosts the other end of the tunnel. This could be an endpoint in a security controlled enterprise environment<br />•
    <span style="color:#a020f0;">DNS query exchange</span><br /> <span style="text-decoration:underline;">query
      type</span> and <span style="text-decoration:underline;">encoding type</span> greatly effects the amount of data
    that is possible transmit for each query.<br /> In a network statistically these are the query type used: TXT 1–2%
    of all traffic, CNAME 20–30%, AAAA 25%, A 38–48%. <br /> It is possible to use different <span
      style="text-decoration:underline;">types of DNS queries</span> to transmit the data encoded:<br /> ◇
    <strong>A</strong> query → maps a domain name to an ipv4 address → max ~29-bytes per query <br /> Each label in the
    can be up to 63 characters(~4-bytes) and the entire FQDN can be max 253 characters. The encoded data is encoded in
    the labels.<br /> <a href=""><img src="images/101-2.png" alt="images/101-2.png" /></a><br /> <a href=""><img
        src="images/101-3.png" alt="images/101-3.png" /></a><br /> ◇ <strong>TXT</strong> query → used to return text
    data → 255-byte per query<br /> TXT records are typically utilized as the size of this field as we can see allows a
    larger amounts of data to be transferred in a single request compared to A, or AAAA records. Moreover is possible to
    use multiple strings in a single DNS query, but this would increase the size of the record, making it easily
    detectable by DNS firewalls (<a href="https://kb.isc.org/docs/aa-00356" target="_blank">https://kb.isc.org/docs/aa-00356</a>)<br />
    ◇ <strong>CNAME</strong> query → Canonical Names – specify aliases that can be used instead of the original one.
    More stealthier than TXT because more often used but more difficult to use. To be stealthy we have to limit the
    length of the query to 16 byte.<br />•<span style="color:#ff00e0;"> Encoding Types for the data in the DNS
      query</span><br /> ◇ base16 → each character of base16 encoded data in the subdomain represents 4-bits (.5 bytes)
    of the data.<br /> ◇ base32 → each character of base32 encoded data in the subdomain represents 5-bits (.625 bytes)
    of the data.<br /> ◇ base64 → each character of base64 encoded data in the subdomain represents 6-bits (.75 bytes)
    of the data.<br /> <br />Bibliography:<br />• <a
      href="https://www.researchgate.net/publication/336364940_DNS_Tunneling_Identification_and_Defense" target="_blank">https://www.researchgate.net/publication/336364940_DNS_Tunneling_Identification_and_Defense</a><br />•
    <a
      href="https://citeseerx.ist.psu.edu/viewdoc/download?doi=10.1.1.727.1484&rep=rep1&type=pdf" target="_blank">https://citeseerx.ist.psu.edu/viewdoc/download?doi=10.1.1.727.1484&amp;rep=rep1&amp;type=pdf</a><br />•
    <a
      href="http://www.hstabstractbook.org/index_htm_files/c-PID6173081.pdf" target="_blank">http://www.hstabstractbook.org/index_htm_files/c-PID6173081.pdf</a><br />•
    <a
      href="https://www.giac.org/paper/gcia/1116/detecting-dns-tunneling/108367" target="_blank">https://www.giac.org/paper/gcia/1116/detecting-dns-tunneling/108367</a><br />•
    <a
      href="https://learn-umbrella.cisco.com/i/775902-dns-tunneling/0?" target="_blank">https://learn-umbrella.cisco.com/i/775902-dns-tunneling/0?</a><br /><br /><span
      style="color:#49535b;"> </span>
  </div>
</body>

</html>