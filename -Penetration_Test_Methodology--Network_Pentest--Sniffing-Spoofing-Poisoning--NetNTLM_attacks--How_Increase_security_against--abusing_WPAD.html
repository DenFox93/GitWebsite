<!doctype html>
<html>

<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <title>abusing WPAD</title>
  <meta name="generator" content="CherryTree">
  <link rel="stylesheet" href="res/styles3.css" type="text/css" />
</head>

<body>
  <div class='page'>
    <h1 class='title'>abusing WPAD</h1><br /><a
      href="-Middle_techniques_(IPv4)--exploit_Single_Sign-On(SSO)_implementation_of_Windows_in_order_to_capture_NTLM_hashes--WPAD_Spoofing-Poisoning.html">Abusing
      WPAD</a><br /><br /><strong>What is WPAD </strong><br />Organizations allow internet access through Proxy Servers.
    The Web Proxy Auto-Discovery Protocol (WPAD) is a method used by clients to locate the URL of the wpad.dat
    configuration file using DHCP and/or DNS discovery methods. Once detection and download of the configuration file is
    complete, it can be executed to determine the proxy for a specified URL.<br />If “Autodetect Proxy Settings” is
    enabled (below the Windows 10 settings):<br /> <a href=""><img src="images/1191-1.png"
        alt="images/1191-1.png" /></a><br /> Attacker can act as a <em>Web Proxy Auto-Discovery Protocol (WPAD)
      Server</em>(for example using the <a href="https://github.com/SpiderLabs/Responder.git" target="_blank">Responder utility</a>).
    <br /> If the attack has success Responder will act as Web Proxy for the victims. <br /> <br /><strong>How to defend
      against this type of attack</strong><br />• create DNS entry with “WPAD” that points to the corporate proxy
    server. So the attacker won’t be able to manipulate the traffic. <br />• disable “Autodetect Proxy Settings” on all
    Windows Systems with Group Policy.<br /><br /><br />Bibliography:<br />• <a
      href="https://www.ivoidwarranties.tech/posts/pentesting-tuts/responder/wpad/" target="_blank">https://www.ivoidwarranties.tech/posts/pentesting-tuts/responder/wpad/</a><br />•
    <a
      href="https://www.trustedsec.com/blog/wpad-man-in-the-middle-clear-text-passwords/" target="_blank">https://www.trustedsec.com/blog/wpad-man-in-the-middle-clear-text-passwords/</a>
  </div>
</body>

</html>