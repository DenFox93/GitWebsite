<!doctype html>
<html>

<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <title>-sI: TCP Idle Scan (Red Teaming)</title>
  <meta name="generator" content="CherryTree">
  <link rel="stylesheet" href="res/styles3.css" type="text/css" />
</head>

<body>
  <div class='page'>
    <h1 class='title'>-sI: TCP Idle Scan (Red Teaming)</h1><br /><br />With the <strong>Idle Scan</strong>(-sI) the
    attackers can <span style="text-decoration:underline;">scan a target without sending a single packet to the target
      from their own IP address</span>! Intrusion detection system (IDS) reports will finger the innocent zombie as the
    attacker :)<br /><br />The Idle scan so is a stealth technique that involves the presence of a zombie in the target
    network. <br />A zombie is an host that is not very active in the network, the reason its called an <span
      style="text-decoration:underline;">idle scan</span>.<br /><br />To know more see “<a
      href="canning_and_Enumeration--Port_Scanning_(on_hosts_alive)--nmap_[-s]--SCAN_TECHNIQUES---sI_TCP_Idle_Scan_(Red_Teaming)--How_works_Idle_Scan.html">How
      an Idle Scan Works</a>” sub-chapter<br /><br />1. <strong>Finding a Working Idle Scan Zombie Host</strong><br />•
    First method(<span style="text-decoration:underline;">better and faster!</span>): <br /> Use NSE script that
    automatically check if a host is good zombie candidate<br /> We csn specify also more than one host and use a list
    file with -iL<br /> Find a host with the value <span style="color:#ff8700;">Incremental</span> <br />
    <div class="codebox">
      <div class="codebox">nmap&nbsp;--script&nbsp;ipidseq&nbsp;<span
          style="color:#000000;font-weight:400">&lt;</span>IP_ADDRESS<span
          style="color:#000000;font-weight:400">&gt;</span></div>
    </div><br /> <a href=""><img src="images/617-1.png" alt="images/617-1.png" /></a><br />• Second method:<br /> Use OS
    Fingerprint Scan, with verbose mode(-v) it will print if the IP ID is incremental or not<br /> Find a host with the
    value <span style="color:#ff8700;">Incremental</span> for the algorithm Ip ID Sequence Generation<br />
    <div class="codebox">
      <div class="codebox">nmap&nbsp;-O&nbsp;-v&nbsp;-n&nbsp;<span
          style="color:#000000;font-weight:400">&lt;</span>IP_ADDRESS<span
          style="color:#000000;font-weight:400">&gt;</span></div>
    </div><br /> <a href=""><img src="images/617-2.png" alt="images/617-2.png" /></a><br /><br />2. Check if it is an
    idle host, see chapter <a
      href="and_Enumeration--Port_Scanning_(on_hosts_alive)--nmap_[-s]--SCAN_TECHNIQUES---sI_TCP_Idle_Scan_(Red_Teaming)--nmap+hping3_(more_reliable).html">nmap+hping3</a><br /><br />3.
    <strong>Run the Idle Scan</strong><br /> <span style="text-decoration:underline;">WARNING:</span> For a more
    reliable method see chapter <a
      href="and_Enumeration--Port_Scanning_(on_hosts_alive)--nmap_[-s]--SCAN_TECHNIQUES---sI_TCP_Idle_Scan_(Red_Teaming)--nmap+hping3_(more_reliable).html">nmap+hping3</a>.
    This method not always work since could give us the error “<span style="color:#ff0000;">port ... cannot be used
      because it has not returned any of our probes -- perhaps it is down or firewalled</span>” when is not true<br />
    <div class="codebox">
      <div class="codebox">
        nmap&nbsp;-Pn&nbsp;-sI&nbsp;&lt;zombie_IP&gt;:&lt;zombie_open_port&gt;&nbsp;&lt;target_IP&gt;&nbsp;-p&nbsp;<span
          style="color:#000000;font-weight:400">&lt;</span>target_ports_to_scan<span
          style="color:#000000;font-weight:400">&gt;</span></div>
    </div><br /> <strong>-Pn</strong> → prevents pings from the original (our) IP ← IMPORTANT<br />
    <strong>&lt;zombie_open_port&gt;</strong> → To run this scan we need to use an open port on the zombie, it is not
    important as long as the port is open and we can communicate with it.<br /> <strong>-p
      &lt;target_ports_to_scan&gt;</strong> → we can also not specify the ports and Nmap will use the default ports or
    we can also more than one port<br /> -p- → If we want to scan all the ports of the target (from 1 to 65535)<br />
    <strong>-v</strong> → sets the Nmap verbosity<br /> <a href=""><img src="images/617-3.png"
        alt="images/617-3.png" /></a><br /><br />If we inspect the traffic with <strong>Wireshark</strong> or with the
    nmap <strong>--packet-trace</strong> option, we will not see any communication between the target host and our
    original IP address<br /><br /><br /><br /><br /><br /> <br />Bibliography:<br /><a
      href="https://en.wikipedia.org/wiki/IP_fragmentation" target="_blank">https://en.wikipedia.org/wiki/IP_fragmentation</a><br /><a
      href="https://nmap.org/book/idlescan.html" target="_blank">https://nmap.org/book/idlescan.html</a><br /> <br /> <br />
  </div>
</body>

</html>