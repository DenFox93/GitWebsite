<!doctype html>
<html>

<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <title>DNS Spoofing (Router)</title>
  <meta name="generator" content="CherryTree">
  <link rel="stylesheet" href="res/styles3.css" type="text/css" />
</head>

<body>
  <div class='page'>
    <h1 class='title'>DNS Spoofing (Router)</h1><br />DNS discussed also in these chapters:<br />• <a
      href="Home--Pentesting_Basics--networking--protocols--protocol_layers--IP_protocol_suite_(TCP-IP)--Application_layer--DNS.html">TCP/IP
      → Application layer → DNS</a><br />• <a
      href="Home--Penetration_Test_Methodology--Network_Pentest--Scanning_and_Enumeration--DNS.html">Recoinnaisssance →
      DNS</a><br />• <a
      href="Home--Penetration_Test_Methodology--Network_Pentest--Sniffing-Spoofing-Poisoning--Active_Sniffing-Spoofing--DNS_Spoofing_(Router).html">Sniffing
      → DNS Spoofing (router)</a><br />• <a
      href="Home--Penetration_Test_Methodology--Network_Pentest--Vulnerability_assessment--Manual_Testing--DNS.html">Vulnerability
      Assessment → DNS</a><br />• <a
      href="Methodology--Network_Pentest--Sniffing-Spoofing-Poisoning--NetNTLM_attacks--Man-in-the-Middle_techniques_(ipv6)--NTLM_Relay_attack_(ipv6).html">Post
      Exploitation → MitM attack → NTLM relay attack → DNS Spoofing</a><br /><br /><strong>
      <h3>DNS Spoofing</h3>
    </strong><br /><a
      href="Home--Pentesting_Basics--networking--protocols--protocol_layers--IP_protocol_suite_(TCP-IP)--Application_layer--DNS.html">DNS</a>(Application
    Layer 7) is a service running usually on routers to maps the name of a domain to its IP address.<br />We also seen
    the DNS protocol before to <a
      href="Home--Penetration_Test_Methodology--Network_Pentest--Scanning_and_Enumeration--DNS.html">understand and take
      informations about an infrastructure</a><br /><br />An attacker who is able to view network traffic, in particular
    the UDP packets containing DNS requests, could reply to these requests with a forged response.<br />Since DNS uses
    UDP, a connectionless protocol, the first DNS response that <span style="text-decoration:underline;">has the correct
      transaction ID</span> and <span style="text-decoration:underline;">arrives at the correct port</span> will be
    accepted.<br />For the attack to work need:<br />• UDP source port (only the DNS server uses port 53;
    clients(victim) will use a different port for each request)<br />• transaction ID of the victim’s DNS
    request<br /><br /><strong>Tools that we can use</strong><br />• DNSspoof from the suite Dsniff by Dug Song → <a
      href="https://www.monkey.org/~dugsong/dsniff/" target="_blank">https://www.monkey.org/~dugsong/dsniff/</a><br /> DNSspoof will
    respond to any DNS request of the victim and inform him that your IP is the IP of the domain he is looking for.
    <br /><br />
  </div>
</body>

</html>