<!doctype html>
<html>

<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <title>WMAP</title>
  <meta name="generator" content="CherryTree">
  <link rel="stylesheet" href="res/styles3.css" type="text/css" />
</head>

<body>
  <div class='page'>
    <h1 class='title'>WMAP</h1><br />GitHub: <a
      href="https://github.com/rapid7/metasploit-framework/blob/04e8752b9b74cbaad7cb0ea6129c90e3172580a2/plugins/wmap.rb" target="_blank">https://github.com/rapid7/metasploit-framework/blob/04e8752b9b74cbaad7cb0ea6129c90e3172580a2/plugins/wmap.rb</a><br /><strong>Architecture(How
      it works)</strong> <br /> <a href=""><img src="images/1627-1.png"
        alt="images/1627-1.png" /></a><br /><br /><br />WMAP is a <span style="text-decoration:underline;">Web
      assessment plugin</span> for the metasploit framework from Efrain Torres (<a
      href="https://twitter.com/etlow" target="_blank">@etlow</a>), a tool that is been presented for the first time at the <a
      href="https://defcon.org/images/defcon-17/dc-17-presentations/defcon-17-efrain_torres-metasploit_goes_web.pdf" target="_blank">DefCon
      17 (August 2009)</a>.<br />The best documentation of this plugin can be found here: <a
      href="https://github.com/rapid7/metasploit-framework/blob/8909ad12ba83b22b90c196815991817f70530ae5/documentation/wmap.txt" target="_blank">documentation
      github</a> <br /><br /><strong>Phases</strong><br />1. Metasploit Crawler/Spider<br /> Metasploit includes its own
    application with spidering/crawling capabilities. <br /> The below crawlers are <span
      style="text-decoration:underline;">not serviceable replacements for Burp or ZAP</span>, but be aware of them as a
    potential feature to employ when needed.<br /> ◇ <strong>auxiliary/crawler/msfcrawler</strong> (better, developed
    directly by Efrain Torres)<br /> ◇ auxiliary/scanner/http/crawler<br />2. Import sites to the database<br /> ◇ use
    <a
      href="tion_Test_Methodology--WebApp_Pentest--Vulnerability_assessment--Automated_Scanners--Metasploit--Continue_from_previous_Scans_(db_import).html">db_import</a>
    to import previous scans from other tools<br />
    <div class="codebox">
      <div class="codebox">
        root@kali#&nbsp;systemctl&nbsp;start&nbsp;postgresql<br />root@kali#&nbsp;msfdb&nbsp;init<br />root@kali#&nbsp;msfconsole<br />msf&gt;&nbsp;workspace&nbsp;-a&nbsp;[nameNewWorkspace]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#create&nbsp;a&nbsp;new&nbsp;workspace<br />msf&gt;&nbsp;db_import&nbsp;[file]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#import&nbsp;file
      </div>
    </div><br /> ◇ import manually with wmap_sites <br />
    <div class="codebox">
      <div class="codebox">msf&gt;&nbsp;wmap_sites&nbsp;-a&nbsp;www.example.net,http://192.168.1.66</div>
    </div><br />3. Launch <span style="text-decoration:underline;">WMAP plugin</span><br />
    <div class="codebox">
      <div class="codebox">msf&gt;&nbsp;load&nbsp;wmap<br />msf&gt;&nbsp;help&nbsp;wmap</div>
    </div><br /> <a href=""><img src="images/1627-2.png" alt="images/1627-2.png" /></a><br /> <a href=""><img
        src="images/1627-3.png" alt="images/1627-3.png" /></a><br />4. Targets of wmap<br /> The target of wmap are the
    ones that are stored in the database after that we have <span style="text-decoration:underline;">crawled/spidered
      (point 1)</span> or <span style="text-decoration:underline;">imported (point 2)</span><br />
    <div class="codebox">
      <div class="codebox">
        msf&gt;&nbsp;wmap_sites&nbsp;-l&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#list&nbsp;of&nbsp;posssible&nbsp;targets&nbsp;in&nbsp;the&nbsp;database<br />msf&gt;&nbsp;wmap_targets&nbsp;-t&nbsp;www.example.net,http://192.168.1.66&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#define&nbsp;targets<br />msf&gt;&nbsp;wmap_targets&nbsp;-l&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#list&nbsp;of&nbsp;targets
      </div>
    </div><br />5. List of enabled modules by default<br />
    <div class="codebox">
      <div class="codebox">msf&gt;&nbsp;wmap_run&nbsp;-t</div>
    </div><br /> <a href=""><img src="images/1627-4.png" alt="images/1627-4.png" /></a><br />6. Launch only modules that
    we want (from the previous list)<br /> To include “external” modules of metasploit that are not originally tought
    for WMAP see <a
      href="https://github.com/rapid7/metasploit-framework/blob/8909ad12ba83b22b90c196815991817f70530ae5/documentation/wmap.txt#:~:text=Wmap%20modules%20are%20normal,can%20be%20included%20in%20a%20module%20if%20needed" target="_blank">here</a>
    and here<br />
    <div class="codebox">
      <div class="codebox">
        msf&gt;&nbsp;wmap_run&nbsp;-h<br />msf&gt;&nbsp;wmap_run&nbsp;-m&nbsp;[regex]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#Launch&nbsp;only&nbsp;modules&nbsp;that&nbsp;name&nbsp;match&nbsp;provided&nbsp;regex<br />msf&gt;&nbsp;wmap_run&nbsp;-p&nbsp;[regex]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#Only&nbsp;test&nbsp;path&nbsp;defined&nbsp;by&nbsp;regex
      </div>
    </div><br /> <a href=""><img src="images/1627-5.png" alt="images/1627-5.png" /></a><br /><br />8. Launch the
    scan<br />
    <div class="codebox">
      <div class="codebox">msf&gt;&nbsp;wmap_run&nbsp;-e</div>
    </div><br /> <a href=""><img src="images/1627-6.png" alt="images/1627-6.png" /></a><br />9. Results of the
    scan<br />
    <div class="codebox">
      <div class="codebox">msf&gt;&nbsp;wmap_vulns&nbsp;-l</div>
    </div><br /> <a href=""><img src="images/1627-7.png" alt="images/1627-7.png" /></a><br />
    <br />Bibliography:<br /><a
      href="https://null-byte.wonderhowto.com/how-to/use-metasploits-wmap-module-scan-web-applications-for-common-vulnerabilities-0187572/" target="_blank">https://null-byte.wonderhowto.com/how-to/use-metasploits-wmap-module-scan-web-applications-for-common-vulnerabilities-0187572/</a><br />
  </div>
</body>

</html>