<!doctype html>
<html>

<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <title>Interception Proxies</title>
  <meta name="generator" content="CherryTree">
  <link rel="stylesheet" href="res/styles3.css" type="text/css" />
</head>

<body>
  <div class='page'>
    <h1 class='title'>Interception Proxies</h1><br />With Burp and ZAP, our interception proxies of choice, we can
    perform fuzzing against the application with a goal of discovering XSS flaws.<br /><br />Some examples of input that
    could potentially be relevant to XSS that might not appear as obvious injection points are:<br /> ◇
    User-Agents<br /> ◇ cookies<br /> ◇ session tokens<br /> ◇ custom HTTP headers<br /> ◇ HTTP referer (<a
      href="https://datatracker.ietf.org/doc/html/rfc2616#section-14.36" target="_blank">https://datatracker.ietf.org/doc/html/rfc2616#section-14.36</a>)<br />
    ◇ ...<br /><br /><strong>
      <h3>Burp Intruder: Reflection Tests</h3>
    </strong><br />• <span style="text-decoration:underline;">Battering Ram</span>: An attack type in Burp Intruder that
    submits one payload at multiple positions simultaneously<br />• <span style="text-decoration:underline;">Grep
      Payloads</span>: An option in Burp Intruder that searches the application’s responses for the submitted
    payload<br />• <span style="text-decoration:underline;">Battering Ram + Grep Payload</span>s: Enables us to
    simultaneously fuzz multiple injection points per request to see if any of them are found in a
    response<br /><br /><strong>Burp Intruder workflow:</strong><br />1. first employs the <span
      style="text-decoration:underline;">Battering Ram attack type coupled with Grep Payloads</span>. <br /> 1) <span
      style="text-decoration:underline;">Battery Ram</span><br /> With Burp Intruder we are not limited by where we can
    attempt injection. With Burp Intruder, it is just another position that can be set.<br /> Burp Intruder → Positions
    → Attack Type: Battery Ram<br /> <a href=""><img src="images/1585-1.png" alt="images/1585-1.png" /></a><br /> 2)
    Grep: Payloads<br /> Intruder → Options → Grep-Payloads<br /> This technique has Burp look in the response traffic
    for the payloads we inject.<br /> So, if we inject 42424242, then Grep - Payloads will look within the responses for
    evidence of that string. <br /> This means we can easily look for reflected input.<br /> <a href=""><img
        src="images/1585-2.png" alt="images/1585-2.png" /></a><br /> 3) Under Intruder → Payloads<br /> ▪ we can chose
    our payload list<br /> ▪ add the payloads manually<br /> <a href=""><img src="images/1585-3.png"
        alt="images/1585-3.png" /></a><br /> 5) Now we can Start the attack (Intruder → Positions → Start attack)<br />
    <a href=""><img src="images/1585-4.png" alt="images/1585-4.png" /></a><br /> 6) Results<br /> 1- We need to notice
    if any row of the column &quot;P grep&quot;(Payload grep) is checked. <br /> A check box indicates that our payload
    (in this case, 42424242) was found in the response traffic.<br /> <a href=""><img src="images/1585-5.png"
        alt="images/1585-5.png" /></a><br /> 2- Perform a search in the response, to show us how many time our string
    occurs in the response <br /> <a href=""><img src="images/1585-6.png" alt="images/1585-6.png" /></a><br />2. If in
    the Respnse we had more than a match for reflection, we can follow up with using the <span
      style="text-decoration:underline;">Sniper attack</span> to determine which individual the specific injection
    points resulted in reflection<br /> Intruder → Positions → Attack type: Sniper<br /> <a href=""><img
        src="images/1585-7.png" alt="images/1585-7.png" /></a><br />
  </div>
</body>

</html>