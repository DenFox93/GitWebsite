<!doctype html>
<html>

<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <title>Permitted HTTP Verbs</title>
  <meta name="generator" content="CherryTree">
  <link rel="stylesheet" href="res/styles3.css" type="text/css" />
</head>

<body>
  <div class='page'>
    <h1 class='title'>Permitted HTTP Verbs</h1><br /><strong>
      <h3>Enumerating permitted HTTP Verbs on a Web Application with OPTIONS</h3>
    </strong>
    <h3> </h3><br />• nc<br />
    <div class="codebox">
      <div class="codebox">
        printf&nbsp;&quot;OPTIONS&nbsp;/&nbsp;HTTP/1.1\r\nHost:www.example.com\r\n\r\n&quot;&nbsp;&nbsp;|&nbsp;nc&nbsp;www.example.com&nbsp;80
      </div>
    </div><br /> <a href=""><img src="images/1677-1.png" alt="images/1677-1.png" /></a><br />• curl<br />
    <div class="codebox">
      <div class="codebox">curl&nbsp;-i&nbsp;-X&nbsp;OPTIONS&nbsp;<span
          style="color:#000000;font-weight:400">&lt;</span>IP<span style="color:#000000;font-weight:400">&gt;</span>
      </div>
    </div><br /> <a href=""><img src="images/1677-2.png" alt="images/1677-2.png" /></a><br /><br /><a
      href="Home--Penetration_Test_Methodology--WebApp_Pentest--web_application_basics--HTTP(S)_protocol--API--REST_APIs_and_HTTP_methods--PUT.html">PUT
      verb</a><br />We will be able to use the PUT verb only on writable directories. Leave a directory writable by
    anyone is one of the biggest mistake that an Administrator can do.<br />1. enumerate verbs<br />
    <div class="codebox">
      <div class="codebox">curl&nbsp;-i&nbsp;-X&nbsp;OPTIONS&nbsp;<span
          style="color:#000000;font-weight:400">&lt;</span>IP<span style="color:#000000;font-weight:400">&gt;</span>
      </div>
    </div><br />2. Looking for writable directories. It is a guess work, we need to study the application and understand
    what directories are used to store user submitted avatars, files, attachments…<br />3. Once we have a pool of
    candidate folders we will try our PUT command on them:<br /> ◇ manually <div class="codebox">
      <div class="codebox">
        PUT&nbsp;/[writable&nbsp;directory]//new.html&nbsp;HTTP/1.1<br />Host:&nbsp;example.com<br />Content-type:&nbsp;text/html<br />Content-length:&nbsp;16<br />&lt;p&gt;New&nbsp;File<span
          style="color:#000000;font-weight:400">&lt;</span>p<span style="color:#000000;font-weight:400">&gt;</span>
      </div>
    </div><br /> ◇ davtest tool(<a href="https://github.com/cldrn/davtest" target="_blank">https://github.com/cldrn/davtest</a>)<br />
    <div class="codebox">
      <div class="codebox">davtest&nbsp;-url&nbsp;www.example.com</div>
    </div><br />4. If the folder result vulnerable we need to exploit it by uploading a shell<br /> <br />
    <br />Bibliography:<br />• <a
      href="https://book.hacktricks.xyz/pentesting/pentesting-web/put-method-webdav" target="_blank">https://book.hacktricks.xyz/pentesting/pentesting-web/put-method-webdav</a><br />•
    <a
      href="https://www.yeahhub.com/http-put-method-exploitation-live-penetration-testing/" target="_blank">https://www.yeahhub.com/http-put-method-exploitation-live-penetration-testing/</a>
  </div>
</body>

</html>