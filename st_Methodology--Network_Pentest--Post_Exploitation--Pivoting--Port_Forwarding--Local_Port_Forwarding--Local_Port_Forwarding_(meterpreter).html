<!doctype html>
<html>

<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <title>Local Port Forwarding (meterpreter)</title>
  <meta name="generator" content="CherryTree">
  <link rel="stylesheet" href="res/styles3.css" type="text/css" />
</head>

<body>
  <div class='page'>
    <h1 class='title'>Local Port Forwarding (meterpreter)</h1><br /><strong>Requirements:</strong><br />• Meterpreter
    session between attacker and pivot host<br /><strong>CONS:</strong><br />• We can targets only a single
    port<br /><br />portfwd command is implemented in meterpreter. <br />It allows us to forward connections to specific
    addresses and ports on the remote network<br />OPTIONS:<br /> -L &lt;address&gt; → local IP address to listen on
    (optional, loopback 0.0.0.0 is default)<br /> -l → local port to listen on (lowercase L)<br /> -p → remote port to
    connect to<br /> -r → remote host to connect to<br />ARGUMENTS:<br /> Add → This argument is used to create the
    forwarding.<br /> Delete → This will delete a previous entry from our list of forwarded ports.<br /> List → This
    will list all ports currently forwarded.<br /> Flush → This will delete all ports from our forwarding
    list.<br /><br />
    <div class="codebox">
      <div class="codebox">
        meterpreter&nbsp;&gt;&nbsp;portfwd&nbsp;add&nbsp;-l&nbsp;&lt;AttackerPort&gt;&nbsp;-p&nbsp;&lt;TargetPort&gt;&nbsp;-r&nbsp;&lt;TargetIP&gt;<br />meterpreter&nbsp;&gt;&nbsp;portfwd&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#to&nbsp;see&nbsp;the&nbsp;local&nbsp;forwards
      </div>
    </div><br /> <a href=""><img src="images/780-1.png" alt="images/780-1.png" /></a><br /> <br />Open a new tab:<br />
    <div class="codebox">
      <div class="codebox">
        netstat&nbsp;-tulpn&nbsp;|&nbsp;grep&nbsp;&lt;AttackerPort&gt;&nbsp;&nbsp;&nbsp;#listening&nbsp;connction</div>
    </div><br /> -l → list only the listening ports<br /> -t → list all tcp ports<br /> -u → list all udp ports<br /> -p
    → Show the PID and name of the program to which each socket belongs<br /> -n or --numeric → show numerical addresses
    instead of trying to determine symbolic host<br /> <a href=""><img src="images/780-2.png"
        alt="images/780-2.png" /></a><br /><br />Now every service that try to connect to our local ip address on port
    &lt;AttackerPort&gt; they will be redirected to the &lt;TargetPort&gt; on the host &lt;TargetIP&gt;<br /><span
      style="color:#a5452a;">example: rdesktop</span><br />
    <div class="codebox">
      <div class="codebox">rdesktop&nbsp;127.0.0.1:<span
          style="color:#000000;font-weight:400">&lt;</span>AttackerPort<span
          style="color:#000000;font-weight:400">&gt;</span></div>
    </div><br /> <a href=""><img src="images/780-3.png" alt="images/780-3.png" /></a><br /><br /><span
      style="color:#a5452a;">example: access to a website hosted in the internal network</span><br /> every request from
    our local port 8080 will be forwarded to the &lt;TargetIp&gt; of the site with port 80<br />
    <code>portfwd add -l 8080 -p 80 -r &lt;TargetIP&gt;</code><br /> now we have only to open the browser and connect to
    the internal hosted website(TargetIp) through the exploited machine<br /> <a href=""><img src="images/780-4.png"
        alt="images/780-4.png" /></a><br /> <a href=""><img src="images/780-5.png"
        alt="images/780-5.png" /></a><br /><br /><span style="color:#a52a2a;">example: Telnet<br /></span><a
      href=""><img src="images/780-6.png" alt="images/780-6.png" /></a><br />• connect to Telnet<br /> <a href=""><img
        src="images/780-7.png" alt="images/780-7.png" /></a><br />• cracking telnet service with hydra<br /> WARNING:
    NOT work to to do that check proxychains!!!<br /> <a href=""><img src="images/780-8.png"
        alt="images/780-8.png" /></a><br /> <br /><br /><br /> <br />Bibliography:<br />• <a
      href="https://www.offensive-security.com/metasploit-unleashed/portfwd/" target="_blank">https://www.offensive-security.com/metasploit-unleashed/portfwd/</a>
  </div>
</body>

</html>