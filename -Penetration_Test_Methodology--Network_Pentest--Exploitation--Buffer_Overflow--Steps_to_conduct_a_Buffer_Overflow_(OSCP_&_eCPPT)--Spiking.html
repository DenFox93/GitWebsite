<!doctype html>
<html>
<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <title>Spiking</title>
  <meta name="generator" content="CherryTree">
  <link rel="stylesheet" href="res/styles3.css" type="text/css" />
</head>
<body>
<div class='page'><h1 class='title'>Spiking</h1><br/><br /><br /><br /><br />How we can know which of these command is vulnerable? <br />We nee to do <strong>spiking</strong>. This mean take every command  one at a time (in this example STATS,RTIME,LTIME,...) and send a bunch of characters to see which command is vulnerable by crashing it.<br /><br /><strong>Spiking the service with &quot;generic_send_tcp&quot;</strong><br />As demonstration we can use a script: &quot;generic_send_tcp&quot;<br />    <a href=""><img src="images/2134-1.png" alt="images/2134-1.png" /></a><br />    As spike script(command.spk) we can use something like:<br />    <div class="codebox"><div class="codebox">s_readline();<br />s_string(&quot;[COMMAND]&nbsp;&quot;);<br />s_string_variable(&quot;0&quot;);</div></div><br />    Spike for example the command TRUN<br />        <a href=""><img src="images/2134-2.png" alt="images/2134-2.png" /></a><br /><br /><div class="codebox"><div class="codebox">generic_send_tcp&nbsp;[address]&nbsp;[port]&nbsp;command.spk&nbsp;0&nbsp;0</div></div><br /><a href=""><img src="images/2134-3.png" alt="images/2134-3.png" /></a><br />From Immunity we can see that the command is vulnerable since there is been an <span style="text-decoration:underline;">access violation</span><br />    <a href=""><img src="images/2134-4.png" alt="images/2134-4.png" /></a><br /> <br />    <a href=""><img src="images/2134-5.png" alt="images/2134-5.png" /></a><br />   ◇ EAX → contain the command that we have sent to the server and that go in the Buffer Space<br />      ▪ note that in in this example start with “TRUN <span style="color:#ffa500;">/.:/</span>”, This is been added by the Server Service. <br />        We will need to use <span style="color:#ffa500;">/.:/</span> also during the phase of fuzzing<br /><br />Strange characters:          <br />   <a href=""><img src="images/2134-6.png" alt="images/2134-6.png" /></a><br />   We can follow the register in the stack and check which characters are these</div>
</body>
</html>
