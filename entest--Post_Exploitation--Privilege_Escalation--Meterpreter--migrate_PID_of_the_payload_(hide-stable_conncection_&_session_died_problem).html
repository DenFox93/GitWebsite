<!doctype html>
<html>

<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <title>migrate PID of the payload (hide/stable conncection & session died problem)</title>
  <meta name="generator" content="CherryTree">
  <link rel="stylesheet" href="res/styles3.css" type="text/css" />
</head>

<body>
  <div class='page'>
    <h1 class='title'>migrate PID of the payload (hide/stable conncection & session died problem)</h1>
    <br /><br /><br />With migrate the payload get injected in the target process(here for more informations: <a
      href="https://security.stackexchange.com/questions/90578/how-does-process-migration-work-in-meterpreter" target="_blank">https://security.stackexchange.com/questions/90578/how-does-process-migration-work-in-meterpreter</a>)<br /><br /><br />1.
    <strong>getpid</strong> → id process that we are attached<br /><a href=""><img src="images/831-1.png"
        alt="images/831-1.png" /></a><br /><br />2. <strong>ps</strong> → processes running on the remote
    machine<br /><a href="file://C:/CherryTree/screenshot/Network Attacks/meterpreter-ps.png"><img
        src="images/831-2.png" alt="images/831-2.png" /></a><br /><br />3. Now we have to migrate the process, we have
    two options:<br /> ◇ <strong>migrate</strong> &lt;<strong>PID</strong>&gt; → if we want specify the Process ID(PID)
    to which we want to migrate<br /> <a href=""><img src="images/831-3.png" alt="images/831-3.png" /></a><br /> ◇
    <strong>post/windows/manage/migrate </strong>→ module that will automatically select the PID to which migrate<br />
    <div class="codebox">
      <div class="codebox">meterpreter&nbsp;&gt;&nbsp;run&nbsp;post/windows/manage/migrate</div>
    </div><strong><br /></strong><br /><br /><strong>Useful to make the connection more stable</strong><br />With
    handler (exploit/multi/handler) <br />If after establishing a session it die after some time can be useful to
    configure the module (handler) to automatically migrate once we get a newsession. <br />We can do it by setting the
    option AutoRunScript with one of the twofollowing options:<br /><br />
    <div class="codebox">
      <div class="codebox">
        msf&gt;&nbsp;use&nbsp;exploit/multi/handler<br />msf&gt;&nbsp;set&nbsp;AutoRunScript&nbsp;explorer.exe&nbsp;&nbsp;#for&nbsp;Windows<br />msf&gt;&nbsp;set&nbsp;AutoRunScript&nbsp;migrate&nbsp;-f<br />msf&gt;&nbsp;
      </div>
    </div>
  </div>
</body>

</html>