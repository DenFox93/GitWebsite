<!doctype html>
<html>

<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <title>WPAD Spoofing/Poisoning</title>
  <meta name="generator" content="CherryTree">
  <link rel="stylesheet" href="res/styles3.css" type="text/css" />
</head>

<body>
  <div class='page'>
    <h1 class='title'>WPAD Spoofing/Poisoning</h1><br /><strong>Prerequisites:</strong><br />• Target not patched with
    <a
      href="https://support.microsoft.com/en-us/help/3165191/ms16-077-security-update-for-wpad-june-14--2016" target="_blank">MS16-077</a>,
    If the Target is patched we can try to make the attack via IPv6 as the described in the chapter <a
      href="Methodology--Network_Pentest--Sniffing-Spoofing-Poisoning--NetNTLM_attacks--Man-in-the-Middle_techniques_(ipv6)--NTLM_Relay_attack_(ipv6).html">NTLM
      Relay Attack(ipv6)</a>.<br /><br /><strong>What is WPAD</strong> <br />Organizations allow internet access through
    Proxy Servers. The Web Proxy Auto-Discovery Protocol (WPAD) is a method used by clients to locate the URL of the
    wpad.dat configuration file using DHCP and/or DNS discovery methods. Once detection and download of the
    configuration file is complete, it can be executed to determine the proxy for a specified URL.<br /><br />The
    address of the server providing the wpad.dat file (which provides this information) would be resolved using DNS, and
    if no entry was returned, the address would be resolved via insecure broadcast protocols such as Link-Local
    Multicast Name Resolution (LLMNR). <br />In 2016 however, Microsoft published a security bulletin <a
      href="https://support.microsoft.com/en-us/help/3165191/ms16-077-security-update-for-wpad-june-14--2016" target="_blank">MS16-077</a>,
    which mitigated this attack by adding two important protections:<br /> ◇ The location of the WPAD file is no longer
    requested via broadcast protocols, but only via DNS.<br /> ◇ Authentication does not occur automatically anymore
    even if this is requested by the server.<br />If the Target is patched we can try to make the attack via IPv6 as the
    described in the chapter <a
      href="Methodology--Network_Pentest--Sniffing-Spoofing-Poisoning--NetNTLM_attacks--Man-in-the-Middle_techniques_(ipv6)--NTLM_Relay_attack_(ipv6).html">NTLM
      Relay Attack(ipv6)</a>.<br /><br />If “Automatic Proxy setup” is enabled (below the Windows 10 settings):<br /> <a
      href=""><img src="images/1200-1.png" alt="images/1200-1.png" /></a><br /> Attacker can act as a Web Proxy
    Auto-Discovery Protocol (WPAD) Server(for example using the Responder utility). <br /> If the attack has success
    Responder will act as Web Proxy for the victims.<strong> </strong><br /><br /><br /> Bibliography:<br />• <a
      href="https://www.ivoidwarranties.tech/posts/pentesting-tuts/responder/wpad/" target="_blank">https://www.ivoidwarranties.tech/posts/pentesting-tuts/responder/wpad/</a><br />•
    <a
      href="https://www.trustedsec.com/blog/wpad-man-in-the-middle-clear-text-passwords/" target="_blank">https://www.trustedsec.com/blog/wpad-man-in-the-middle-clear-text-passwords/</a>
  </div>
</body>

</html>