<!doctype html>
<html>
<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <title>visit a site that we own and verify the visitor logs</title>
  <meta name="generator" content="CherryTree">
  <link rel="stylesheet" href="res/styles3.css" type="text/css" />
</head>
<body>
<div class='page'><h1 class='title'>visit a site that we own and verify the visitor logs</h1><br/><strong><h2>Visit a site that we own and verify the visitor logs</h2></strong><br /><br /><strong>Headers can reveal we are using a Proxy Server or not</strong>:<br />This only in theory because we have to remember the general rule: &quot;Any information obtained from the client cannot be trusted!&quot; and in this case the Headers can be easily modified by the Proxy Server. <br />A Webpage can understand if we are using a Proxy Server by using these <span style="text-decoration:underline;">PHP server variables</span>:<br />      ▪ <code>$_SERVER[&#39;REMOTE_ADDR&#39;]</code> → Added by the Browser of the original Client that make the request<br />      ▪ <code>$_SERVER[&#39;HTTP_CLIENT_IP&#39;]</code> → Added by the Proxy Server, <br />      ▪ <code>$_SERVER[&#39;HTTP_VIA&#39;]</code> → Added by the Proxy Server, ask the IP of the Proxy Server<br />      ▪ <code>$_SERVER[&#39;HTTP_X_FORWARDED_FOR&#39;]</code> →  Added by the Proxy Server, ask the IP of the original real user<br />      <br />   <br /><strong>Classification of the Proxy Servers:</strong><br />   ◇ <span style="text-decoration:underline;">Direct connection (no proxy used)</span><br />      ▪ <code>$_SERVER[&#39;REMOTE_ADDR&#39;]</code>: client real IP<br />      ▪ <code>$_SERVER[&#39;HTTP_VIA&#39;]</code>: None<br />      ▪ <code>$_SERVER[&#39;HTTP_X_FORWARDED_FOR&#39;]</code>: None<br />   ◇ <span style="text-decoration:underline;">High Anonymity Proxy (Elite Proxy)</span><br />      ▪ <code>$_SERVER[&#39;REMOTE_ADDR&#39;]</code>: Proxy server IP<br />      ▪ <code>$_SERVER[&#39;HTTP_VIA&#39;]</code>: None<br />      ▪ <code>$_SERVER[&#39;HTTP_X_FORWARDED_FOR&#39;]</code>: None<br />   ◇ <span style="text-decoration:underline;">Anonymous Proxy</span><br />      ▪ <code>$_SERVER[&#39;REMOTE_ADDR&#39;]</code>: Last proxy server IP<br />      ▪ <code>$_SERVER[&#39;HTTP_VIA&#39;]</code>: Proxy server IP<br />      ▪ <code>$_SERVER[&#39;HTTP_X_FORWARDED_FOR&#39;]</code>: Proxy server IP, followed by a comma to connect multiple proxy server IPs    <br />   ◇ <span style="text-decoration:underline;">Transparent Proxy</span><br />      ▪ <code>$_SERVER[&#39;REMOTE_ADDR&#39;]</code>: Last proxy server IP<br />      ▪ <code>$_SERVER[&#39;HTTP_VIA&#39;]</code>: Proxy server IP<br />      ▪ <code>$_SERVER[&#39;HTTP_X_FORWARDED_FOR&#39;]</code>: The real IP of the client, followed by a comma to connect multiple proxy server IPs<br /><br /><strong>The anonymity of a proxy server depends how it modify the headers</strong><br />These HTTP headers are populated only if the Web Server request them with the PHP variables seen above<br /><table class="table"><tr><th>HTTP-Header  that can reveal your IP-address</th><th>HTTP-Header that can reveal that  you are using a proxy</th></tr><tr><td>ACCPROXYWS</td><td>Mt-Proxy-ID</td></tr><tr><td>Cdn-Src-Ip</td><td>Proxy-agent</td></tr><tr><td>Client-IP</td><td>Proxy-Connection</td></tr><tr><td>client_ip</td><td>Surrogate-Capability</td></tr><tr><td>CUDA_CLIIP</td><td>Via</td></tr><tr><td>Forwarded</td><td>X-Accept-Encoding</td></tr><tr><td>Forwarded-For</td><td>X-ARR-LOG-ID</td></tr><tr><td>REMOTE-HOST</td><td>X-Authenticated-User</td></tr><tr><td>X-Client-Ip</td><td>X-BlueCoat-Via</td></tr><tr><td>X-Coming-From</td><td>X-Cache</td></tr><tr><td>X-Forwarded</td><td>X-CID-HASH</td></tr><tr><td>X-Forwarded-For</td><td>X-Content-Opt</td></tr><tr><td>X-Forwarded-For-IP</td><td>X-D-Forwarder</td></tr><tr><td>X-Forwarded-Host</td><td>X-Fikker</td></tr><tr><td>X-Forwarded-Server</td><td>X-Forwarded-Port</td></tr><tr><td>X-Host</td><td>X-Forwarded-Proto</td></tr><tr><td>X-Network-Info</td><td>X-IMForwards</td></tr><tr><td>X-Nokia-RemoteSocket</td><td>X-Loop-Control</td></tr><tr><td>X-ProxyUser-IP</td><td>X-MATO-PARAM</td></tr><tr><td>X-QIHOO-IP</td><td>X-NAI-ID</td></tr><tr><td>X-Real-IP</td><td>X-Nokia-Gateway-Id</td></tr><tr><td>XCnool_forwarded_for</td><td>X-Nokia-LocalSocket</td></tr><tr><td>XCnool_remote_addr</td><td>X-Original-URL</td></tr><tr><td> </td><td>X-Proxy-ID</td></tr><tr><td> </td><td>X-Roaming</td></tr><tr><td> </td><td>x-teamsite-preremap</td></tr><tr><td> </td><td>X-Tinyproxy</td></tr><tr><td> </td><td>X-TurboPage</td></tr><tr><td> </td><td>X-Varnish</td></tr><tr><td> </td><td>X-Via</td></tr><tr><td> </td><td>X-WAP-Profile</td></tr><tr><td> </td><td>X-WrProxy-ID</td></tr><tr><td> </td><td>X-XFF-0</td></tr><tr><td> </td><td>Xroxy-Connection</td></tr><tr><td> </td><td>And all other headers that begin with X-*</td></tr></table><br /><br /><span style="color:#a5452a;">Examples(using  </span><a href="http://proxydb.net/anon">http://proxydb.net/anon</a><span style="color:#a5452a;">):</span><br />• The header “Via” has revealed that we are using a Proxy in these scenarios:<br />    <a href=""><img src="images/975-1.png" alt="images/975-1.png" /></a> <br />    <a href=""><img src="images/975-2.png" alt="images/975-2.png" /></a><br />• The Headers “Via” and “X-Forwarded-For” have revealed both my address and that i am using a proxy<br />    <a href=""><img src="images/975-3.png" alt="images/975-3.png" /></a></div>
</body>
</html>
