<!doctype html>
<html>
<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <title>Validation of CSRF token depends on request method</title>
  <meta name="generator" content="CherryTree">
  <link rel="stylesheet" href="res/styles3.css" type="text/css" />
</head>
<body>
<div class='page'><h1 class='title'>Validation of CSRF token depends on request method</h1><br/><strong><h3>Validation of CSRF token depends on request method</h3></strong><br /><br />Some applications correctly validate the token when the request uses the POST method but skip the validation when the GET method is used.<br />In this situation, the attacker can switch to the GET method to bypass the validation and deliver a CSRF attack: <br /><br />1. Check the request (in this scenario for update the email)<br />    <a href=""><img src="images/1714-1.png" alt="images/1714-1.png" /></a><br />2. Try to send the request to Burp Repeater and observe if we change the value of the <span style="color:#00dbff;">csrf parameter</span> the request is rejected<br />    <a href=""><img src="images/1714-2.png" alt="images/1714-2.png" /></a><br />    Request rejected, as we expect<br />3. Use Actions→ <span style="text-decoration:underline;">&quot;Change request method&quot;</span> to convert it into a GET request and observe that the CSRF token is no longer verified. <br />    <a href=""><img src="images/1714-3.png" alt="images/1714-3.png" /></a><br />    Now we have a GET request.<br />4. Now that we have the GET request we can see that also if we change the value of the CSRF token, it is still accepted!<br />    <a href=""><img src="images/1714-4.png" alt="images/1714-4.png" /></a><br />    <span style="text-decoration:underline;">This mean that the website is vulnerable!</span><br /><br /><strong>Generate a PoC</strong><br />Right click on the Request → Engagement Tools → Generate CSRF PoC<br />    <a href=""><img src="images/1714-5.png" alt="images/1714-5.png" /></a><br />1. From &quot;Options&quot; select “Include auto-submit script”<br />       <a href=""><img src="images/1714-6.png" alt="images/1714-6.png" /></a><br />2.  Then “Regenerate” then we have two solutions:<br />   ◇ “Copy HTML” and paste it in our attacker Server that in the LAB is called “Exploit Server”<br />   ◇ “Test in Browser”, this can be used just as a PoC for Penetration Testers<br />    Note: if we need to edit the CSRF HTML PoC, remember to edit the same values also in the Request above it<br />    <a href=""><img src="images/1714-7.png" alt="images/1714-7.png" /></a></div>
</body>
</html>
