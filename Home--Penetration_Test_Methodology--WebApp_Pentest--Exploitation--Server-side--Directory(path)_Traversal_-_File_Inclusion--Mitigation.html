<!doctype html>
<html>

<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <title>Mitigation</title>
  <meta name="generator" content="CherryTree">
  <link rel="stylesheet" href="res/styles3.css" type="text/css" />
</head>

<body>
  <div class='page'>
    <h1 class='title'>Mitigation</h1><br /><br />Two layers of defense should be used together to prevent
    attacks:<br /><br />• The application should validate the user input before processing it. Ideally, the validation
    should compare against a whitelist of permitted values. If that isn&#39;t possible for the required functionality,
    then the validation should verify that the input contains only permitted content, such as purely alphanumeric
    characters.<br /> ◇ for example the encoding Evasion technique seen in the chapter <a
      href="-side--Directory(path)_Traversal_-_File_Inclusion--Vulnerabilities_(Local_File_Inclusion)--encodings_bypass--Encoding_(evasion_technique).html">Encoding
      (evasion technique)</a> should be blacklisted<br /><br />• After validating the supplied input, the application
    should append the input to the base directory and use a platform filesystem API to canonicalize the path. It should
    verify that the canonicalized path starts with the expected base directory.<br /> example: Java code to validate the
    canonical path of a file based on user input<br />
    <div class="codebox">
      <div class="codebox">
        File&nbsp;file&nbsp;=&nbsp;new&nbsp;File(BASE_DIRECTORY,&nbsp;userInput);<br />if&nbsp;(file.getCanonicalPath().startsWith(BASE_DIRECTORY))&nbsp;{<br />&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;process&nbsp;file<br />}&nbsp;
      </div>
    </div><br /><br />Bibliography:<br />• <a
      href="https://portswigger.net/web-security/file-path-traversal" target="_blank">https://portswigger.net/web-security/file-path-traversal</a>
  </div>
</body>

</html>