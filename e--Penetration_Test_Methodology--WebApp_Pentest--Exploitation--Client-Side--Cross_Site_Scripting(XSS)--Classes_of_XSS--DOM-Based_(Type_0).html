<!doctype html>
<html>

<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <title>DOM-Based (Type 0)</title>
  <meta name="generator" content="CherryTree">
  <link rel="stylesheet" href="res/styles3.css" type="text/css" />
</head>

<body>
  <div class='page'>
    <h1 class='title'>DOM-Based (Type 0)</h1><br /><a
      href="Home--Penetration_Test_Methodology--WebApp_Pentest--web_application_basics--HTTP(S)_protocol--Document_Object_Model_(DOM).html">Document
      Object Model (DOM)</a> [seen in Web Application → Web Application basics → Document Object Model(DOM)]<br /><br />
    <h6>Differently from the other types of XSS </h6>
    <h6>the vulnerability exists completely in client-side code rather than server-side code</h6><br />As <a
      href="Home--Penetration_Test_Methodology--WebApp_Pentest--web_application_basics--HTTP(S)_protocol--Document_Object_Model_(DOM).html">we
      have seen in this explanation</a> Document Object Model (DOM) is a standard interface provided by JavaScript that
    allows for dynamic access to the pieces of the current page and browser window.<br />A DOM-based XSS attack is
    possible if the web application writes data to the Document Object Model without proper sanitization. The attacker
    can manipulate this data to include XSS content on the web page, for example, malicious JavaScript code.<br />An
    attacker may use several DOM objects to create a Cross-site Scripting attack. The most popular objects from this
    perspective are document.url, document.location, and document.referrer.<br />The DOM events are often used in XSS
    exploitation because they <span style="text-decoration:underline;">allow us to avoid using suspicious characters
      like &lt; and &gt; </span><br /><br />• <strong>What is in common with the other XSS</strong><br /> ◇ Exploitation
    still leads to JavaScript execution<br /> ◇ Flaw still more overtly impactful to the client<br /> ◇ Difficulty
    convincing many organizations of the importance<br /> ◇ Methods of discovery and exploitation of Dom-Based <span
      style="text-decoration:underline;">often</span> closer to Reflected XSS than Stored<br /> ▪ BUT<span
      style="text-decoration:underline;"> there can be both persistent and non-persistent versions of DOM-Based
      XSS</span><br />• <strong>Which are the differences with the other XSS</strong><br /> ◇ It is not the server that
    deliver the attacker’s JavaScript to the client, instead the Javascript execution occur with the rendering of the
    Web Application in the Client side<br /><br /><br /><strong>
      <h3>HTML function that can lead to DOM-XSS vulnerabilities</h3>
    </strong><br />The following are some functions and properties that can lead to DOM-XSS vulnerabilities:<br />•
    Document Object Properties and Methods that can be used on HTML documents<br /> ◇ <a
      href="ethodology--WebApp_Pentest--Exploitation--Client-Side--Cross_Site_Scripting(XSS)--Classes_of_XSS--DOM-Based_(Type_0)--document.write(...).html">document.write()</a><br />
    ◇ document.writeln()<br /> ◇ document.domain<br /> ◇ <a
      href="t--Exploitation--Client-Side--Cross_Site_Scripting(XSS)--Classes_of_XSS--DOM-Based_(Type_0)--document.getElementById('....')innerHTML=....html">element.innerHTML</a><br />
    ◇ element.outerHTML<br /> ◇ element.insertAdjacentHTML<br /> ◇ element.onevent<br />• jQuery(a JavaScript
    Library)<br /> ◇ <a
      href="thodology--WebApp_Pentest--Exploitation--Client-Side--Cross_Site_Scripting(XSS)--Classes_of_XSS--DOM-Based_(Type_0)--JQuery_attr()_method.html">attr()</a>
    method<br /><br /><br /><br /><span style="color:#a5452a;">example payloads:</span><br /> ◇ &quot;
    onload=&quot;javascript:alert(&#39;XSS Example&#39;)<br />
    <div class="codebox">
      <div class="codebox">http://example.com/index.php?name=&quot;&nbsp;onload=&quot;javascript:alert<span
          style="color:#000000;font-weight:400">(</span>&#39;XSS&nbsp;Example&#39;<span
          style="color:#000000;font-weight:400">)</span></div>
    </div><br /> ◇ &quot; onload=&quot;alert(String.fromCharCode(88,83,83))<br />
    <div class="codebox">
      <div class="codebox">http://example.com/index.php?name=&quot;&nbsp;onload=&quot;alert<span
          style="color:#000000;font-weight:400">(</span>String.fromCharCode(88,83,83)<span
          style="color:#000000;font-weight:400">)</span></div>
    </div><br /> by avoid using single quotes can be more harder to detect<br /><br />Bibliography:<br />• <a
      href="https://www.acunetix.com/blog/articles/dom-xss-explained/" target="_blank">https://www.acunetix.com/blog/articles/dom-xss-explained/</a><br />•
    <a
      href="http://www.webappsec.org/projects/articles/071105.shtml" target="_blank">http://www.webappsec.org/projects/articles/071105.shtml</a><br />•
    <a
      href="https://portswigger.net/web-security/cross-site-scripting/dom-based" target="_blank">https://portswigger.net/web-security/cross-site-scripting/dom-based</a>
  </div>
</body>

</html>