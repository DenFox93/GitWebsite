<!doctype html>
<html>

<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <title>document.write(...)</title>
  <meta name="generator" content="CherryTree">
  <link rel="stylesheet" href="res/styles3.css" type="text/css" />
</head>

<body>
  <div class='page'>
    <h1 class='title'>document.write(...)</h1><br /><br />HTML DOM write() Method explanation: <a
      href="https://www.w3schools.com/jsref/met_doc_write.asp" target="_blank">https://www.w3schools.com/jsref/met_doc_write.asp</a><br /><br />Below
    examples contains a<span style="text-decoration:underline;"> DOM-based cross-site scripting</span> vulnerability
    that uses the JavaScript <span style="color:#ff0000;">document.write</span> function, which writes data out to the
    page. The document.write function is called with data from <span style="color:#a020f0;">location.search</span>. <a
      href="https://www.w3schools.com/jsref/prop_loc_search.asp" target="_blank">location.search</a> returns the <span
      style="color:#a020f0;">querystring</span> part of a URL, in this particular case we are asking for the value of
    the <span style="color:#a020f0;">storeId</span> parameter<br /> <a href=""><img src="images/1678-1.png"
        alt="images/1678-1.png" /></a><br /><br /><strong><span style="color:#a5452a;">Example 1</span></strong><br />1.
    Input an alphanumeric test value in the input box<br />2. Inspect the source of the page, we can see that it have
    the following javascript code<br /> <a href=""><img src="images/1678-2.png" alt="images/1678-2.png" /></a><br />3.
    This mean that if we insert a JavaScript code in the input box it will be executed, because the page is writing
    whatever you typed in the URL to the page with <span style="color:#ff0000;">document.write</span> function.<br />
    <br />4. payload: <span style="color:#ff8700;">&quot;&gt;&lt;svg onload=alert(1)&gt;</span><br /> <a href=""><img
        src="images/1678-3.png" alt="images/1678-3.png" /></a><br /> the payload will substitute <span
      style="color:#a020f0;">query</span> <br /> document.write(&#39;&lt;img
    src=&quot;/resources/images/tracker.gif?searchTerms=&#39;<span style="color:#ff8700;">&quot;&gt;&lt;svg
      onload=alert(1)&gt;</span>&#39;&quot;&gt;&#39;);<br /> <a href=""><img src="images/1678-4.png"
        alt="images/1678-4.png" /></a><br /><br />Bibliography:<br />â€¢ <a
      href="https://portswigger.net/web-security/cross-site-scripting/dom-based/lab-document-write-sink" target="_blank">https://portswigger.net/web-security/cross-site-scripting/dom-based/lab-document-write-sink</a><br /><br /><strong><span
        style="color:#a5452a;">Example 2</span></strong><br />1. In this case there is not an input box, but we can
    select a product from the list to visualize. <br />2. Click on one of it an inspect he source code<br /> <a
      href=""><img src="images/1678-5.png" alt="images/1678-5.png" /></a><br /> this is referring at the following
    dropdown menu in the website<br /> <a href=""><img src="images/1678-6.png" alt="images/1678-6.png" /></a><br /> We
    can notice from the source code JavaScript extracts a <span style="color:#a020f0;">storeId</span> parameter from the
    location.search source. It then uses <span style="color:#ff0000;">document.write</span> to create a new option in
    the select element for the stock checker functionality.<br /><br /><br />3. Test it with an an alphanumeric value:
    &amp;storeID=123456<br /> <a href=""><img src="images/1678-7.png" alt="images/1678-7.png" /></a><br /> <a
      href=""><img src="images/1678-8.png" alt="images/1678-8.png" /></a><br /> <a href=""><img src="images/1678-9.png"
        alt="images/1678-9.png" /></a><br />5. Use a payload: <span
      style="color:#a020f0;">&amp;storeId=&quot;&gt;&lt;/select&gt;&lt;img src=1 onerror=alert(1)&gt;</span><br /> <a
      href=""><img src="images/1678-10.png" alt="images/1678-10.png" /></a><br /> <a href=""><img
        src="images/1678-11.png" alt="images/1678-11.png" /></a><br /> <a href=""><img src="images/1678-12.png"
        alt="images/1678-12.png" /></a><br /> With the above payload the page will be visualized like<br />
    document.write(&#39;&lt;select name=&quot;<span style="color:#a020f0;">&quot;&gt;&lt;/select&gt;&lt;img src=1
      onerror=alert(1)&gt;</span>&quot;&gt;&#39;);<br /><br />Bibliography:<br /><a
      href="https://portswigger.net/web-security/cross-site-scripting/dom-based/lab-document-write-sink-inside-select-element" target="_blank">https://portswigger.net/web-security/cross-site-scripting/dom-based/lab-document-write-sink-inside-select-element</a>
  </div>
</body>

</html>