<!doctype html>
<html>

<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <title>Edit dnsdrdos.c</title>
  <meta name="generator" content="CherryTree">
  <link rel="stylesheet" href="res/styles3.css" type="text/css" />
</head>

<body>
  <div class='page'>
    <h1 class='title'>Edit dnsdrdos.c</h1><br />Original code: <a
      href="https://raw.githubusercontent.com/nullsecuritynet/tools/master/dos/dnsdrdos/release/dnsdrdos.c" target="_blank">https://raw.githubusercontent.com/nullsecuritynet/tools/master/dos/dnsdrdos/release/dnsdrdos.c</a><br />You
    can find the edited code here: <a
      href="https://github.com/DenFox93/DNS-Amplification-DDOS-attack">https://github.com/DenFox93/DNS-Amplification-DDOS-attack</a><br />Before
    edit the script dnsdrdos.c we have to understand by capturing packets, which is the difference between a <span
      style="text-decoration:underline;">DNS ANY query</span> and a <span style="text-decoration:underline;">DNS A
      query</span><br /><br /><strong>DNS query ANY record</strong><br /> <a href=""><img src="images/1029-1.png"
        alt="images/1029-1.png" /></a> <a href=""><img src="images/1029-2.png" alt="images/1029-2.png" /></a>
    <br /><strong>DNS query A record</strong><br /> <a href=""><img src="images/1029-3.png"
        alt="images/1029-3.png" /></a><a href=""><img src="images/1029-4.png"
        alt="images/1029-4.png" /></a><br /><br />The hexadecimals that differs depends from the qtype parameter which
    value is set at line 537 of the code.<br />What htons() does is store the number in big-endian notation, this mean
    that the argument is stored with the most significant byte first<br />htons(1) → 0001<br />htons(255) → 00ff<br />
    <a href=""><img src="images/1029-5.png" alt="images/1029-5.png" /></a><br />Thus we have to set qtype=htons(255)
    that stand for 00ff that is interpreted by the network as a “DNS ANY query”<br />
    <div class="codebox">
      <div class="codebox">bomb-&gt;query-&gt;qtype&nbsp;=&nbsp;htons(1);</div>
    </div><br />Now the script will send “DNS ANY query” instead of “DNS A query”<br /><br />To monitor the response and
    check that all is working we have to set as source address(victim) our address in the network that we can find in
    ifconfig<br />
    <div class="codebox">
      <div class="codebox">
        ./dnsdrdosV2&nbsp;-f&nbsp;servers.txt&nbsp;-s&nbsp;192.168.1.122&nbsp;&nbsp;-d&nbsp;ads&nbsp;-l&nbsp;1</div>
    </div>
  </div>
</body>

</html>