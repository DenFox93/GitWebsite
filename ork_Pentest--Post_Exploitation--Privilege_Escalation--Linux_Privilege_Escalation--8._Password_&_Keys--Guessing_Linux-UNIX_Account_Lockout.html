<!doctype html>
<html>
<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <title>Guessing: Linux/UNIX Account Lockout</title>
  <meta name="generator" content="CherryTree">
  <link rel="stylesheet" href="res/styles3.css" type="text/css" />
</head>
<body>
<div class='page'><h1 class='title'>Guessing: Linux/UNIX Account Lockout</h1><br/>Account lockout functionality on Linux or UNIX systems is typically implemented via <strong>Pluggable Authentication Modules (PAM)</strong> or custom package.<br />The pam_tally module is used to lock an account based on a number of unsuccessful connection attempts.<br /><br />The pam_tally configuration is typically stored:<br />• in a series of files in the directory <span style="color:#ff1b00;">/etc/pam.d/</span> (If the <span style="color:#ff1b00;">/etc/pam.d/</span> directory exists, <span style="color:#1e90ff;">pam.conf</span> is ignored)<br />    To check if account lockout settings are enabled, the following command looks for the word &quot;tally&quot; inside of all files in <span style="color:#ff1b00;">/etc/pam.d/</span><br />    <div class="codebox"><div class="codebox">grep&nbsp;tally&nbsp;/etc/pam.d/*</div></div><br />• in the single file <span style="color:#1e90ff;">/etc/pam.conf</span><br />    To check if account lockout settings are enabled, the following command looks for the word &quot;tally&quot; inside the file  <span style="color:#1e90ff;">/etc/pam.conf</span><br />    <div class="codebox"><div class="codebox">grep&nbsp;tally&nbsp;/etc/pam.conf</div></div><br /><br /><span style="color:#a5452a;">example of output:</span><br />    <code>auth required /lib/security/pam_tally.so deny=5 onerr=fail lock_time=180 reset no_magic_root</code><br /><br />OPTIONS of the pam_tally module:<br />   ◇ <strong>onerr = fail </strong>→  increment of the counter<br />   ◇ <strong>deny = n</strong> →  deny access after n bad login attempts<br />   ◇ <strong>lock_time = nsec</strong> →  the account is locked for n seconds<br />   ◇ <strong>no_magic_root</strong> → this configuration tells the system that if a UID 0 process(e.g.:ssh, telnet) tries to access some service, it should still be counted as a bad login attempt against the root account<br />   ◇ <strong>reset</strong> →  resets the counter to 0 if authentication is validated<br />   ◇ <strong>even_deny_root_account</strong> →  account lockout for the root account will be enabled.<br /><br /></div>
</body>
</html>
