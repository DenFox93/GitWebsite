<!doctype html>
<html>

<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <title>Java Deserialization</title>
  <meta name="generator" content="CherryTree">
  <link rel="stylesheet" href="res/styles3.css" type="text/css" />
</head>

<body>
  <div class='page'>
    <h1 class='title'>Java Deserialization</h1><br /><strong><span style="color:#ff0000;">WARNING: NOT TESTED TO BE
        COMPLETED WITH MORE RESOURCES</span></strong><strong><br /></strong><br /><strong>
      <h3>Java Deserialization (aka Deserialization of untrusted data)</h3>
    </strong><br />OWASP: <a
      href="https://www.owasp.org/index.php/Deserialization_of_untrusted_data" target="_blank">https://www.owasp.org/index.php/Deserialization_of_untrusted_data</a><br /><br />To
    make a Java object serializable we implement the <em>java.io.Serializable</em> interface.<br />• <span
      style="text-decoration:underline;">Serialization</span> is a mechanism of converting the state of an object into a
    byte stream. <br /> The <em>ObjectOutputStream</em> class contains <em>writeObject()</em> method for serializing an
    Object.<br />• <span style="text-decoration:underline;">Deserialization</span> is the reverse process where the byte
    stream is used to recreate the actual Java object in memory<br /> The <em>ObjectInputStream</em> class contains
    <em>readObject()</em> method for deserializing an object.<br />The byte stream created is platform independent. So,
    the object serialized on one platform can be deserialized on a different platform<br /><br /><span
      style="color:#a5452a;">example</span><br />this example simply writes the String “bob” to disk using Java’s
    serializable interface, then reads it back in and prints the result. <br />
    <div class="codebox">
      <div class="codebox">
        import&nbsp;java.io.ObjectInputStream;&nbsp;&nbsp;&nbsp;&nbsp;//&lt;---<br />import&nbsp;java.io.FileInputStream;<br />import&nbsp;java.io.ObjectOutputStream;&nbsp;&nbsp;//&lt;---<br />import&nbsp;java.io.FileOutputStream;<br />&nbsp;<br />public&nbsp;class&nbsp;SerializeTest<span
          style="color:#000000;font-weight:400">{</span><br />&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;static&nbsp;void&nbsp;main(String&nbsp;args[])&nbsp;throws&nbsp;Exception{<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//This&nbsp;is&nbsp;the&nbsp;object&nbsp;we&#39;re&nbsp;going&nbsp;to&nbsp;serialize.<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;String&nbsp;name&nbsp;=&nbsp;&quot;bob&quot;;<br />&nbsp;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//We&#39;ll&nbsp;write&nbsp;the&nbsp;serialized&nbsp;data&nbsp;to&nbsp;a&nbsp;file&nbsp;&quot;name.ser&quot;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;FileOutputStream&nbsp;fos&nbsp;=&nbsp;new&nbsp;FileOutputStream(&quot;name.ser&quot;);<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ObjectOutputStream&nbsp;os&nbsp;=&nbsp;new&nbsp;ObjectOutputStream(fos);<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;os.writeObject(name);&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//&lt;---<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;os.close();<br />&nbsp;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//Read&nbsp;the&nbsp;serialized&nbsp;data&nbsp;back&nbsp;in&nbsp;from&nbsp;the&nbsp;file&nbsp;&quot;name.ser&quot;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;FileInputStream&nbsp;fis&nbsp;=&nbsp;new&nbsp;FileInputStream(&quot;name.ser&quot;);<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ObjectInputStream&nbsp;ois&nbsp;=&nbsp;new&nbsp;ObjectInputStream(fis);<br />&nbsp;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//Read&nbsp;the&nbsp;object&nbsp;from&nbsp;the&nbsp;data&nbsp;stream,&nbsp;and&nbsp;convert&nbsp;it&nbsp;back&nbsp;to&nbsp;a&nbsp;String<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;String&nbsp;nameFromDisk&nbsp;=&nbsp;(String)ois.readObject();&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//&lt;---<br />&nbsp;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//Print&nbsp;the&nbsp;result.<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;System.out.println(nameFromDisk);<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ois.close();<br />&nbsp;&nbsp;&nbsp;&nbsp;}<br /><span
          style="color:#000000;font-weight:400">}</span></div>
    </div><br /><a href=""><img src="images/1450-1.png"
        alt="images/1450-1.png" /></a><br /><br /><strong>Vulnerability</strong><br />Vulnerabilities arise when
    developers write code that accepts serialized data from untrusted users and attempt to unserialize it for use in the
    program. Depending on the language, this can lead to all sorts of consequences, but most interesting, and the one we
    will talk about here is remote code execution.<br /><br /><br />Bibliography:<br />• <a
      href="https://www.geeksforgeeks.org/serialization-in-java" target="_blank">https://www.geeksforgeeks.org/serialization-in-java</a><br />•
    <a
      href="https://foxglovesecurity.com/2015/11/06/what-do-weblogic-websphere-jboss-jenkins-opennms-and-your-application-have-in-common-this-vulnerability/" target="_blank">https://foxglovesecurity.com/2015/11/06/what-do-weblogic-websphere-jboss-jenkins-opennms-and-your-application-have-in-common-this-vulnerability/</a><br />•
    hands on replicate vulnerability: <a
      href="https://zonksec.com/blog/hands-on-with-weblogic-serialization-vulnerability/" target="_blank">https://zonksec.com/blog/hands-on-with-weblogic-serialization-vulnerability/</a>
  </div>
</body>

</html>