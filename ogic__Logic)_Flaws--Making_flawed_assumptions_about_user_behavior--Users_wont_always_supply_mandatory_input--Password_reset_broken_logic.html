<!doctype html>
<html>

<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <title>Password reset broken logic</title>
  <meta name="generator" content="CherryTree">
  <link rel="stylesheet" href="res/styles3.css" type="text/css" />
</head>

<body>
  <div class='page'>
    <h1 class='title'>Password reset broken logic</h1><br /><br />In this WebApp the password reset functionality is
    vulnerable. <span style="text-decoration:underline;">A mandatory parameter(</span><span
      style="color:#a020f0;text-decoration:underline;">temp-forgot-password-token</span><span
      style="text-decoration:underline;">) can be removed from the request</span><br /><br /><br />W<h6>hen we send the
      POST request with the new password for the reset functionality are sent also:<br /> ◇ </h6>
    <h6>username</h6>
    <h6> as </h6>
    <h6>in the POST parameters</h6>
    <h6>. Can we change the value of it with another username?</h6><br /> ◇ <span
      style="color:#a020f0;">temp-forgot-password-token</span> parameter in both the URL and request body<br /> <a
      href=""><img src="images/1892-1.png" alt="images/1892-1.png" /></a> <br /><br /><strong>
      <h3>Vulnerability Check</h3>
    </strong><br />Observe that the password reset functionality still works even if we delete the value of the <span
      style="color:#a020f0;">temp-forgot-password-token</span> parameter in both the URL and request body. <br />This
    confirms that <strong>the token is NOT being checked when you submit the new password</strong>.<br /> <a
      href=""><img src="images/1892-2.png" alt="images/1892-2.png" /></a><br /><br /><br /><strong>
      <h3>Exploit</h3>
    </strong><br />Delete the value of the <span style="color:#a020f0;">temp-forgot-password-token</span> parameter in
    both the URL and request body. Change the <span style="color:#ffa500;">username</span> parameter to another existing
    one (example:carlos). <br />Set the new password to whatever you want and send the request.<br /> <a href=""><img
        src="images/1892-3.png" alt="images/1892-3.png" /></a><br /><br />Lets try to login with the credentials
    inserted before carlos:PASS2<br /><a href=""><img src="images/1892-4.png"
        alt="images/1892-4.png" /></a><br /><br /><br /><br />Bibliography:<br />• <a
      href="https://portswigger.net/web-security/authentication/other-mechanisms/lab-password-reset-broken-logic" target="_blank">https://portswigger.net/web-security/authentication/other-mechanisms/lab-password-reset-broken-logic</a>
  </div>
</body>

</html>