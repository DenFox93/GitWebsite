<!doctype html>
<html>
<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <title>Sniffing Windows Challenge/Response Authentication</title>
  <meta name="generator" content="CherryTree">
  <link rel="stylesheet" href="res/styles3.css" type="text/css" />
</head>
<body>
<div class='page'><h1 class='title'>Sniffing Windows Challenge/Response Authentication</h1><br/>Instead of grabbing the SAM from a target machine, the attacker could sniff challenge/response authentication from the network<br />To do that the attacker have two option:<br />• <strong>The attacker could sniff the challenge/response exchange between a client and server.</strong><br />    1. To do that the tester would have to be located at a spot in the network through which these exchanges are transmitted.<br />    2. After sniffing the exchanges the attacker needs to crack the authenification protocol used (LANMAN Challenge/Response, NTLMv1, NTLMv2 or Microsoft Kerberos)<br />• <strong>Trick the user into doing challenge/response authentication with the attacker&#39;s machine</strong>.<br />    With this approach, the attacker might even force the client to use a weaker and more easily cracked password hash mechanism(LANMAN Challenge/Response or NTLMv1).<br />    <span style="color:#a5452a;">example:</span><br />    1. The attacker could send the user an email with a link in it of the form file://[AttackerIP]/[AttackerShare]<br />    2. Upon that link being clicked in most email readers, the victim&#39;s machine will try to mount a share on the attacker&#39;s machine, performing Windows authentication with it.<br />    3. The attacker could sniff the exchange between the client and the attacker&#39;s own machine to get a challenge and response suitable for cracking<br /><br /><br /><br /><strong>To know how the algorithms work go to:<br />     </strong><a href="--Post_Exploitation--Privilege_Escalation--Active_Directory(Windows)_Privilege_Escalation--How_work_Authentification_in_a_Windows_Network.html">Cryptography and Password Cracking → Password and Authentication → Windows → How work Authentication in Windows</a><br /><br /><strong>To know more how to do these attacks go to:<br />    </strong><a href="Home--Penetration_Test_Methodology--Network_Pentest--Sniffing-Spoofing-Poisoning--NetNTLM_attacks.html">Exploitation → Metasploit → Windows Authentication Attack → LM/NTLMv1 Attack</a></div>
</body>
</html>
