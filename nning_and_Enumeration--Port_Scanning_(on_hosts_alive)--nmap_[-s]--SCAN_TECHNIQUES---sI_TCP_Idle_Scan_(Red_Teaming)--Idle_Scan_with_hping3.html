<!doctype html>
<html>
<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <title>Idle Scan with hping3</title>
  <meta name="generator" content="CherryTree">
  <link rel="stylesheet" href="res/styles3.css" type="text/css" />
</head>
<body>
<div class='page'><h1 class='title'>Idle Scan with hping3</h1><br/><strong><h2>Understand how the Idle Scan work at a low level (using hping3)</h2></strong><br /><br />the first step when running an idle scan is finding a good zombie host<br />1. find at least one open port on the remote host(zombie)<br />    <code>hping3 -S --scan known [ZombieIP]</code><br />    <div class="codebox"><div class="codebox">hping3&nbsp;-S&nbsp;--scan&nbsp;known&nbsp;192.168.1.76</div></div><br />    <a href=""><img src="images/649-1.png" alt="images/649-1.png" /></a><br />    <strong>-S </strong>→ SYN flag enabled<br />2. we can detect if the host is a good zombie by estimating the host (zombie) traffic with hping3.<br />    In the following example the ID increments by 1, meaning that the host does not communicate with any machine on the network but only with us, making it a possible zombie candidate<br />    <code>hping3 -S -r [ZombieIP] -p [ZombiePort]</code><br />    <div class="codebox"><div class="codebox">hping3&nbsp;-S&nbsp;-r&nbsp;192.168.1.76&nbsp;-p&nbsp;135</div></div><br />    <a href=""><img src="images/649-2.png" alt="images/649-2.png" /></a><br />    <strong>-r </strong>→  allows us to see the relative ID increments instead of the actual ID.<br />    Otherwise we will see the actual ID: <br />    <a href=""><img src="images/649-3.png" alt="images/649-3.png" /></a><br />    if the IP ID increases by one, it can be considered a viable candidate.<br />    But we can never be 100% sure because:<br />      ▪ We have to validate if it is a global or local increase<br />      ▪ Some hosts increase IP ID on a per host basis<br />    <strong>-p</strong> → sets the destination port, which in our case is 135<br /><br />3. Now that we have found our target zombie(192.168.1.76) we can use hping3 to craft packets that will be sent to the target host we want to scan with source IP address of our zombie<br />    <code>hping3 -a [ZombieIP] -S -p [TargetPort] [TargetIPaddress]</code><br />    <div class="codebox"><div class="codebox">hping3&nbsp;-a&nbsp;192.168.1.76&nbsp;-S&nbsp;-p&nbsp;139&nbsp;192.168.1.42</div></div><br />    <strong>-a</strong> → spoof the zombie source address, this become the source IP address<br />    <strong>-S</strong> → SYN flag enabled<br />    <strong>-p</strong> → destination port of the packet<br /><br />    To know if the TargetPort of the TargetIPaddress is open we have to continue to run the command at the point 2, If in the output the <span style="color:#ff8700;">ID increment is +2</span> this mean that the TargetPort is open<br />    <a href=""><img src="images/649-4.png" alt="images/649-4.png" /></a><br /><br /></div>
</body>
</html>
