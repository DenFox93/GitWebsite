<!doctype html>
<html>
<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <title>Hooking IRP</title>
  <meta name="generator" content="CherryTree">
  <link rel="stylesheet" href="res/styles3.css" type="text/css" />
</head>
<body>
<div class='page'><h1 class='title'>Hooking IRP</h1><br/><strong>Layered devices</strong><br />The Windows Driver Model (WDM) uses a layered-driver model to chain multiple drivers togheter <br />The lowest-level driver deals with direct access to the bus and the hardware device, and higher-level drivers deal with data formatting and error codes.<br />IRPs (I/O Request Packets) is the way how the drivers communicate, and are passed up and down inside the chain of drivers [2].<br />A driver adds itself to the chain of drivers by first creating a device, and then inserting the device into the group of devices.<br /><br />Some rootkits use this layered-driver model to install drivers on the file system, keyboard, or network stack. The layered-driver rootkit can then intercept events and modify the output, thereby changing the behavior of the underlying system.[1]<br />  <br />Bibliography: <br />1. Crimeware: Understanding New Attacks and Defenses<br />2. Windows Driver Development Kit<br /></div>
</body>
</html>
