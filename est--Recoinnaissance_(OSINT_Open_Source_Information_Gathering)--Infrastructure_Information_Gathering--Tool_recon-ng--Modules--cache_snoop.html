<!doctype html>
<html>
<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <title>cache_snoop</title>
  <meta name="generator" content="CherryTree">
  <link rel="stylesheet" href="res/styles3.css" type="text/css" />
</head>
<body>
<div class='page'><h1 class='title'>cache_snoop</h1><br/><strong><h2>Use the DNS Cache Snooping to find antivirus used by the target organization</h2></strong><br />It relies upon sending non-recursive DNS queries to the corporate DNS server to determine whether that DNS server has a cache that includes that AV manufacturer&#39;s website. If it does, that means that someone within the organization is using that AV software (someone is the organization has had to go to the website to update signatures) If it doesn&#39;t, it means that no one has queried for that AV manufacturers site and is likely not using that software.<br /><br />We first need to find the nameserver for our target website<br /><div class="codebox"><div class="codebox">dig&nbsp;elsfoo.com&nbsp;NS</div></div><br /><a href=""><img src="images/631-1.png" alt="images/631-1.png" /></a><br /><br />to get the IP from the nameserver<br /><div class="codebox"><div class="codebox">dig&nbsp;-t&nbsp;A&nbsp;ns2.elsfoo.com</div></div><br /><br />let&#39;s use another Recon-ng module to determine the most likely antivirus tool or tools the target organization is using<strong><br /></strong><div class="codebox"><div class="codebox">back<br />modules&nbsp;load&nbsp;discovery/info_disclosure/cache_snoop<br />options&nbsp;list</div></div><br />    <a href=""><img src="images/631-2.png" alt="images/631-2.png" /></a><br /><br />Even though we already set NAMESERVER(DNS server of the target organization) before, you need to set it again. This module doesn’t read that variable from the global variable store, so we need to set it here in the context of this module.<strong><br /></strong><div class="codebox"><div class="codebox">options&nbsp;set&nbsp;NAMESERVER&nbsp;198.178.124.83&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#IP&nbsp;address&nbsp;of&nbsp;elsfoo.com</div></div><br />    <a href=""><img src="images/631-3.png" alt="images/631-3.png" /></a><br /><br /><div class="codebox"><div class="codebox">run</div></div><br /><br />As the module runs, look carefully at its output. You&#39;ll note that it says “Not Found.” for the majority of the domain names. But if show  it “Snooped!” is likely that that the target organization is utilizing the “Snooped” antivirus product listed.<br />This information about the target&#39;s AV vendor is tremendously useful in our penetration test,<br /><a href=""><img src="images/631-4.png" alt="images/631-4.png" /></a></div>
</body>
</html>
