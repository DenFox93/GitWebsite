<!doctype html>
<html>

<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <title>Event Handlers blocked</title>
  <meta name="generator" content="CherryTree">
  <link rel="stylesheet" href="res/styles3.css" type="text/css" />
</head>

<body>
  <div class='page'>
    <h1 class='title'>Event Handlers blocked</h1><br /><br /><br /><br />0. Location of the Response with “payload”
    “204a2fb1”: <br /> <a href=""><img src="images/1931-1.png" alt="images/1931-1.png" /></a><br /> between HTML
    tags<br />1. Use Portswigger cheat-sheet ( <a
      href="https://portswigger.net/web-security/cross-site-scripting/cheat-sheet" target="_blank">https://portswigger.net/web-security/cross-site-scripting/cheat-sheet</a>)
    with Burp Intruder:<br /> ◇ <span style="text-decoration:underline;">Tags</span> attributes allowed:
    animatetrasform, image, svg, title<br /> <a href=""><img src="images/1931-2.png"
        alt="images/1931-2.png" /></a><br /> ◇ <span style="text-decoration:underline;">Events Handlers</span>
    attributes allowed: No One!<br /> <a href=""><img src="images/1931-3.png"
        alt="images/1931-3.png" /></a><br /><br />1. Set svg--&gt;animatetransform because are the two tags
    allowed<br /> <a href=""><img src="images/1931-4.png" alt="images/1931-4.png" /></a><br />2. Unfortunately there are
    not payload without Event Handlers<br /><br />4. Go back to the <strong>Intruder</strong> and use payload:
    <code>&lt;svg&gt;&lt;animatetransform%20=1&gt;</code> (remember that %20 is a space).<br /> Place the cursor before
    the = character and click &quot;<span style="color:#1e90ff;">Add §</span>&quot; twice to create a payload position.
    The value of the search term should now
    be: <code>&lt;svg&gt;&lt;animatetransform%20</code><strong><code><span style="color:#1e90ff;">§§</span></code></strong><code>=1&gt;</code><br /><br />5.
    Visit the <a href="https://portswigger.net/web-security/cross-site-scripting/cheat-sheet" target="_blank">XSS cheat sheet</a> and
    click &quot;Copy events to clipboard&quot;.<br /> <a href=""><img src="images/1931-5.png"
        alt="images/1931-5.png" /></a><br />2. In Burp Intruder, in the Payloads tab, click &quot;Clear&quot; to remove
    the previous payloads. Then click &quot;Paste&quot; to paste the list of attributes into the payloads list. Click
    &quot;Start attack&quot;.<br /> <a href=""><img src="images/1931-6.png" alt="images/1931-6.png" /></a><br />4. When
    the attack is finished, review the results. Note that all payloads caused an HTTP 400 response, except for
    the <strong>onbegin</strong> payload, which caused a 200 response.<br /> <a href=""><img src="images/1931-7.png"
        alt="images/1931-7.png" /></a><br />5. We can construct our payload like this:<br />
    <div class="codebox">
      <div class="codebox">/?search=&quot;&gt;&lt;svg&gt;<span
          style="color:#000000;font-weight:400">&lt;</span>animatetransform&nbsp;onbegin=alert(1)<span
          style="color:#000000;font-weight:400">&gt;</span></div>
    </div><br /> encode the payload with Burp Decoder(url option) and send it from burp:<br />
    <div class="codebox">
      <div class="codebox">
        /?search=%27%3e%3c%73%76%67%3e%3c%61%6e%69%6d%61%74%65%74%72%61%6e%73%66%6f%72%6d%20%6f%6e%62%65%67%69%6e%3d%61%6c%65%72%74%28%31%29%3e
      </div>
    </div><br /> <a href=""><img src="images/1931-8.png" alt="images/1931-8.png" /></a><br /> <strong>Note</strong>: we
    have used <code>&quot;&gt;&lt;</code> before the payload because first we have closed the brackets (sometimes is not
    necessary, depends from the context)<br /> <a href=""><img src="images/1931-9.png"
        alt="images/1931-9.png" /></a><br /> <strong>Note</strong>: <span style="text-decoration:underline;">Use always
      double quotes</span> in the payload otherwise it could not work. <br /> <br />6. Quotes non necessary in this
    scenario <br /> But if we see the context where the result is reflected, also without the quotes work, like
    below:<br />
    <div class="codebox">
      <div class="codebox">/?search=&lt;svg&gt;<span
          style="color:#000000;font-weight:400">&lt;</span>animatetransform&nbsp;onbegin=alert(1)<span
          style="color:#000000;font-weight:400">&gt;</span></div>
    </div><br /><br /> <br /> <br /><a
      href="http://https:/https://it1lib.org/book/16086758/42740e/www.w3schools.com/tags/ref_attributes.asp" target="_blank">Rodolfo
      Assis Cheat Sheet 2020</a><br /> <a href=""><img src="images/1931-10.png"
        alt="images/1931-10.png" /></a><br /><br /> <br /><br /><br /><br /><strong>Bibliography:</strong><br />• <a
      href="https://portswigger.net/web-security/cross-site-scripting/cheat-sheet" target="_blank">https://portswigger.net/web-security/cross-site-scripting/cheat-sheet</a><br />•
    <a
      href="https://portswigger.net/web-security/cross-site-scripting/contexts/lab-some-svg-markup-allowed" target="_blank">https://portswigger.net/web-security/cross-site-scripting/contexts/lab-some-svg-markup-allowed</a>
  </div>
</body>

</html>