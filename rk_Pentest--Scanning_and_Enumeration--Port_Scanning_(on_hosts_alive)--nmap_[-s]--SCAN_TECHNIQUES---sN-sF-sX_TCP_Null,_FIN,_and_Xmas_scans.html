<!doctype html>
<html>

<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <title>-sN/sF/sX: TCP Null, FIN, and Xmas scans</title>
  <meta name="generator" content="CherryTree">
  <link rel="stylesheet" href="res/styles3.css" type="text/css" />
</head>

<body>
  <div class='page'>
    <h1 class='title'>-sN/sF/sX: TCP Null, FIN, and Xmas scans</h1><br /><br />These scans exploit a loophole in the <a
      href="http://www.rfc-editor.org/rfc/rfc793.txt" target="_blank">RFC:793</a> (page 65) in order to differentiate between open and
    closed ports.<br /><a href=""><img src="images/623-1.png" alt="images/623-1.png" /></a><br /><a href=""><img
        src="images/623-2.png" alt="images/623-2.png" /></a><br /><a href=""><img src="images/623-3.png"
        alt="images/623-3.png" /></a><br /><br />What TCP RFC above basically states is that when we sent an incoming
    packet <strong><span style="text-decoration:underline;">NOT containing</span></strong><span
      style="text-decoration:underline;"> SYN neither RST neither ACK)</span>:<br />• to a destination port that is
    <strong><span style="color:#a020f0;">closed</span></strong><br /> ◇ <span style="color:#ff8700;">send RST+ACK as
      response</span> <br />• to a destination port that is <strong><span
        style="color:#00ff00;">open|filtered</span></strong> (nmap list these, the other ports are considered
    closed)<br /> ◇ <span style="color:#ff0000;">drop the segment and return</span><br /> <br /><br /><strong>
      <h3>How to exploit this behavior</h3>
    </strong><br />The TCP RFC says <span style="text-decoration:underline;">NOT containing</span> this mean that any
    combination of the others bits (FIN, PSH, URG) are anyway acceptable! <br />This mean, if the target machine follows
    RFC 793 carefully, we can use them to know when a port is <span style="color:#a020f0;">closed </span>or <span
      style="color:#00ff00;">open</span>.<br />Nmap exploits this with three scan types:<br />• Null scan (-sN) → send
    TCP packets without any flags set (TCP flag header is 0)<br /> <a href=""><img src="images/623-4.png"
        alt="images/623-4.png" /></a><br /> <a href=""><img src="images/623-5.png" alt="images/623-5.png" /></a><a
      href=""><img src="images/623-6.png" alt="images/623-6.png" /></a><br /> ◇ FIN scan (-sF) → Only sets the TCP FIN
    flag<br /> <a href=""><img src="images/623-7.png" alt="images/623-7.png" /></a><a href=""><img
        src="images/623-8.png" alt="images/623-8.png" /></a><br />• Xmas scan (-sX) → Sets the FIN, PSH, and URG flags,
    is called like that because light the packet up like a Christmas tree<br /> <a href=""><img src="images/623-9.png"
        alt="images/623-9.png" /></a><a href=""><img src="images/623-10.png" alt="images/623-10.png" /></a><br />This
    types of scans no more are so stealthy because most modern IDS and firewalls can be configured to detect them.
    <br />Moreover most of the OSs(Windows,Cisco IOS,...) does not follow the RFC:793 to the letter and send RST+ACK
    response regardless the port is open or not and this causes the ports to be labeled as <span
      style="color:#a020f0;">closed</span>. This scan does work against most <strong>Unix-based</strong> systems
    though.<br /><br />Another downside of these scans is that they can&#39;t always distinguish open ports from certain
    filtered ones. If the packet filter sends an ICMP destination prohibited error, Nmap knows that a port is filtered.
    But most filters simply drop banned probes <span style="color:#ff0000;">without any response</span>, making the
    ports appear <span style="color:#00ff00;">open</span>. So Nmap will return a <strong><span
        style="color:#00ff00;">open|filtered</span></strong> result and we will have to test further(with -sV or -sA) to
    determine the actual state. Anyway we to take in mind that adding version detection (-sV) defeats much of the
    stealthy nature of this scan<br /><br /><br />Bibliography: <br /><a
      href="https://nmap.org/book/scan-methods-null-fin-xmas-scan.html" target="_blank">https://nmap.org/book/scan-methods-null-fin-xmas-scan.html</a>
  </div>
</body>

</html>