<!doctype html>
<html>

<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <title>Case Study: The Dao Hack</title>
  <meta name="generator" content="CherryTree">
  <link rel="stylesheet" href="res/styles3.css" type="text/css" />
</head>

<body>
  <div class='page'>
    <h1 class='title'>Case Study: The Dao Hack</h1><br /><br /><br /><strong>
      <h2>The Dao Hack</h2>
    </strong><br />The DAO attack was the most famous blockchain attack ever performed. The DAO was a venture capital
    fund which pooled investors Ether for funding projects much like a crowdfunding application. The project initially
    raised 12.7 million Ether which at the time was equal to about 150 million dollars.<br /><br />This Smart Contract
    contained a SplitDao function meant for removing funds into a child DAO when a user didn’t like a majority decision
    of how to use funds. However, a Reentrancy vulnerability within the split function was found that ultimately allowed
    the attacker to remove 3.6 million Ether from the contract. This was a lot of money, but the bigger issue was the
    decision made by the Ethereum community to roll back the transaction, and give the users their funds back. As this
    violates the immutability of the blockchain. This should never happen again, but due to the immaturity of the
    network at the time, they felt it was needed.<br /><br />This is the only time the Ethereum network violated the
    immutability of the blockchain and rolled back transactions on the Ethereum blockchain. The decision created a major
    idealistic split in the Ethereum community resulting in a hard fork of the network. Because of this split we now
    Ethereum classic and Ethereum. The network hard forked into two separate chains. <br />• <span
      style="text-decoration:underline;">Ethereum Classic</span>: that contains the loss of funds<br />• <span
      style="text-decoration:underline;">Ethereum</span>: that does not contain the rollback and the funds were returned
    to the investors<br /><br /><br />
    <div class="codebox">
      <div class="codebox">
        function&nbsp;splitDAO(<br />&nbsp;&nbsp;&nbsp;&nbsp;uint&nbsp;_proposalID,<br />&nbsp;&nbsp;&nbsp;&nbsp;address&nbsp;_newCurator<br />&nbsp;&nbsp;&nbsp;&nbsp;<br />&nbsp;&nbsp;&nbsp;&nbsp;noEther&nbsp;onlyTokenholders&nbsp;returns&nbsp;(bool&nbsp;_success))&nbsp;<span
          style="color:#000000;font-weight:400">{</span><br />&nbsp;&nbsp;&nbsp;&nbsp;//Snipped&nbsp;lines&nbsp;for&nbsp;Readability<br />&nbsp;&nbsp;&nbsp;&nbsp;Transfer(msg.sender,&nbsp;0,&nbsp;balances[msg.sender]);<br />&nbsp;&nbsp;&nbsp;&nbsp;withdrawRewardFor(msg.sender);<br />&nbsp;&nbsp;&nbsp;&nbsp;totalSupply&nbsp;-=&nbsp;balances[msg.sender];&nbsp;<br />&nbsp;&nbsp;&nbsp;&nbsp;balances[msg.sender]&nbsp;=&nbsp;0;<br />&nbsp;&nbsp;&nbsp;&nbsp;paidOut[msg.sender]&nbsp;=&nbsp;0;<br />&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;true;<br /><span
          style="color:#000000;font-weight:400">}</span></div>
    </div><br /><br />If you take a look at lines 7-11 you will see a violation of our <strong>Checks → Effects →
      Interactions</strong> pattern.<br /><span style="text-decoration:underline;">Interactions</span>: line 7-8 the
    contract is making withdrawal calls<br /><span style="text-decoration:underline;">Effects</span>: the balances are
    updated on lines 10-11, only after the withdrawals<br />If the attacker were to call back into the splitDao function
    when the interaction happened on line 8 then the attacker is able to drain the contract of millions of dollars. The
    balances are never updated until the attackers code is finished with its
    functionality.<br /><br />Bibliography:<br />• <a
      href="https://hackingdistributed.com/2016/06/18/analysis-of-the-dao-exploit/" target="_blank">https://hackingdistributed.com/2016/06/18/analysis-of-the-dao-exploit/</a><br />•
    <a
      href="https://ogucluturk.medium.com/the-dao-hack-explained-unfortunate-take-off-of-smart-contracts-2bd8c8db3562" target="_blank">https://ogucluturk.medium.com/the-dao-hack-explained-unfortunate-take-off-of-smart-contracts-2bd8c8db3562</a><br />•
    <a
      href="http://console-cowboys.blogspot.com/2020/09/leveraging-reentrancy-attacks.html" target="_blank">http://console-cowboys.blogspot.com/2020/09/leveraging-reentrancy-attacks.html</a><br />
  </div>
</body>

</html>