<!doctype html>
<html>

<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <title>Capture/sniff packet received</title>
  <meta name="generator" content="CherryTree">
  <link rel="stylesheet" href="res/styles3.css" type="text/css" />
</head>

<body>
  <div class='page'>
    <h1 class='title'>Capture/sniff packet received</h1><br /><br />Documentation: <a
      href="https://rubydoc.org/github/todb/packetfu/PacketFu/Capture" target="_blank">https://rubydoc.org/github/todb/packetfu/PacketFu/Capture</a><br /><br />During
    <a href="Home--Pentesting_Basics--Ruby--Network_Interaction--Raw_Sockets--PacketFu--Forge_UDP_packet.html">Forge UDP
      Packet</a> and <a
      href="Home--Pentesting_Basics--Ruby--Network_Interaction--Raw_Sockets--PacketFu--Forge_TCP_packet.html">Forge TCP
      packet</a> we have seen(with wireshark) that our machine has actually received a response from the target, <span
      style="text-decoration:underline;">but the kernel if we do not specify does not process
      it</span>.<br /><br /><strong>How to Capture/sniff the packets:</strong><br />1. create a Capture object <br />2.
    specify the interface where it will capture the traffic (eth0 is the default NIC).<br /> <a href=""><img
        src="images/1971-1.png" alt="images/1971-1.png" /></a><br />3. we can also specify a filter as a capture
    parameter in order to capture only specific packets that comes from our target<br /> <span
      style="color:#a52a2a;">example:</span> capture packets that comes from host 192.168.3.137 and has source port
    80<br /> <a href=""><img src="images/1971-2.png" alt="images/1971-2.png" /></a><br /><br />4. To check if our
    interface received a packet which matches the filter, we can use the next method.<br /> ◇ nil → means that there is
    not one matching<br /> ◇ Otherwise → the packet is returned<br /> <a href=""><img src="images/1971-3.png"
        alt="images/1971-3.png" /></a><br /> *Note: with <span style="color:#ffa500;">t.to_w</span> we have sent the
    forged packet seen in <a
      href="Home--Pentesting_Basics--Ruby--Network_Interaction--Raw_Sockets--PacketFu--Forge_TCP_packet.html">Forge TCP
      packe</a><br /> <br /><br /><strong>View/Parse the Raw Packet received</strong>:<br />
    <div class="codebox">
      <div class="codebox">tcp_packet=Packet.parse&nbsp;raw_packet</div>
    </div><br /> As we can see in the interpreter, the packet received is the desired SYN+ACK (flag A and S) packet
    coming from port:80 and host:192.168.3.137<br /> <a href=""><img src="images/1971-4.png"
        alt="images/1971-4.png" /></a>
  </div>
</body>

</html>