<!doctype html>
<html>
<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <title>Weakness of Session Tokens</title>
  <meta name="generator" content="CherryTree">
  <link rel="stylesheet" href="res/styles3.css" type="text/css" />
</head>
<body>
<div class='page'><h1 class='title'>Weakness of Session Tokens</h1><br/><br /><strong>Looks for patterns in Session Tokens</strong><br />Sending repeated, &quot;new&quot; (without session information) requests for the login page will normally cause the web application to generate a new session ID each time.<br />Look for patterns in the generated session IDs. Are they somewhat sequential? Do they change in an identifiable pattern? Are there any fields that do not change?<br /><br />If the token can be  predicted, an attacker could guess what session tokens have already been used and then hijack an active session.<br /><span style="color:#a5452a;">example: Incremental token</span><br />• First login: 74eb2cd93f2a95b<strong>a</strong><br />• Next login: 74eb2cd93f2a95b<strong>b</strong><br />• Next login: 74eb2cd93f2a95b<strong>c</strong> <br />• ............................................  ← GAP<br />• Next login: 74eb2cd93f2a95b<strong>f</strong><br /><br /><span style="color:#a5452a;">example 2: MD5 hash token of integers</span><br />• c4ca4238a0b923820dcc509a6f75849b ← md5sum(1)<br />• c81e728d9d4c2f636f067f89cc14862c  ← md5sum(2)<br />• eccbc87e4b5ce2fe28308fd9f2a7baf3  ← md5sum(3)<br />• a87ff679a2f3e71d9181a67b7542122c  ← md5sum(4)<br /><br /><strong>What makes a session identifier strong</strong><br />• Valid for only a single session <br />• Time Limited<br />• Purely random (thus unpredictable)<br /><br /><strong>Where not store Session Tokens</strong><br />• URL →  the session token will be leaked to external sites though the referrer header and in the user browser history<br />• HTML →  the session token could be cached in the browser or intermediate proxies<br />• HTML5 Web Storage<br />   ◇ Localstorage →  will last until it is explicitly deleted, so this may make session last too long<br />   ◇ Sessionstorage →  is only destroyed when the browser is closed. There may be users that do not close their browser for a long time</div>
</body>
</html>
