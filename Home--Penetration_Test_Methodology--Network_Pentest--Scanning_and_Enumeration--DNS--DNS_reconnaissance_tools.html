<!doctype html>
<html>
<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <title>DNS reconnaissance tools</title>
  <meta name="generator" content="CherryTree">
  <link rel="stylesheet" href="res/styles3.css" type="text/css" />
</head>
<body>
<div class='page'><h1 class='title'>DNS reconnaissance tools</h1><br/><br /><strong>Useful DNS Reconnaissance Tools</strong><br />• <strong>nslookup</strong><br />    Most of the time we can start interrogating DNS via nslookup and then move to dig which is far more powerful<br />    <div class="codebox"><div class="codebox">root@kali:/#&nbsp;nslookup&nbsp;<span style="color:#000000;font-weight:400">&lt;</span>domain<span style="color:#000000;font-weight:400">&gt;</span></div></div><br />   ◇ PROS<br />      ▪ Near-universal availability, including UNIX, Linux, macOS, and Windows<br />   ◇ Cons:<br />      ▪ It has limited functionality compared to dig<br />• <strong>dig</strong><br />    <div class="codebox"><div class="codebox">root@kali:/#&nbsp;dig&nbsp;@&lt;nameserver&gt;&nbsp;&lt;domain&gt;&nbsp;-t&nbsp;any&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#Look&nbsp;up&nbsp;all&nbsp;domain&nbsp;records&nbsp;(SOA,&nbsp;A,&nbsp;NS,&nbsp;MX,&nbsp;..)<br />root@kali:/#&nbsp;dig&nbsp;@&lt;nameserver&gt;&nbsp;&lt;domain&gt;&nbsp;-t&nbsp;mx&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#Look&nbsp;up&nbsp;MX&nbsp;records<br />root@kali:/#&nbsp;dig&nbsp;@&lt;nameserver&gt;&nbsp;&lt;domain&gt;&nbsp;-t&nbsp;axfr&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#attempt&nbsp;zone&nbsp;transfer<br />root@kali:/#&nbsp;dig&nbsp;@&lt;nameserver&gt;&nbsp;version.bind&nbsp;chaos&nbsp;txt&nbsp;&nbsp;#Query&nbsp;the&nbsp;nameserver&#39;s&nbsp;version&nbsp;of&nbsp;BIND</div></div><br />   ◇ PROS:<br />      ▪ Available natively on macOS and most UNIX/Linux distros<br />   ◇ CONS:<br />      ▪ It is not installed natively on Windows<br />• <strong>Nmap NSE Scripts</strong><br />    <div class="codebox"><div class="codebox">root@kali:/#&nbsp;ls&nbsp;/usr/share/nmap/scripts/dns*</div></div><br />    <a href=""><img src="images/1475-1.png" alt="images/1475-1.png" /></a><br /><br />• <strong>DNSRecon</strong><br />    <div class="codebox"><div class="codebox">root@kali:/#&nbsp;dnsrecon&nbsp;-d&nbsp;<span style="color:#000000;font-weight:400">&lt;</span>domain<span style="color:#000000;font-weight:400">&gt;</span></div></div><br />   ◇ Check all NS Records for Zone Transfers.<br />   ◇ Enumerate General DNS Records for a given Domain (MX, SOA, NS, A, AAAA, SPF and TXT).<br />   ◇ Perform common SRV Record Enumeration.<br />   ◇ Top Level Domain (TLD) Expansion.<br />   ◇ Check for Wildcard Resolution.<br />   ◇ Brute Force subdomain and host A and AAAA records, given a domain and a wordlist.<br />   ◇ Perform a PTR Record lookup for a given IP Range or CIDR.<br />   ◇ Check a DNS Server Cached records for A, AAAA and CNAME Records provided a list of host records in a text file to check.<br />   ◇ Enumerate Common mDNS records in the Local Network.<br />   ◇ Enumerate Hosts and Subdomains using Google. 1<br /><br />• <strong>Metasploit</strong><br />    DNS information-gathering auxiliary modules<br />   ◇ post/multi/gather/dns_bruteforce → Performs a brute force dictionary DNS scan<br />   ◇ post/multi/gather/dns_cache_scraper → Queries DNS cache for previously resolved names<br />   ◇ post/multi/gather/dns_info → Gathers general DNS information<br />   ◇ post/multi/gather/dns_reverse_lookup → Performs a reverse DNS (PTR) scan of a netblock, replicate DNSRecon&#39;s reverse brute force with same wordlist<br />   ◇ post/multi/gather/dns_srv_enum → Enumerates SRV (Server) records<br /></div>
</body>
</html>
