<!doctype html>
<html>
<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <title>Powershell Session on a Target machine of the domain</title>
  <meta name="generator" content="CherryTree">
  <link rel="stylesheet" href="res/styles3.css" type="text/css" />
</head>
<body>
<div class='page'><h1 class='title'>Powershell Session on a Target machine of the domain</h1><br/><br />2. Now we can access to any machine with:<br />   ◇ a valid Username<br />   ◇ password: “mimikatz”<br />   <div class="codebox"><div class="codebox">PS&gt;&nbsp;Enter-PSSession&nbsp;-ComputerName&nbsp;&lt;hostname&gt;.&lt;FQDN&gt;&nbsp;-Credential&nbsp;<span style="color:#000000;font-weight:400">&lt;</span>account<span style="color:#000000;font-weight:400">&gt;</span></div></div> <br />   <br />   <span style="color:#a5452a;">example on the Domain Controller:</span><br />      ▪ To know the Credential account of the Target machine(on the target machine):<br />          <div class="codebox"><div class="codebox">PS&gt;&nbsp;whoami</div></div><br />          <a href=""><img src="images/1157-1.png" alt="images/1157-1.png" /></a><br />      ▪ To know the hostname of the Target machine(on the target machine):<br />          <div class="codebox"><div class="codebox">PS&gt;&nbsp;hostname</div></div><br />           <a href=""><img src="images/1157-2.png" alt="images/1157-2.png" /></a><br />        <div class="codebox"><div class="codebox">PS&gt;&nbsp;Enter-PSSession&nbsp;-ComputerName&nbsp;testdc.daniele.local&nbsp;-Credential&nbsp;daniele\administrator</div></div><br />        <a href=""><img src="images/1157-3.png" alt="images/1157-3.png" /></a><br />   <br />   <span style="color:#a5452a;">example on another machine of the domain:</span><br />    The remote machine must have first WinRM service and Network Discovery enabled to allow remote access from remote computers.<br />    <div class="codebox"><div class="codebox">PS&gt;&nbsp;netsh&nbsp;advfirewall&nbsp;firewall&nbsp;set&nbsp;rule&nbsp;group=”network&nbsp;discovery”&nbsp;new&nbsp;enable=yes&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#enable&nbsp;network&nbsp;discovery<br />PS&gt;&nbsp;Enable-PSRemoting&nbsp;-force&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#locally&nbsp;on&nbsp;the&nbsp;target&nbsp;machine,&nbsp;we&nbsp;can&nbsp;do&nbsp;it&nbsp;in&nbsp;TTEST&nbsp;phase<br />PS&gt;&nbsp;winrm&nbsp;quickconfig&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#set&nbsp;WinRM&nbsp;to&nbsp;autostart</div></div><br />      ▪ To know the Credential account of the Target machine(on the target machine):<br />          <div class="codebox"><div class="codebox">PS&gt;&nbsp;whoami</div></div><br />          <a href=""><img src="images/1157-4.png" alt="images/1157-4.png" /></a><br />      ▪ To know the hostname of the Target machine(on the target machine):<br />          <div class="codebox"><div class="codebox">PS&gt;&nbsp;hostname</div></div><br />           <a href=""><img src="images/1157-5.png" alt="images/1157-5.png" /></a><br />     <div class="codebox"><div class="codebox">PS&gt;&nbsp;Enter-PSSession&nbsp;-ComputerName&nbsp;superman.daniele.local&nbsp;-Credential&nbsp;daniele\ckent</div></div><br />    <a href=""><img src="images/1157-6.png" alt="images/1157-6.png" /></a><br /><br />When we are prompted for a password, we can insert “mimikatz” or the original password of the account<br />   <a href=""><img src="images/1157-7.png" alt="images/1157-7.png" /></a></div>
</body>
</html>
