<!doctype html>
<html>
<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <title>-PS/-PA: no ping (spot a firewall)</title>
  <meta name="generator" content="CherryTree">
  <link rel="stylesheet" href="res/styles3.css" type="text/css" />
</head>
<body>
<div class='page'><h1 class='title'>-PS/-PA: no ping (spot a firewall)</h1><br/><br />After tried with the Ping Sweeping we can try with another method, that not require ping the hosts to find new hosts<br />Some servers and ports are protected by <span style="text-decoration:underline;">firewalls that block pings</span> but on certain system there are always some ports open. <br /><table class="table"><tr><th>protocol</th><th>port/protocol</th><th>Service</th></tr><tr><td>TCP</td><td>21</td><td>FTP (File Transfer Protocol)</td></tr><tr><td>TCP</td><td>22</td><td>SSH - Secure login, file transfer (scp, sftp) e port forwarding</td></tr><tr><td>TCP</td><td>25</td><td>SMTP - Simple Mail Transfer Protocol (E-mail)</td></tr><tr><td>UDP</td><td>53</td><td>DNS - Domain Name System</td></tr><tr><td>TCP</td><td>80,443</td><td>HTTP HyperText Transfer Protocol (WWW)</td></tr><tr><td>TCP</td><td>111</td><td>ONC RPC, sometimes referred to as Sun RPC</td></tr><tr><td>TCP</td><td>135</td><td>DCE/RPC Locator service endpoint,used to remotely manage services</td></tr><tr><td>TCP</td><td>137-139</td><td>NetBIOS Name Service</td></tr><tr><td>TCP</td><td>445</td><td>NetBIOS Datagram ServiceWindows shares (SMB), also Linux equivalent – Samba service</td></tr><tr><td>TCP</td><td>502</td><td>ICS Modbus</td></tr><tr><td>TCP</td><td>1433, 1434</td><td>MySQL Database</td></tr><tr><td>TCP</td><td>1521</td><td>Oracle database</td></tr><tr><td>TCP</td><td>3200</td><td>Application Server ABAP, SAP Dispatcher</td></tr><tr><td>TCP</td><td>3300</td><td>Application Server ABAP, Gateway</td></tr><tr><td>TCP</td><td>3306</td><td>Database: MySQL, MariaDB</td></tr><tr><td>TCP</td><td>3389</td><td>RDP - Remote Desktop Protocol</td></tr><tr><td>TCP</td><td>8080,8443</td><td>HTTP(s) web server, HTTP proxy</td></tr><tr><td>TCP</td><td>9088,9089</td><td>Informix Dynamic Server</td></tr><tr><td>TCP</td><td>16300</td><td>Oracle WebCenter Content: Records Management</td></tr><tr><td>TCP</td><td>20000</td><td>ICS DNP3</td></tr><tr><td>TCP</td><td>44818</td><td>Ethernet/IP</td></tr><tr><td>TCP</td><td>50000,50001</td><td>DB2</td></tr></table><br /><br />So if we suspect that there are hosts <span style="text-decoration:underline;">protected by firewall against ping sweeping</span> we can use the option <strong>-PS</strong> of nmap <br />This is the ranking of the most common ports:<br />80,23,443,21,22,25,3389,110,445,139,143,53,135,3306,8080,1723,111,995,993,5900<br /><br /><strong><h3>If we suspect hosts are protected by firewalls and do not respond to pings</h3></strong><br />We can also use this technique on the most basic TCP ports as an alternative to ping sweep to identify the hosts that are alive<br /><div class="codebox"><div class="codebox">nmap&nbsp;-n&nbsp;-PS21,22,25,53,80,110,111,135,139,443,445&nbsp;10.50.96.0/23</div></div><br />    -n → no DNS resolution for IP addresses<br />    -sn → no port scan after host discovery<br />    -PS → TCP SYN Ping; check if an host is online by probe specific ports. It sends a SYN packet to the ports selected(if not specified only to port 80), If the target gives any reply (SYN/ACK or RST) then it is marked as &quot;up&quot; and our machine drop the connection with a RST packet. If -sn is not specified it start a -sT(TCP scan on the most 1000 common ports).<br />     Both -PS and -sS are used to be more stealthy but <span style="text-decoration:underline;">while -PS is used to check if an host is online, -sS is used to discover open ports and services on the hosts</span><br />    <a href=""><img src="images/581-1.png" alt="images/581-1.png" /></a><a href=""><img src="images/581-2.png" alt="images/581-2.png" /></a><br />    <br /><br />OTHER OPTIONS TO BYPASS FIREWALLS:<br />-PA  → -PA is quite similar to the -PS option. The difference, is that ACK flag is set instead of the SYN flag.<br />    Like -PS is used to discover if a Host is responding. It can be used to detect hosts that block SYN packets or ICMP requests.<br />    The reason for offering both SYN and ACK ping probes is to maximize the chances of bypassing firewalls. <br />    If the host is:<br />      ◇ <strong>live</strong> it will return a RST and will be treated as online. RST packet is sent because the ACK packet sent is not associated with an existing valid connection <br />      ◇ <strong>offline</strong> it should not respond to this request<br />    We can select max 10 ports to scan with this option<br />    <div class="codebox"><div class="codebox">nmap&nbsp;-n&nbsp;-sn&nbsp;-PA21,22,25,53,80,110,111,135,139,443,445&nbsp;192.168.1.97</div></div><br />    <a href=""><img src="images/581-3.png" alt="images/581-3.png" /></a><a href=""><img src="images/581-4.png" alt="images/581-4.png" /></a><br /><br /></div>
</body>
</html>
