<!doctype html>
<html>
<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <title>SUID Shells</title>
  <meta name="generator" content="CherryTree">
  <link rel="stylesheet" href="res/styles3.css" type="text/css" />
</head>
<body>
<div class='page'><h1 class='title'>SUID Shells</h1><br/><strong>Prerequisite:</strong><br />/bin/bash need to have:<br />   ◇ SUID bit set<br />   ◇ owned by the root user<br /><br /><strong>Spawn a root shell</strong><br />To spawn a root shell we need to create a copy of the /bin/bash (or /bin/sh) executable file and rename it (example:rootbash ).<br />A root shell then can be spawned by simply executing the renamed bash file(example:rootbash) file with the -p command line option.<br />    -p → Turn on privileged mode. In this mode bash keep the <span style="color:#ff0000;">effective ID</span> it is launched with the SUID bit, instead of the <span style="color:#ff0000;">effective ID</span> of the actual user. <br />PROS:<br />   ◇ it is persistent (once you run the exploit, rootbash can be used multiple times).<br /><br /><strong>Find SUID files</strong><br /><div class="codebox"><div class="codebox">find&nbsp;/&nbsp;-perm&nbsp;-u=s&nbsp;-type&nbsp;f&nbsp;2&gt;/dev/null<br />find&nbsp;/*&nbsp;-user&nbsp;root&nbsp;-perm&nbsp;-4000&nbsp;-print&nbsp;2&gt;/dev/null&nbsp;&nbsp;&nbsp;#alternative</div></div></div>
</body>
</html>
