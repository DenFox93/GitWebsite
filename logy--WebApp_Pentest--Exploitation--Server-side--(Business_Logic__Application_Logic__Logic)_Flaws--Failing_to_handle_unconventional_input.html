<!doctype html>
<html>

<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <title>Failing to handle unconventional input</title>
  <meta name="generator" content="CherryTree">
  <link rel="stylesheet" href="res/styles3.css" type="text/css" />
</head>

<body>
  <div class='page'>
    <h1 class='title'>Failing to handle unconventional input</h1><br /><br /><br />One aim of the application logic is
    to restrict user input to values that adhere to the business rules. Many applications incorporate numeric limits
    into their logic. This might include limits designed to manage:<br /> ◇ inventory<br /> ▪ prevent users from
    ordering more units than are currently in stock<br /> ◇ apply budgetary restrictions<br /> ▪ prevent users from
    supplying a negative value in the parameters (in some scenarios)<br /> ◇ trigger phases of the supply chain<br /> ◇
    ...<br /><span style="text-decoration:underline;">If there is no explicit logic for handling a given case, this can
      lead to unexpected and potentially exploitable behavior</span><br /><br /><br /><span
      style="color:#a52a2a;">example negative amount: funds transfer between two bank accounts</span><br />
    <div class="codebox">
      <div class="codebox">
        <br />$transferAmount&nbsp;=&nbsp;$_POST[&#39;amount&#39;];<br />$currentBalance&nbsp;=&nbsp;$user-&gt;getBalance();<br /><br />if&nbsp;($transferAmount&nbsp;&lt;=&nbsp;$currentBalance)&nbsp;{<br />&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;Complete&nbsp;the&nbsp;transfer<br />}&nbsp;else&nbsp;<span
          style="color:#000000;font-weight:400">{</span><br />&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;Block&nbsp;the&nbsp;transfer:&nbsp;insufficient&nbsp;funds<br /><span
          style="color:#000000;font-weight:400">}</span></div>
    </div><br />This code check if the sender has sufficient funds before completing the transfer, but it doesn&#39;t
    sufficiently prevent users from supplying a negative value in the amount parameter.  If the attacker sent -$1000 to
    the victim&#39;s account, this might result in them receiving $1000 from the victim instead<br /> <br />
    <br /><br /><br /><strong>
      <h3>Bibliography:</h3>
    </strong><br /><a
      href="https://portswigger.net/web-security/logic-flaws/examples#excessive-trust-in-client-side-controls" target="_blank">https://portswigger.net/web-security/logic-flaws/examples#excessive-trust-in-client-side-controls</a>
  </div>
</body>

</html>