<!doctype html>
<html>
<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <title>LANMANN --> NT</title>
  <meta name="generator" content="CherryTree">
  <link rel="stylesheet" href="res/styles3.css" type="text/css" />
</head>
<body>
<div class='page'><h1 class='title'>LANMANN --> NT</h1><br/>LANMAN password hashes are weak because the algorithm used takes all passwords and converts them to uppercase characters before calculating the password representation. This action (as well as several other design flaws) makes cracking LANMAN hashes far easier because we can just attack them with all uppercase alphabetic guesses.<br />Most Windows systems store the LANMAN hash along with the stronger NT hash, which preserves the case of the password. But on most Windows 2000 and later systems, authentication happens via NT hashes. <br />Thus, we have to run through all combinations of uppercase and lowercase of the LANMAN password until you hit the right combination. To do that we can use the lm2ntcrack tool<br /><br /><br /><strong>lm2ntcrack</strong> tool took as input an already-cracked LANMAN password(cracked) and an NT hash(to be cracked).<br />It applies all the various case combinations to the uppercase LANMAN password to determine the NT password, which is mixed case. <br /><br /><strong><h3>lm2ntcrack is been implemented by John the Ripper</h3></strong><br />With this method we can crack NT hashes faster(1 minute of cracking) compared to directly crack NT hashes (days of cracking)<br />1. We have the file <code>pwdump.txt</code> with the LM and NT hashes<br />    <span style="color:#a5452a;">example:</span><br />    Administrator:500:AA1AB12D9BE8C0D18F900ABF62624751:A2855453E8F6E555E5F22956F7DAA398:::<br />2. First we have to crack the LANMAN hash that is pretty weak<br />    <div class="codebox"><div class="codebox">john&nbsp;-format:LM&nbsp;pwdump.txt</div></div><br />    <a href=""><img src="images/760-1.png" alt="images/760-1.png" /></a><br />    The uppercase LANMANN password is &quot;SUPERPASSWORD&quot;<br />3. Now we have to <code>show</code> all the cracked passwords from the pwdump.txt file and with the command <code>cut</code> take only the second argument that is the password cracked.<br />    We have to save it in a new file, in this example <code>cracked.txt</code><br />    <div class="codebox"><div class="codebox">john&nbsp;-show&nbsp;pwdump.txt&nbsp;|&nbsp;cut&nbsp;-d:&nbsp;-f2&nbsp;&gt;&nbsp;cracked.txt</div></div><br />4. Now we have to use as <code>wordlist</code> the only word “SUPERPASSWORD” contained in cracked.txt and to it apply the rules NT contained in the file john.conf<br />    <a href=""><img src="images/760-2.png" alt="images/760-2.png" /></a><br />    <div class="codebox"><div class="codebox">john&nbsp;-wordlist=cracked.txt&nbsp;-rules:nt&nbsp;-format=nt&nbsp;pwdump.txt</div></div><br />    <a href=""><img src="images/760-3.png" alt="images/760-3.png" /></a><br />    We have now found the NT password that is SuPerPaSsWord<br /><br /><strong><h2>Alternative</h2></strong><h2> </h2><br />2. crack the LANMANN hash<br />    <div class="codebox"><div class="codebox">john&nbsp;-format:LM&nbsp;pwdump.txt</div></div><br />3. we can use the option loopback(like --wordlist, but fetch words from a .pot file) without doing any <code>cut</code><br />    <div class="codebox"><div class="codebox">john&nbsp;pwdump.txt&nbsp;-format=nt&nbsp;-loopback=/root/.john/john.pot&nbsp;-rules=nt</div></div><br />    <a href=""><img src="images/760-4.png" alt="images/760-4.png" /></a><br /><br /><br /><br /><br /><br /><br /></div>
</body>
</html>
