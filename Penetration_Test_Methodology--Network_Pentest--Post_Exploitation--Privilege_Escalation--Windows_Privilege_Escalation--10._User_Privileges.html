<!doctype html>
<html>

<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <title>10. User Privileges</title>
  <meta name="generator" content="CherryTree">
  <link rel="stylesheet" href="res/styles3.css" type="text/css" />
</head>

<body>
  <div class='page'>
    <h1 class='title'>10. User Privileges</h1><br /><br /><span style="color:#ff0000;">WARNING: NOT
      TESTED</span><br /><br />• In Windows, user accounts and groups can be assigned specific “privileges”.<br />•
    These privileges grant access to certain abilities.<br />• Some of these abilities can be used to escalate our
    overall privileges to that of SYSTEM.<br /><br /><br />1. <strong>Check user privileges</strong><br />“disabled” in
    the state column is irrelevant. If the privilege is listed, the user has it.<br />
    <div class="codebox">
      <div class="codebox">C:\&gt;&nbsp;whoami&nbsp;/priv</div>
    </div><br /> <a href=""><img src="images/1345-1.png" alt="images/1345-1.png" /></a><br /><br />2. Abuse the
    following privileges<br />• <strong>SeImpersonatePrivilege</strong><br /> grants the ability to impersonate any
    access tokens which it can obtain.<br /> If an access token from a SYSTEM process can be obtained, then a new
    process can be spawned using that token.<br /> We can abuse this privilege with:<br /> ◇ <a
      href="dology--Network_Pentest--Sniffing-Spoofing-Poisoning--NetNTLM_attacks--Man-in-the-Middle_techniques_(IPv4)--Juicy_Potato_RPC_+_NTLM_relay.html">Juicy
      Potato</a> <br /> ◇ <a href="https://github.com/antonioCoco/RogueWinRM" target="_blank">RogueWinRM </a>(needs winrm
    disabled)<br /> ◇ <a href="https://github.com/CCob/SweetPotato" target="_blank">SweetPotato</a><br /> ◇ <a
      href="https://github.com/itm4n/PrintSpoofer" target="_blank">PrintSpoofer</a><br />•
    <strong>SeAssignPrimaryPrivilege</strong><br /> similar to SeImpersonatePrivilege.<br /> It enables a user to assign
    an access token to a new process.<br /> We can abuse this privilege with:<br /> ◇ <a
      href="dology--Network_Pentest--Sniffing-Spoofing-Poisoning--NetNTLM_attacks--Man-in-the-Middle_techniques_(IPv4)--Juicy_Potato_RPC_+_NTLM_relay.html">Juicy
      Potato</a> <br />• <strong>SeBackupPrivilege</strong><br /> grants read access to all objects on the system,
    regardless of their ACL.<br /> Using this privilege, a user could gain access to sensitive files, or extract hashes
    from the registry which could then be cracked or used in a pass-the-hash attack.<br /> We can abuse this privilege
    with:<br /> ◇ <a
      href="https://github.com/Hackplayers/PsCabesha-tools/blob/master/Privesc/Acl-FullControl.ps1" target="_blank">https://github.com/Hackplayers/PsCabesha-tools/blob/master/Privesc/Acl-FullControl.ps1</a>
    <br /> ◇ <a
      href="https://github.com/giuliano108/SeBackupPrivilege/tree/master/SeBackupPrivilegeCmdLets/bin/Debug" target="_blank">https://github.com/giuliano108/SeBackupPrivilege/tree/master/SeBackupPrivilegeCmdLets/bin/Debug</a>
    <br /> ◇ IppSec: <a
      href="https://www.youtube.com/watch?v=IfCysW0Od8w&t=2610&ab_channel=IppSec" target="_blank">https://www.youtube.com/watch?v=IfCysW0Od8w&amp;t=2610&amp;ab_channel=IppSec</a><br />•
    <strong>SeRestorePrivilege</strong><br /> grants write access control to all objects on the system, regardless of
    their ACL.<br /> We can abuse this privilege with:<br /> ◇ <a
      href="tation--Privilege_Escalation--Windows_Privilege_Escalation--2._Service_Exploits--Insecure_Service_Executables_(insecure_file_permissions).html">Modify
      service binaries</a><br /> ◇ <a
      href="t_Methodology--Network_Pentest--Post_Exploitation--Privilege_Escalation--Windows_Privilege_Escalation--2._Service_Exploits--DLL_Hijacking.html">Overwrite
      DLLs used by SYSTEM processes (DLL Hijacking)</a><br /> ◇ <a
      href="y--Network_Pentest--Post_Exploitation--Privilege_Escalation--Windows_Privilege_Escalation--2._Service_Exploits--Weak_Registry_Permissions.html">Modify
      registry settings</a><br />• <strong>SeTakeOwnershipPrivilege</strong><br /> This privilege is very similar to
    SeRestorePrivilege.<br /> lets the user take ownership over an object (the WRITE_OWNER permission).<br /> We can
    abuse this privilege with:<br /> ◇ First, you have to take ownership of the registry key that you are going to write
    on and modify the DACL so you can write on it.<br /> Then the same methods used with SeRestorePrivilege can be
    applied.<br />• <strong>SeTcbPrivilege</strong><br />• <strong>SeCreateTokenPrivilege</strong><br />•
    <strong>SeLoadDriverPrivilege</strong><br />• <strong>SeDebugPrivilege</strong> (used by <a
      href="--Network_Pentest--Post_Exploitation--Privilege_Escalation--Windows_Privilege_Escalation--9._Access_Tokens_(UAC)--getsystem_(meterpreter).html">getsystem</a>
    and <a
      href="Test_Methodology--Network_Pentest--Post_Exploitation--Privilege_Escalation--Windows_Privilege_Escalation--Getting_SYSTEM_from_Local_Admin.html">psgetsys.ps1</a>)
    <br /><br /><br />Bibliography:<br />• <a
      href="https://book.hacktricks.xyz/windows/windows-local-privilege-escalation/privilege-escalation-abusing-tokens" target="_blank">https://book.hacktricks.xyz/windows/windows-local-privilege-escalation/privilege-escalation-abusing-tokens</a><br />•
    <a href="https://github.com/hatRiot/token-priv" target="_blank">https://github.com/hatRiot/token-priv</a> (<a
      href="https://github.com/hatRiot/token-priv/blob/master/abusing_token_eop_1.0.txt" target="_blank">abusing_token_eop_1.0.txt</a>)<br />
  </div>
</body>

</html>