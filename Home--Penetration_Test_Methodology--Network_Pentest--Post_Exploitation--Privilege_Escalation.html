<!doctype html>
<html>
<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <title>Privilege Escalation</title>
  <meta name="generator" content="CherryTree">
  <link rel="stylesheet" href="res/styles3.css" type="text/css" />
</head>
<body>
<div class='page'><h1 class='title'>Privilege Escalation</h1><br/><br /><strong><h3>Local privilege escalation exploits</h3></strong><br /><strong>Local privilege escalation exploits</strong> deal with an attacker who already has limited privileges to run code on a target machine.<br />With this attack, the tester exploits some functionality of the target system to jump to higher privileges on the machine, such as root, admin, or SYSTEM privileges.<br />Local privilege escalation attacks may or may not involve user interaction.<br /><br /><strong><h3>Main types of Local Privilege Escalation exploits</h3></strong><br />• <span style="text-decoration:underline;">Race conditions</span>: this kind of issue involves two different commands happening on the system nearly at the exact same time. With different results if one action finishes before the other.<br />• <span style="text-decoration:underline;">Kernel attacks</span>: the kernel may have flaws that allow an attacker to run code that makes calls into kernel functionality, these calls can tricks the kernel to run code of the attacker with higher privileges.<br />•<span style="text-decoration:underline;"> Local exploit of high-privileged program or service</span>: An attacker may use a limited privilege process on a machine to try to execute programs with higher privileges or make calls to a higher-privileged process running on the same system. <br />   ◇ Linux/UNIX: these attacks tend to focus on SUID root programs or scripts, which always run with UID 0 privileges regardless of the privileges of the account that invokes the script. SUID root programs usually can perform only one given action(e.g.: change a user&#39;s password) to minimize the chance of attack<br />   ◇ Windows machines: this kind of attack tend to focus to exploits of local, high-privileged processes, such as:<br />      ▪ csrss.exe (which controls interactions within user mode)<br />      ▪ winlogon.exe (which logs users on to a machine)<br />      ▪ lsass.exe (which provides authorization checks)<br />      ▪ ...<br /><br /><br />In the next steps, we will assume to already have a shell or a meterpreter session on our target.<br /><strong>Before doing any steps further we have to know the type of machine we are dealing with</strong><br /><div class="codebox"><div class="codebox">meterpreter&nbsp;&gt;&nbsp;sysinfo&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#Windows/Linux<br />C:\&gt;systeminfo&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#Windows<br />root@kali:/home/kali#&nbsp;lsb_release&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#Linux<br />root@kali:/home/kali#&nbsp;uname&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#Linux<br />root@kali:/home/kali#&nbsp;lscpu&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#Linux<br /></div></div><br /><br /><br /><span style="color:#a5452a;">Examples of situations that allow for privilege escalation are:</span><br />- Vulnerable software running under root privileges.<br />- Vulnerable kernels.<br />- Misconfigurations in service, system and security settings.<br />- Weak file and service permissions.<br />- Sensitive information stored in local files.<br />- Access to sensitive files such as the Windows SAM file.<br />- Installation scripts and data containing passwords.<br />- Scheduled tasks that execute scripts and programs.<br />- DLL Hijacking by overwriting poorly secured DLLs.<br />- Registry settings such as always elevated and automatically executed binaries.<br />- Malware to take sensitive user input.<br /><br /><br /><strong>Python HTTP server</strong><br />Useful to upload files to the target<br />• bind on all the interfaces<br />    <div class="codebox"><div class="codebox">python3&nbsp;-m&nbsp;http.server&nbsp;8000</div></div><br />   <a href=""><img src="images/835-1.png" alt="images/835-1.png" /></a><br />• bind to a specific interface<br />    <div class="codebox"><div class="codebox">python3&nbsp;-m&nbsp;http.server&nbsp;8000&nbsp;--bind&nbsp;127.0.0.1</div></div></div>
</body>
</html>
