<!doctype html>
<html>

<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <title>Insecure Service Permissions (weak folder permissions)</title>
  <meta name="generator" content="CherryTree">
  <link rel="stylesheet" href="res/styles3.css" type="text/css" />
</head>

<body>
  <div class='page'>
    <h1 class='title'>Insecure Service Permissions (weak folder permissions)</h1><br /><strong>
      <h3>Insecure Service Permissions (weak folder permissions)</h3>
    </strong><br />• Each service has an <span style="color:#ff8700;">ACL</span> which defines certain service-specific
    permissions.<br /> ◇ Permissions to access a certain resource in Windows are controlled by the <span
      style="color:#ff8700;">Access Control List (ACL)</span> for that resource.<br /> ◇ Each <span
      style="color:#ff8700;">ACL</span> is made up of zero or more <span style="color:#00ff00;">Access Control Entries
      (ACEs)</span>.<br /> ◇ Each <span style="color:#00ff00;">ACE</span> defines the relationship between a principal
    (e.g. a user, group) and a certain access right.<br /><br />• Some permissions are innocuous (e.g.
    SERVICE_QUERY_CONFIG, SERVICE_QUERY_STATUS).<br />• Some may be useful (e.g. SERVICE_STOP, SERVICE_START).<br />•
    Some are <span style="color:#ff0000;">dangerous</span> (e.g. <strong>SERVICE_CHANGE_CONFIG</strong>,
    <strong>SERVICE_ALL_ACCESS</strong>)<br /><br /><strong>What is this vulnerability</strong><br />This type of
    vulnerability allow to modify the binary service path of a service(we need one that runs with SYSTEM privileges) and
    point it to a malicious executable placed in another writable directory.<br /><span
      style="text-decoration:underline;">Potential Rabbit Hole</span>: If you can change a service configuration but
    cannot stop/start the service, you may not be able to escalate
    privileges!<br /><br /><br /><strong>Remediation</strong><br />Privilege escalation through <span
      style="text-decoration:underline;">weak service permission</span> can be re-mediated with properly configuring the
    service permissions and the folders where the service exist. Normal user should not be able to start or stop the
    service and Administrator should only have access to the folder where the binary is stored.<br />If you need to take
    these steps then take a look at Microsoft’s guide:<br /><span style="color:#404040;"> </span><a
      href="https://www.betaarchive.com/wiki/index.php/Microsoft_KB_Archive/914392#Best_practices_and_guidance_for_writers_of_service_discretionary_access_control_lists" target="_blank">https://www.betaarchive.com/wiki/index.php/Microsoft_KB_Archive/914392#Best_practices_and_guidance_for_writers_of_service_discretionary_access_control_lists</a>
  </div>
</body>

</html>