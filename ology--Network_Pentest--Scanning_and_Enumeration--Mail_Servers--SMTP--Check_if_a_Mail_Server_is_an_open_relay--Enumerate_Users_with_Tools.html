<!doctype html>
<html>

<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <title>Enumerate Users with Tools</title>
  <meta name="generator" content="CherryTree">
  <link rel="stylesheet" href="res/styles3.css" type="text/css" />
</head>

<body>
  <div class='page'>
    <h1 class='title'>Enumerate Users with Tools</h1><br />• <strong>nmap </strong><a
      href="https://nmap.org/nsedoc/scripts/smtp-enum-users.html" target="_blank">smtp-enum-users.nse</a> (BEST for very basic
    enumration)<br /> Attempts to enumerate the users on a SMTP server by issuing the VRFY, EXPN or RCPT TO commands.
    The goal of this script is to discover all the user accounts in the remote system.<br />
    <div class="codebox">
      <div class="codebox">root@kali:/#&nbsp;nmap&nbsp;--script&nbsp;smtp-enum-users.nse&nbsp;<span
          style="color:#000000;font-weight:400">&lt;</span>ipTargetMailServer<span
          style="color:#000000;font-weight:400">&gt;</span></div>
    </div><br /> *the username tested are only 10 how we can see from the source code here: <a
      href="https://github.com/nmap/nmap/blob/master/nselib/data/usernames.lst" target="_blank">https://github.com/nmap/nmap/blob/master/nselib/data/usernames.lst</a><br /><br />•
    <strong>smtp-user-enum</strong> from Cytopia: <a
      href="https://github.com/cytopia/smtp-user-enum" target="_blank">https://github.com/cytopia/smtp-user-enum</a> (BEST for custom
    user list)<br /> To enumerate with a custom list of users in a text file<br /> Listof Metasploit: <a
      href="https://github.com/rapid7/metasploit-framework/blob/master/data/wordlists/unix_users.txt" target="_blank">https://github.com/rapid7/metasploit-framework/blob/master/data/wordlists/unix_users.txt</a><br />
    <div class="codebox">
      <div class="codebox">
        root@kali:/#&nbsp;git&nbsp;clone&nbsp;https://github.com/cytopia/smtp-user-enum.git<br />root@kali:/#&nbsp;./smtp-user-enum&nbsp;-U&nbsp;/usr/share/wordlists/metasploit/unix_users.txt&nbsp;192.168.147.197&nbsp;25
      </div>
    </div><br /> <a href=""><img src="images/1384-1.png" alt="images/1384-1.png" /></a><br /><br />•
    <strong>smtp-user-enum</strong> from PentestMonkey: <a
      href="http://pentestmonkey.net/tools/user-enumeration/smtp-user-enum" target="_blank">http://pentestmonkey.net/tools/user-enumeration/smtp-user-enum</a><br />
    Less updated, to enumerate with a custom list of users in a text file<br />
    <div class="codebox">
      <div class="codebox">
        root@kali:/#&nbsp;mkdir&nbsp;smtp-user-enum-PentestMokey<br />root@kali:/#&nbsp;cd&nbsp;smtp-user-enum-PentestMokey<br />root@kali:/#&nbsp;wget&nbsp;https://raw.githubusercontent.com/pentestmonkey/smtp-user-enum/master/smtp-user-enum.pl&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#tool<br />root@kali:/#&nbsp;chmod&nbsp;+x&nbsp;smtp-user-enum.pl<br />root@kali:/#&nbsp;./smtp-user-enum.pl&nbsp;-M&nbsp;RCPT&nbsp;-U&nbsp;/usr/share/wordlists/metasploit/unix_users.txt&nbsp;-t&nbsp;192.168.147.192<br />root@kali:/#&nbsp;./smtp-user-enum.pl&nbsp;-M&nbsp;VRFY&nbsp;-U&nbsp;/usr/share/wordlists/metasploit/unix_users.txt&nbsp;-t&nbsp;192.168.147.192<br />root@kali:/#&nbsp;./smtp-user-enum.pl&nbsp;-M&nbsp;EXPN&nbsp;-U&nbsp;/usr/share/wordlists/metasploit/unix_users.txt&nbsp;-t&nbsp;192.168.147.192
      </div>
    </div><br /><br />• Metasploit <strong>smtp_enum</strong>: <a
      href="https://www.rapid7.com/db/modules/auxiliary/scanner/smtp/smtp_enum" target="_blank">https://www.rapid7.com/db/modules/auxiliary/scanner/smtp/smtp_enum</a><br />
    code: <a
      href="https://github.com/rapid7/metasploit-framework/blob/master/modules/auxiliary/scanner/smtp/smtp_enum.rb" target="_blank">https://github.com/rapid7/metasploit-framework/blob/master/modules/auxiliary/scanner/smtp/smtp_enum.rb</a><br />
    By default as username list it use /usr/share/wordlists/metasploit/unix_users.txt<br />
    <div class="codebox">
      <div class="codebox">
        msf&gt;&nbsp;use&nbsp;auxiliary/scanner/smtp/smtp_enum<br />msf&gt;&nbsp;set&nbsp;RHOSTS&nbsp;192.168.147.192&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#target&nbsp;IP<br />msf&gt;&nbsp;set&nbsp;USER_FILE&nbsp;/usr/share/wordlists/metasploit/unix_users.txt&nbsp;&nbsp;&nbsp;#default<br />msf&gt;&nbsp;run
      </div>
    </div><br /><br /><strong>
      <h2>List of usernames</h2>
    </strong><br />To have a list of potential usernames we can use:<br />• <strong>Metasploit Unix
      Usernames</strong>(BEST for SMTP): <br /> List: <a
      href="https://github.com/rapid7/metasploit-framework/blob/master/data/wordlists/unix_users.txt" target="_blank">https://github.com/rapid7/metasploit-framework/blob/master/data/wordlists/unix_users.txt</a><br />
    common Unix usernames<br />
    <div class="codebox">
      <div class="codebox">cat&nbsp;/usr/share/wordlists/metasploit/unix_users.txt</div>
    </div><br />• <strong>statistically-likely-usernames</strong>: list of usernames <a
      href="https://github.com/insidetrust/statistically-likely-usernames" target="_blank">https://github.com/insidetrust/statistically-likely-usernames</a><br />
    ◇ john.txt contains popular names: <a
      href="https://github.com/insidetrust/statistically-likely-usernames/blob/master/john.txt" target="_blank">https://github.com/insidetrust/statistically-likely-usernames/blob/master/john.txt</a><br />
    <div class="codebox">
      <div class="codebox">
        root@kali:/#&nbsp;wget&nbsp;https://raw.githubusercontent.com/insidetrust/statistically-likely-usernames/master/john.txt&nbsp;&nbsp;&nbsp;#complete&nbsp;list&nbsp;of&nbsp;popular&nbsp;names<br />root@kali:/#&nbsp;head&nbsp;-n&nbsp;50&nbsp;john.txt&nbsp;&gt;&gt;&nbsp;users.txt&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#only&nbsp;first&nbsp;50&nbsp;names,&nbsp;very&nbsp;small!!!!
      </div>
    </div><br />• <strong>TheHarvester</strong>: <a
      href="https://github.com/laramies/theHarvester" target="_blank">https://github.com/laramies/theHarvester</a> <br /> It can be a
    <em><span style="text-decoration:underline;">passive</span></em> reconnaissance using a search engine like google or
    an <em><span style="text-decoration:underline;">active</span></em> reconnaissance using a DNS<br />
    <div class="codebox">
      <div class="codebox">
        ./theharvester.py&nbsp;-d&nbsp;&lt;site&nbsp;to&nbsp;scan&gt;&nbsp;-l&nbsp;&lt;number&nbsp;of&nbsp;result&gt;&nbsp;-b&nbsp;&lt;search&nbsp;engine&gt;<br />theHarvester&nbsp;-d&nbsp;&lt;site&nbsp;to&nbsp;scan&gt;&nbsp;-l&nbsp;&lt;number&nbsp;of&nbsp;result&gt;&nbsp;-b&nbsp;<span
          style="color:#000000;font-weight:400">&lt;</span>search&nbsp;engine<span
          style="color:#000000;font-weight:400">&gt;</span></div>
    </div><br /> <span style="color:#a5452a;">example:</span><br /> <a
      href="file://C:/CherryTree/screenshots2/PTP-elearnsecurity/2. Network Security/1. Information Gathering/theharvester.png"><img
        src="images/1384-2.png" alt="images/1384-2.png" /></a><br /> <strong>-d</strong>: Domain to search or company
    name<br /> <strong>-b</strong>: data source: all (simultaneously search in all the sources), baidu, bing, bingapi,
    dogpile, google, googleCSE, googleplus, google-profiles, linkedin, pgp, twitter, vhost, virustotal, threatcrowd,
    crtsh, netcraft, yahoo<br /> <strong>-l</strong>: limit the number of results to work with<br />
    <strong>-c</strong>: perform a DNS brute force for the domain name(active reconnaissance)<br />
  </div>
</body>

</html>