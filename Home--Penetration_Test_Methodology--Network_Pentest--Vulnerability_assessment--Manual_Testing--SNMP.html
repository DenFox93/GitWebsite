<!doctype html>
<html>

<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <title>SNMP</title>
  <meta name="generator" content="CherryTree">
  <link rel="stylesheet" href="res/styles3.css" type="text/css" />
</head>

<body>
  <div class='page'>
    <h1 class='title'>SNMP</h1><br />The explanation of SNMP is done also <a
      href="--Pentesting_Basics--networking--protocols--protocol_layers--IP_protocol_suite_(TCP-IP)--Transport_Layer--Ports--services---p161,162_SNMP.html">HERE</a><br /><br />SNMP
    is used for exchanging management information between network devices(e.g.:used to configure a router or simply
    check its status)<br />SNMP network has three key components:<br />•<strong> network-management system
      (NMS)</strong> → also called manager is usually the System Administrator that send/receive commands to/from the
    agents<br />• <strong>managed device</strong> → is a network node that can be a router, switch, hub, computer,
    printer... that contains an agent <br />• <strong>agent</strong> → software that runs on managed devices<br /><a
      href="file://C:/CherryTree/screenshots2/PTP-elearnsecurity/2. Network Security/3. Enumeration/snmp.png"><img
        src="images/677-1.png" alt="images/677-1.png" /></a><br /><br /><strong>
      <h3>Ports</h3>
    </strong>
    <h3> </h3><br />UDP 161 → for general messages<br />UDP 162 → for Trap messages<br /><br /><strong>
      <h3>SNMP versions</h3>
    </strong><br />• SNMPv1: is the most vulnerable (clear text protocol)<br />• SNMPv2: can be compromised because of
    its inherent weaknesses.<br />• SNMPv3: although it uses encryption, it is still susceptible to attacks like brute
    forcing<br /><br /><strong>
      <h3>SNMP operations </h3>
    </strong><br />Get → The NMS sends a <em><span style="text-decoration:underline;">get</span></em> request to the
    agent. The agent responds with a <em><span style="text-decoration:underline;">get-response</span></em> to the
    NMS<br />GetNext → used by the NMS to determine what variables a certain agent supports<br />Set → used to configure
    devices and change device settings<br />Trap → used to &quot;trap&quot; events from the device and report them back
    to the manager. A trap message is used to alert the manager to the fact that a &quot;trap&quot; event is occured,
    this can meaning that the threshold defined by the manager (with the set command) has been reached, or that an
    error/event of some type has occurred<br /><br /><strong>
      <h3>SNMP commands to control and manages devices</h3>
    </strong><br />• Read → to monitor devices<br />• Write → to configure devices and change device settings<br />•
    Trap → trap&quot; events from the device and report them back to the monitoring system.<br />• Traversal Operations
    → used to determine what variables a certain device supports.<br /><br /><br /><strong>
      <h3>SNMP message</h3>
    </strong><br /><a
      href="file://C:/CherryTree/screenshots2/PTP-elearnsecurity/2. Network Security/3. Enumeration/snmp_pdu_header.png"><img
        src="images/677-2.png" alt="images/677-2.png" /></a><br />A SNMP Message is composed by:<br />• <span
      style="text-decoration:underline;">Message Header</span>:<br /> ◇ <span style="text-decoration:underline;">Version
      Number</span><br /> ◇ <span style="text-decoration:underline;">Community Name</span> (or string), which is used as
    a form of “secure” password authentication in SNMP. There are two types of Community Names:<br /> ▪ <strong><span
        style="text-decoration:underline;">Private</span></strong><span style="text-decoration:underline;"> Community
      Name</span> allow &quot;write&quot; access<br /> ▪ <strong><span
        style="text-decoration:underline;">Public</span></strong><span style="text-decoration:underline;"> Community
      Name</span> allow &quot;read&quot; access<br />• <span style="text-decoration:underline;">SNMP PDU</span>
    (protocol data units): depends on the type of message that is being sent<br /> ◇ Get ,Get-response, GetNext Set
    <br /> <a href=""><img src="images/677-3.png" alt="images/677-3.png" /></a><br /> ◇ Trap<br /> <a href=""><img
        src="images/677-4.png" alt="images/677-4.png" /></a><br /><br /><strong>
      <h3>MIB (Management Information Base)</h3>
    </strong><br />MIB (Management Information Base) is a database of informations which define the properties of the
    managed device (such as a router, switch, etc.).<br />This database is structured as a tree and each element of this
    tree is an OID (Object Identifier), an address used to uniquely identify managed devices and their properties that
    can be read/written by the NMS(manager)<br /><a
      href="file://C:/CherryTree/screenshots2/PTP-elearnsecurity/2. Network Security/3. Enumeration/snmp_OID.png"><img
        src="images/677-5.png" alt="images/677-5.png" /></a><br /><br /><br /><br />bibliography:<br /><a
      href="https://docstore.mik.ua/orelly/networking_2ndEd/snmp/ch02_06.htm" target="_blank">https://docstore.mik.ua/orelly/networking_2ndEd/snmp/ch02_06.htm</a><br /><a
      href="http://www.tsnien.idv.tw/Internet_WebBook/chap16/16-3%20SNMP%20%E5%8D%94%E5%AE%9A.html" target="_blank">http://www.tsnien.idv.tw/Internet_WebBook/chap16/16-3%20SNMP%20%E5%8D%94%E5%AE%9A.html</a><br /><br /><br /><strong>
      <h3>Attacks that can be done against SNMP</h3>
    </strong><br />• <strong>Flooding</strong>: DOS attack which involves spoofing an SNMP agent and flooding the SNMP
    trap management with tens of thousands of SNMP traps, varying in size from 50 bytes to 32 kilobytes, until the SNMP
    management trap is unable to function properly.<br />• <strong>Community</strong>: Using Default Community
    Name(string) to gain privileged access to systems. <br /> By default SNMPv1 and SNMPv2 have the Community Name set
    to “public”.<br />• <strong>Brute force</strong>: Using a tool to guess the Community Name(string) used on a system
    to achieve elevated privileges <br /> to discover which is the Community Name we can use tool like Nmap withe the <a
      href="ration_Test_Methodology--Network_Pentest--Vulnerability_assessment--Manual_Testing--SNMP--Linux_Tools--Nmap_NSE_SNMP--snmp-win32-services.html">snmp-win32-services</a>
    NSE script<br /><br /><br /><strong>
      <h3>Enumeration SNMP step</h3>
    </strong><br />1. <strong>Obtain Community Names(strings)</strong><br /> The first thing to do is obtain the
    Community Name(string), from it will depend then the type and amount of information gained. We can do it by<br /> ◇
    <span style="text-decoration:underline;">Sniff the network traffic</span>: SNMPv1 and SNMPv2 utilize clear text
    communications, so it is easy to sniff the passwords coming from the network management systems<br /> ◇ <span
      style="text-decoration:underline;">Dictionary attack</span><strong>:</strong> anyway beware that most current
    Network IDSs (Intrusion Detection Systems) will alert to this activity as it sees the multiple login attempts with
    different Community Names.<br />2. <strong>Extract information from the remote device</strong><br /> <span
      style="text-decoration:underline;">read access</span> can be also enough because we can use the informations for
    later
  </div>
</body>

</html>