<!doctype html>
<html>
<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <title>Windows Account Lockout</title>
  <meta name="generator" content="CherryTree">
  <link rel="stylesheet" href="res/styles3.css" type="text/css" />
</head>
<body>
<div class='page'><h1 class='title'>Windows Account Lockout</h1><br/><strong><h2>Account Lockout</h2></strong><br />Automated password guessing, could lock out valid user accounts, possibly even accounts used by system administrators, resulting in a denial-of-service attack.<br /><span style="text-decoration:underline;">Windows settings for account lockout:</span><br />   ◇ <strong>Lockout threshold</strong>: How many bad password attempts are allowed? Valid values between 0 (no lockout, default value) and 999<br />   ◇ <strong>Lockout duration</strong>: How long until account is automatically re-enabled? (minutes)<br />   ◇ <strong>Lockout observation window</strong>: How long to count bad guesses before resetting? (minutes)<br />To see these settings we can use the commands: <br /><div class="codebox"><div class="codebox">net&nbsp;accounts&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#on&nbsp;a&nbsp;local&nbsp;Windows&nbsp;macine<br />net&nbsp;accounts&nbsp;/domain&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#from&nbsp;an&nbsp;account&nbsp;that&nbsp;is&nbsp;an&nbsp;administrative&nbsp;member&nbsp;of&nbsp;a&nbsp;Windows&nbsp;domain</div></div> <br />    <a href=""><img src="images/762-1.png" alt="images/762-1.png" /></a><br /><br /><strong><h3>By default Windows Administrator account cannot be locked out</h3></strong><h3>    </h3><br />By default, the original Administrator account (which may be renamed) cannot be locked out. This behaviour was designed to lower the chance of a purposeful denial of service locking out system administrators from their machines<br />This is a helpful characteristic for a penetration tester, but there are some things that we have to take in mind:<br />   ◇  it applies only to the original administrator account, even if that account is renamed. Other accounts in the administrator&#39;s group can be locked out, so we have to be careful<br />   ◇ Although the original admin account can&#39;t be locked out by default, Microsoft includes a feature in Active Directory that allows any admin account to be locked out (including the RID 500 account, Relative ID (RID) is the last part of a SID), provided that there is at least one account in the admin group that is not locked out<br /><br /><div class="codebox"><div class="codebox">wmic&nbsp;useraccount&nbsp;list&nbsp;brief</div></div><br /><a href=""><img src="images/762-2.png" alt="images/762-2.png" /></a></div>
</body>
</html>
