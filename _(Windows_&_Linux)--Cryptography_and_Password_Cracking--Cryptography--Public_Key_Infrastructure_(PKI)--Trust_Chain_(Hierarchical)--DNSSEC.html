<!DOCTYPE html>
<html>
  <head>
    <meta http-equiv="content-type" content="text/html; charset=utf-8" />
    <title>DNSSEC</title>
    <meta name="generator" content="CherryTree" />
    <link rel="stylesheet" href="res/styles3.css" type="text/css" />
  </head>

  <body>
    <div class="page">
      <h1 class="title">DNSSEC</h1>
      <br />DNS is been discussed in in the
      <a
        href="Home--Pentesting_Basics--networking--protocols--protocol_layers--IP_protocol_suite_(TCP-IP)--Application_layer--DNS.html"
        >Networking chapter</a
      >,
      <a
        href="Home--Penetration_Test_Methodology--Network_Pentest--Scanning_and_Enumeration--DNS.html"
        >Reconnaissance chapter</a
      >,
      <a
        href="Home--Penetration_Test_Methodology--Network_Pentest--Vulnerability_assessment--Manual_Testing--DNS.html"
        >Vulnerability Assessment chapter</a
      >
      and
      <a
        href="Home--Penetration_Test_Methodology--Network_Pentest--Sniffing-Spoofing-Poisoning--Active_Sniffing-Spoofing--DNS_Spoofing_(Router).html"
        >Sniffing chapter</a
      ><br /><br /><strong>DNS Zone</strong><br />Each DNS zone has a DNS
      Resource Recourd (zone file) that contain resource records: SOA, NS, A,
      MX,...<br /><br /><strong>
        <h3>How to make DNS more secure: DNSSEC</h3> </strong
      ><br />DNS Security Extension (DNSSEC) is a security extensions that help
      DNS to work in a more secure way. <br />DNSSEC was developed in response
      to the
      <a
        href="Home--Penetration_Test_Methodology--Network_Pentest--Vulnerability_assessment--Manual_Testing--DNS--DNS_Cache_Poisoning.html"
        >DNS Cache Poisoning Attack of 2008</a
      >
      but a reliable and trustable DNS can be very useful also for other
      issues<br />DNSSEC makes use of
      <a
        href="Security_(Windows_&_Linux)--Cryptography_and_Password_Cracking--Cryptography--Public_Key_Infrastructure_(PKI)--Trust_Chain_(Hierarchical).html"
        >Public Key Infrastructure (PKI)</a
      >
      “<strong>Trust Chain</strong>” model, which is a method of using
      certificates issued by certificate authorities (trusted third parties) in
      order to confirm the identity of people and organizations.<br />DNSSEC
      creates a secure domain name system by adding signed records with private
      keys to existing DNS records. By checking these signed records with the
      correspondent public key, it is possible verify that a requested DNS
      record comes from its authoritative name server and wasn’t altered
      en-route, opposed to a fake record injected in a man-in-the-middle
      attack.<br />Similar to HTTPS, DNSSEC adds a layer of security by enabling
      authenticated answers on top of an otherwise insecure protocol. Whereas
      HTTPS encrypts traffic so nobody on the wire can snoop on your Internet
      activities, DNSSEC merely signs responses so that forgeries are
      detectable.<br /><a
        href="file://C:/CherryTree/screenshots2/PTP-elearnsecurity/1. System Security/5 - Cryptography and Password Cracking/DNSSEC.png"
        ><img src="images/1031-1.png" alt="images/1031-1.png" /></a
      ><br /><strong>DNSSEC defines four new record types:</strong><br />Take in
      mind that in DNSSEC, only signatures are used, and nothing is encrypted<br />•
      <strong>DNSKEY (DNS Public Key)</strong>: contain the the public key that
      is used to validate RRSIG <br />• <strong>RRSIG: </strong>Signature that
      bind RRset with a private key <strong><br /></strong>•
      <strong>DS</strong>: Delegation Signer, hash value of the
      <span style="color: #1e90ff">DNSKEY public KSK</span> that is stored in
      the parent zone<br />• <strong>NSEC</strong>: Next Secure, for explicit
      denial-of-existence of a DNS record<strong
        ><br /><br /><br />Flag bits used by DNSSEC in query and response
        message</strong
      ><br />DNSSEC uses two unused flag bits in the DNS query and answer
      message header(AD and CD).<br />To set or unset thse flags in the query
      see:
      <a href="https://linux.die.net/man/1/dig"
        >https://linux.die.net/man/1/dig</a
      ><br />
      ◇ DO (DNSSEC OK) bit: <br />
      ▪ query: if DO bit is set in a query, then this is interpreted as a signal
      that the response should include DNSSEC data in its response.<br />
      *under Additional records<br />
      <a href=""><img src="images/1031-2.png" alt="images/1031-2.png" /></a
      ><br />
      <a href=""><img src="images/1031-3.png" alt="images/1031-3.png" /></a
      ><br />
      ◇ CD (checking disabled) bit:<br />
      ▪ query: indicates that unauthenticated data is acceptable to the resolver
      sending the query<br />
      <a href=""><img src="images/1031-4.png" alt="images/1031-4.png" /></a
      ><br />
      <a href=""><img src="images/1031-5.png" alt="images/1031-5.png" /></a>
      <br />
      ◇ AD (Authentic Data) bit: <br />
      ▪ query: indicate that it understands the AD bit without also requesting
      DNSSEC data via the DO bit<br />
      <a href=""><img src="images/1031-6.png" alt="images/1031-6.png" /></a
      ><br />
      ▪ response: bit set if all RRsets are considered to be authentic.<br />
      <a href=""><img src="images/1031-7.png" alt="images/1031-7.png" /></a
      ><br />
      <a href=""><img src="images/1031-8.png" alt="images/1031-8.png" /></a
      ><br /><br />Flags in query sent(<a href="https://labs.apnic.net/?p=316"
        >Taken from here</a
      >):<br />
      <table class="table">
        <tr>
          <th>DO</th>
          <th>CD</th>
          <th>AD</th>
          <th>Effect</th>
        </tr>
        <tr>
          <td>0</td>
          <td>0</td>
          <td>0</td>
          <td>
            The resolver may or may not perform DNSSEC validation. No DNSSEC RRs
            are passed back in the response
          </td>
        </tr>
        <tr>
          <td>0</td>
          <td>0</td>
          <td>1</td>
          <td>
            The resolver should perform validation. No DNSSEC RRs are passed
            back in the response
          </td>
        </tr>
        <tr>
          <td>0</td>
          <td>1</td>
          <td>0</td>
          <td>
            The resolver should not perform DNSSEC validation. No DNSSEC RRs are
            passed back in the response
          </td>
        </tr>
        <tr>
          <td>0</td>
          <td>1</td>
          <td>1</td>
          <td>Mixed signals! The resolvers actions are undefined</td>
        </tr>
        <tr>
          <td>1</td>
          <td>0</td>
          <td>0</td>
          <td>
            The resolver should perform validation, and returns DNSSEC RRs in
            its response
          </td>
        </tr>
        <tr>
          <td>1</td>
          <td>0</td>
          <td>1</td>
          <td>
            The resolver should perform validation, and return DNSSEC RRs in its
            response
          </td>
        </tr>
        <tr>
          <td>1</td>
          <td>1</td>
          <td>0</td>
          <td>
            The resolver should not perform DNSSEC validation, but it should
            return DNSSEC RRs in its response
          </td>
        </tr>
        <tr>
          <td>1</td>
          <td>1</td>
          <td>1</td>
          <td>Mixed signals! The resolver&#39;s actions are undefined</td>
        </tr>
      </table>
      <br />
      <br />
      <br /><strong>How to know if a Zone Support DNSSEC?</strong><br />We have
      to ask to the domain for DNS public key<br />
      <div class="codebox">
        <div class="codebox">
          dig&nbsp;-t&nbsp;DNSKEY&nbsp;@1.1.1.1&nbsp;&lt;domain&gt;&nbsp;<br />dig&nbsp;-t&nbsp;DNSKEY&nbsp;@1.1.1.1&nbsp;&lt;domain&gt;&nbsp;+trace&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#if&nbsp;we&nbsp;want&nbsp;to&nbsp;trace&nbsp;all&nbsp;the&nbsp;server&nbsp;queried
        </div>
      </div>
      <br /><br />In the following interesting article we can find which
      registrar support DNSSEC and why is still an unpopular protocol<br /><a
        href="https://blog.apnic.net/2017/12/06/dnssec-deployment-remains-low/"  target="_blank"
        >https://blog.apnic.net/2017/12/06/dnssec-deployment-remains-low/</a
      ><br /><br /><br /><br /><br /><br /><br /><br /><br />Bibliography<br />•
      <a href="https://tools.ietf.org/html/rfc3833" target="_blank"
        >https://tools.ietf.org/html/rfc3833</a
      ><br />•
      <a href="http://www.chrismitchell.net/svidad.pdf" target="_blank"
        >http://www.chrismitchell.net/svidad.pdf</a
      ><br />•
      <a href="https://www.ovh.com/blog/an-introduction-to-dnssec/" target="_blank"
        >https://www.ovh.com/blog/an-introduction-to-dnssec/</a
      ><br />•
      <a href="https://medium.com/iocscan/how-dnssec-works-9c652257be0" target="_blank"
        >https://medium.com/iocscan/how-dnssec-works-9c652257be0</a
      ><br />•
      <a href="https://www.cloudflare.com/dns/dnssec/how-dnssec-works/" target="_blank"
        >https://www.cloudflare.com/dns/dnssec/how-dnssec-works/</a
      ><br />•
      <a href="https://blog.apnic.net/2017/12/06/dnssec-deployment-remains-low/" target="_blank"
        >https://blog.apnic.net/2017/12/06/dnssec-deployment-remains-low/</a
      ><br />
    </div>
  </body>
</html>
