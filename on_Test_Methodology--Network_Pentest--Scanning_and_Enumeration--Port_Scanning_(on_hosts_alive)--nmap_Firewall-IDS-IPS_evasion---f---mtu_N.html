<!doctype html>
<html>

<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <title>-f/--mtu <N>
  </title>
  <meta name="generator" content="CherryTree">
  <link rel="stylesheet" href="res/styles3.css" type="text/css" />
</head>

<body>
  <div class='page'>
    <h1 class='title'>-f/--mtu <N>
    </h1><br /><br /><strong>
      <h2>fragment packets</h2>
    </strong><br /><br />Fragmentation is the process of splitting a single packet into smaller ones. <br />This can
    disable the ability of some firewall and IDS systems to either apply their packet filtering rules or, to process all
    the fragments. In other words, they may inspect the single fragment but not the whole packet.<br />CAUTION: modern
    IDS’s are able to rebuild the fragmented packets therefore, often times rendering this technique ineffective.<br />
    <br />
    <div class="codebox">
      <div class="codebox">nmap&nbsp;-sS&nbsp;-Pn&nbsp;-n&nbsp;--disable-arp-ping&nbsp;-f&nbsp;<span
          style="color:#000000;font-weight:400">[</span>TargetIP<span style="color:#000000;font-weight:400">]</span>
      </div>
    </div><br /> -sS → SYN scan<br /> -f → fragment the packets<br /> <br /><strong>Fragmentation does not work with
      every type of scan</strong><br />For example, it does not work with these:<br /> ◇ -sT (TCP connect() scan)<br />
    ◇ -sV ( Version Detection )<br /><br /><strong>Fields of IPv4 packets</strong><br />• <span
      style="color:#ff8700;">Identification</span> - this value identifies a group of fragments. It&#39;s what tells the
    reassembling device which fragments make up the original packet.<br />• <span style="color:#00ff00;">Flags</span> -
    MF bit - More Fragments means that there are additional packets coming in after this one. It is set to 1 in all; but
    the last fragment is set to 0<br />• <span style="color:#a020f0;">Fragment offset</span> - The fragment offset field
    is measured in units of <span style="text-decoration:underline;">eight-byte</span> blocks. The value for the first
    fragment will be 0<br /> It is 13 bits long and specifies the offset of a particular fragment relative to the
    beginning of the original unfragmented IP datagram.<br /> This offset is the amount of bytes that can contain a
    fragment of a packet<br /> ◇ <strong>-f</strong> → the fragmentation offset is set to 8 by default.<br /> ◇
    <strong>--mtu</strong> → instead of -f to specify a custom offset size. It is important to know that the offset must
    be a multiple of eight.<br /><br /> <a href=""><img src="images/660-1.png" alt="images/660-1.png" /></a><br /><span
      style="color:#a5452a;"> example</span><br /> <a href=""><img src="images/660-2.png"
        alt="images/660-2.png" /></a><br /> <br /><strong>How many packets for a payload of N length?</strong><br /><a
      href=""><img src="images/660-3.png" alt="images/660-3.png" /></a><br />If we have a paylod of N length (we can
    simulate it in Nmap with the option --data-length N) to split it in fragment payload of length 8 we can use the
    option -f<br /> <br /><br /> <br />bibliography:<br /><a
      href="https://en.wikipedia.org/wiki/IPv4" target="_blank">https://en.wikipedia.org/wiki/IPv4</a><br /><a
      href="https://nmap.org/book/man-bypass-firewalls-ids.html" target="_blank">https://nmap.org/book/man-bypass-firewalls-ids.html</a><br />
  </div>
</body>

</html>