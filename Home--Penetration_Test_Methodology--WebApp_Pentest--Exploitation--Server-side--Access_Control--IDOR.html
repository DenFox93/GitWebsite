<!doctype html>
<html>

<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <title>IDOR</title>
  <meta name="generator" content="CherryTree">
  <link rel="stylesheet" href="res/styles3.css" type="text/css" />
</head>

<body>
  <div class='page'>
    <h1 class='title'>IDOR</h1><br /><strong>
      <h3>What are insecure direct object references (IDOR)?</h3>
    </strong><br /><strong>Insecure direct object references (IDOR)</strong> are a type of <span
      style="text-decoration:underline;">access control</span> vulnerability that arises when an <span
      style="text-decoration:underline;">application uses user-supplied input to access objects directly</span>. The
    term IDOR was popularized by its appearance in the OWASP 2007 Top Ten.<br /><br /><br /><strong>Direct reference to
      database objects</strong><br />Consider a website that uses the following URL to access the customer account page,
    by retrieving information from the back-end
    database:<br /><code>https://insecure-website.com/customer_account?customer_number=132355</code><br />Here, the
    customer number is used directly as a record index in queries that are performed on the back-end database. If no
    other controls are in place, an attacker can simply modify the <code>customer_number</code> value, bypassing access
    controls to view the records of other customers. This is an example of an IDOR vulnerability leading to <span
      style="text-decoration:underline;">horizontal privilege escalation</span>.<br /><span
      style="text-decoration:underline;">Encrypted numbers</span><br />Sometimes you will see a GUID
    (2b7498e3-9634-4667-b9ce-a8e81428641e) or another type of encrypted value. Brute forcing GUIDs is usually a
    dead-end!<br />At this stage we should:<br /> ◇ Check for any leaks of this value. <br /> <span
      style="color:#a5452a;">example</span>: visiting a users’ public profile and view the source could reveal that the
    user&#39;s GUID<br /> ◇ Check if an integer(decrypted value) is processed the same as the encrypted one<br /> even
    if we see some type of encrypted value, we should try just an integer. Sometimes they are processed the same.
    Security through obscurity...<br /><br /><strong>Inject ID parameters</strong><br />Anytime you see a request and
    the postdata is JSON, <code>{&quot;example&quot;:&quot;example&quot;}</code>, try simply injecting a new parameter
    name,
    <code>{&quot;example&quot;:&quot;example&quot;,</code><code><span style="color:#e20000;">&quot;id&quot;:&quot;1&quot;</span></code><code>}</code>.
    When the JSON is parsed server-side you literally have no idea how it may handle it, so why not try? This not only
    applies to JSON requests but all requests, but I typically have a higher success rate when it&#39;s a JSON payload.
    (look for PUT requests!)<br /><br /><br /><strong>Direct reference to static files</strong><br />IDOR
    vulnerabilities often arise when sensitive resources are located in static files on the server-side filesystem. For
    example, a website might save chat message transcripts to disk using an incrementing filename, and allow users to
    retrieve these by visiting a URL like the
    following:<br /><code>https://insecure-website.com/static/12144.txt</code><br />In this situation, an attacker can
    simply modify the filename to retrieve a transcript created by another user and potentially obtain user credentials
    and other sensitive data.<br /><br /><br />Bibliography:<br />• <a
      href="https://portswigger.net/web-security/access-control/idor" target="_blank">https://portswigger.net/web-security/access-control/idor</a><br />•
    Zseano Methodology: <a
      href="https://www.bugbountyhunter.com/methodology/" target="_blank">https://www.bugbountyhunter.com/methodology/</a>
  </div>
</body>

</html>