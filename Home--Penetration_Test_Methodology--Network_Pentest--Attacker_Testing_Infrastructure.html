<!doctype html>
<html>

<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <title>Attacker Testing Infrastructure</title>
  <meta name="generator" content="CherryTree">
  <link rel="stylesheet" href="res/styles3.css" type="text/css" />
</head>

<body>
  <div class='page'>
    <h1 class='title'>Attacker Testing Infrastructure</h1><br /><br /><br /><strong>
      <h2>Internet Service Providers(ISPs)<br /></h2>
    </strong>For testing across the internet, the testers will, of course, need an internet connection from an ISP (Tim,
    Fastweb, Wind,...).<br />During a Penetration Test the testers will sending some unusual traffic across that line
    and may run exploits against targets across that ISP. This could be a problem, unless it is cleared with the ISP
    first<br />It is vital that we tell the ISP in advance that we plan to using the connection for penetration testing
    and security assessments (Tip:avoid ethical hacking that can be misunderstood). Because of that we have to determine
    the ISP policy in advance before doing a Penetration Test<br />Take in mind also that performing scanning or
    exploitation through an ISP&#39;s network could be a violation of its terms of service.<br />What can go wrong with
    ISPs<br /> ◇ they can detect network scans and throttle them, slowing down a test<br /> ◇ they can block certain TCP
    and UDP ports to protect consumers on their networks<br /> ◇ they can identify exploitations attempts and block
    exploits packets<strong><br /></strong>
    <h3>• </h3><strong>
      <h3>Firewalls</h3>
    </strong><br /> The Pentester&#39;s testing machine has <span style="text-decoration:underline;">not to
      have<br /></span> ▪ Network and personal firewall → a firewall may block inbound or outbound packets, yielding
    inaccurate results for a test<br /> ▪ commercial security suites with IPS functionality → can filter outbound
    payloads and exploits<br /> <span style="text-decoration:underline;">What can go wrong with firewalls</span>:<br />
    ▪<em> </em><a
      href="Home--Pentesting_Basics--networking--protocols--Network_defense--Firewall--NAT_protocol.html">NAT</a><em>(Network
      Address Translation) and </em><a
      href="Home--Pentesting_Basics--networking--protocols--Network_defense--Firewall--PAT_protocol.html">PAT</a><em>(Port
      Address Translation)</em><strong> </strong>of firewalls rely on tables. Because of that a scan that creates
    millions of packets may overwhelm the NAT or PAT tables, causing them to drop packets. Thus the scanning tool
    won&#39;t see all the results, missing open ports and vulnerabilities.<br /> ▪ <em>HTTP proxies</em> could alter the
    the encoding of the Exploits, and consequentially break it<br /> ▪ <em>Firewalls at the Application-level</em> can
    inspect packets and drops some of them or cleans up some packets settings, because of not conform the protocol<br />
    <br /> <span style="text-decoration:underline;">Recommendations</span>:<br /> Because of the explanations
    above:<br /> ▪ it is not recommended using a network or personal firewall on the testing network and on the testing
    machine(s), anyway the target network probably will have a firewall<br /> ▪ Harden the testing machine before start
    the penetration test.<br /> - keep patches up to date on the testing machine<br /> - shut off unneeded services. For
    a penetration testing system<br /> - minimal listening services on the machine.<br /> To help with the hardening
    process, the <a href="http://www.cisecurity.org">Center for Internet Security</a> has a large number of free
    templeates for hardening various kinds of systems, including Windows and Linux. We can download and use these
    templates<br /><br /> <br /><strong>
      <h2>Testing System</h2>
    </strong><br />• <strong>Hardware used for Testing</strong><br /> Testing machines should not be used for web
    surfing, email reading, or even vulnerability research during a test.<br /> ▪ Testing machines <span
      style="text-decoration:underline;">have no firewall</span>, neither a personal firewall nor a network
    firewall<br /> ▪ Testing machines <span style="text-decoration:underline;">don&#39;t have to store any sensitive
      information</span> other than the tools&#39; temporary output; because of they do not have protections and have to
    stay online for a significant period of time as you wait for a lengthy scan to complete <br /> ▪ Use a <span
      style="text-decoration:underline;">separate offline machine</span> to take notes while we perform a test. This
    will provide a more secure location for housing our notes. Move files between the testing machine and the offline
    machine using a USB drive<br /> ▪ <span style="text-decoration:underline;">Only minimal software and services
      installed on the testing machine</span> needed for the test, they could slow down the progress of your test or
    impact the results<br /> ▪ For long-term scans that might run for several days, consider to use a <span
      style="text-decoration:underline;">server machine</span> that is housed in a secure location, then use use Secure
    Shell or terminal services to control the testing software on that machine<br /><br />• <strong>File system
      encryption</strong><br /> Secure deletion utilities cannot be trusted to securely delete files. For this reason,
    full disk encryption is important(for more <a
      href="https://www.howtogeek.com/234683/why-you-cant-securely-delete-a-file-and-what-to-do-instead/" target="_blank">HERE</a>)<strong><br /></strong>
    ◇ Windows → Windows Bitlocker<br /> ◇ MacOS → MacOS FileVault<br /> ◇ Linux &amp; UNIX → Cryptographic File System
    (CFS) <strong> </strong><br /> <br />• <strong>Which OS</strong><br /> ◇ Some tools work better on Linux, whereas
    others work better on Windows.<br /> ◇ Some tools work just fine on both<br /> ◇ Some tools have been released for
    only one of those platforms<br /> The best solution is running the two OS simultaneously on the same hardware and
    use one as the main OS and virtualizing the other(e.g.: using “VMware Workstation”) <br /> MacOS is another
    solution, but we have to virtualize both Windows and Linux (e.g.:using &quot;Vmware Fusion&quot; or “Parallels”
    )<br /><br /><br />• <strong>Virtual Machines as Testing systems</strong><br /> Configure them to use Bridged
    Networking otherwise there is the possibility that we will miss things in our findings.<br /> Bridged Networking
    makes the guest look like its on the same subnet as the host machine(a desiderable property).<br /> Having the guest
    connected via virtual bridge has a little impact on the packets<br /><br />• <strong>Analyze the tools that we want
      to use in a Penetration Test</strong><br /> Historically, some of the tools and exploit code freely distributed on
    the internet have included backdoors that let the owner of the tool to control the the Testing System and the Target
    System<br /> What to do:<br /> ◇ Analyze the code of the tool or exploit if possible<br /> ▪ run the tools in a lab
    against a sample target first<br /> ▪ Evaluate tools while a sniffer is running to see if they send unexpected
    packets to unanticipated destinations<br /> ▪ Look at their impact on the file system of both the attacker and the
    target<br /> - tool: Microsoft Sysinternals processmon <br /><br /><br />
  </div>
</body>

</html>