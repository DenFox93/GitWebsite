<!doctype html>
<html>
<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <title>nmap</title>
  <meta name="generator" content="CherryTree">
  <link rel="stylesheet" href="res/styles3.css" type="text/css" />
</head>
<body>
<div class='page'><h1 class='title'>nmap</h1><br/><br />Even if is mainly used for network discovery, port scanning etc.. with it we can run also scripts, these scripts can be used to check if a remote system is vulnerable to specific vulnerability such us <span style="text-decoration:underline;">null session</span> and then get informations from the remote system. <br /><br />Version service port scanning:<br />    <div class="codebox"><div class="codebox">nmap&nbsp;-sS&nbsp;-sU&nbsp;-sV&nbsp;&lt;address&gt;&nbsp;-p135,137,139,445&nbsp;--open</div></div><br /><br />The script for null session vulnerability are:<br />• <strong>smb-vuln*<br />    </strong><div class="codebox"><div class="codebox">nmap&nbsp;-script=smb-vuln*&nbsp;&lt;address&gt;&nbsp;&nbsp;-p&nbsp;139,445</div></div><br />    The script connects to the $IPC tree, executes a transaction on FID 0 and checks if the error “STATUS_INSUFF_SERVER_RESOURCES” is returned to determine if the target is not patched against ms17-010. Additionally, it checks for known error codes returned by patched systems.<br /><br />• <strong>smb-enum-shares</strong><br />    <div class="codebox"><div class="codebox">nmap&nbsp;-script=smb-enum-shares&nbsp;<span style="color:#000000;font-weight:400">&lt;</span>address<span style="color:#000000;font-weight:400">&gt;</span></div></div><br />    if we have anonymous access to IPC$ share the system is vulnerable to null session<br />• <strong>smb-enum-brute</strong><br />    <div class="codebox"><div class="codebox">nmap&nbsp;-script=smb-brute&nbsp;<span style="color:#000000;font-weight:400">&lt;</span>address<span style="color:#000000;font-weight:400">&gt;</span></div></div><br />    this script will try to brute-force the remote username and password <br />• <strong>smb-enum-users</strong><br />    <div class="codebox"><div class="codebox">nmap&nbsp;-script=smb-enum-users&nbsp;<span style="color:#000000;font-weight:400">&lt;</span>address<span style="color:#000000;font-weight:400">&gt;</span></div></div><br />    we can see all the users available, their RIDs and some password informations<br />   ◇ If we have discovered working credentials, we can use them to have more informations<br />       <div class="codebox"><div class="codebox">nmap&nbsp;--script=smb-enum-users&nbsp;-p&nbsp;445&nbsp;10.130.40.70&nbsp;--script-args&nbsp;smbuser=administrator,smbpass=password</div></div><br />       Note we can specify the credentials also with &quot;smbclient&quot; on Linux and &quot;net use&quot; and “net view” on windows<strong><br /></strong></div>
</body>
</html>
