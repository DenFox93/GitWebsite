<!doctype html>
<html>

<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <title>script: Packet Sniffer Network</title>
  <meta name="generator" content="CherryTree">
  <link rel="stylesheet" href="res/styles3.css" type="text/css" />
</head>

<body>
  <div class='page'>
    <h1 class='title'>script: Packet Sniffer Network</h1><br /><br />promiscuous version of <a
      href="https://github.com/packetfu/packetfu/blob/31cbecca9cd6d3486629ff4797433784a37ce2e4/examples/simple-sniffer.rb" target="_blank">https://github.com/packetfu/packetfu/blob/31cbecca9cd6d3486629ff4797433784a37ce2e4/examples/simple-sniffer.rb</a><br /><br />
    <div class="codebox">
      <div class="codebox">
        #!/usr/bin/env&nbsp;ruby<br /><br />require&nbsp;&#39;packetfu&#39;<br /><br />puts&nbsp;&quot;Promiscuous&nbsp;network&nbsp;sniffer&nbsp;for&nbsp;PacketFu&nbsp;#{PacketFu.version}&quot;<br />include&nbsp;PacketFu<br /><br />#default&nbsp;iface&nbsp;is&nbsp;eth0<br />iface&nbsp;=&nbsp;ARGV[0]&nbsp;||&nbsp;PacketFu::Utils.default_int<br /><br />def&nbsp;sniff(iface)<br />&nbsp;&nbsp;#to&nbsp;the&nbsp;capture&nbsp;we&nbsp;can&nbsp;set&nbsp;also&nbsp;a&nbsp;filter<br />&nbsp;&nbsp;#&nbsp;Example&nbsp;of&nbsp;a&nbsp;filter&nbsp;for&nbsp;a&nbsp;certain&nbsp;destination&nbsp;port<br />&nbsp;&nbsp;#&nbsp;:filter&nbsp;=&gt;&nbsp;&quot;tcp&nbsp;dst&nbsp;port&nbsp;80&quot;&nbsp;&nbsp;<br />&nbsp;&nbsp;cap&nbsp;=&nbsp;Capture.new(:iface&nbsp;=&gt;&nbsp;iface,&nbsp;:promisc&nbsp;=&gt;&nbsp;true,&nbsp;:start&nbsp;=&gt;&nbsp;true)<br />&nbsp;&nbsp;#|p|&nbsp;is&nbsp;the&nbsp;raw&nbsp;packet<br />&nbsp;&nbsp;cap.stream.each&nbsp;do&nbsp;|p|<br />&nbsp;&nbsp;&nbsp;&nbsp;#parse&nbsp;because&nbsp;we&nbsp;want&nbsp;to&nbsp;filter&nbsp;tcp/udp&nbsp;packets<br />&nbsp;&nbsp;&nbsp;&nbsp;pkt&nbsp;=&nbsp;Packet.parse&nbsp;p<br />&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;pkt.is_ip?<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#print&nbsp;information&nbsp;that&nbsp;we&nbsp;want&nbsp;to&nbsp;stdout<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;packet_info&nbsp;=&nbsp;[pkt.ip_saddr,&nbsp;pkt.ip_daddr,&nbsp;pkt.size,&nbsp;pkt.proto.last]<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#%-15s&nbsp;is&nbsp;a&nbsp;negative&nbsp;padding&nbsp;for&nbsp;strings,&nbsp;adds&nbsp;15&nbsp;whitespace&nbsp;to&nbsp;the&nbsp;right.<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#%-4d&nbsp;&nbsp;is&nbsp;a&nbsp;negative&nbsp;padding&nbsp;for&nbsp;decimals,&nbsp;adds&nbsp;4&nbsp;whitespace&nbsp;to&nbsp;the&nbsp;right.<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;puts&nbsp;&quot;%-15s&nbsp;-&gt;&nbsp;%-15s&nbsp;%-4d&nbsp;%s&quot;&nbsp;%&nbsp;packet_info<br />&nbsp;&nbsp;&nbsp;&nbsp;end<br />&nbsp;&nbsp;end<br />end<br /><br />sniff(iface)&nbsp;&nbsp;&nbsp;
      </div>
    </div><br /> <a href=""><img src="images/1975-1.png" alt="images/1975-1.png" /></a>
  </div>
</body>

</html>