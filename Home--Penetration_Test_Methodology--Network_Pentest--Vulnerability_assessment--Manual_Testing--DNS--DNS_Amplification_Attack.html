<!doctype html>
<html>

<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <title>DNS Amplification Attack</title>
  <meta name="generator" content="CherryTree">
  <link rel="stylesheet" href="res/styles3.css" type="text/css" />
</head>

<body>
  <div class='page'>
    <h1 class='title'>DNS Amplification Attack</h1><br /><br />In this chapter we will check if the DNS is an open
    resolver, or in other words if it answers DNS queries from anyone and attempts to resolve them.<br />This can not be
    a problem for the DNS server itself but it can can be used in a DNS traffic amplification attack against a <span
      style="color:#1e90ff;">third party(victim)</span>.<br /><strong>What is a DNS traffic amplification
      attack?</strong><br />Well, A DNS traffic amplification attack is a form of Denial-Of-Service(DOS)
    attack.<br />This can be done by <br /> 1) request-ing the ANY record, or a record that gives a large response to
    the DNS that offer recursive name lookups<br /> 2) The <span style="color:#1e90ff;">third party(victim) IP</span> is
    supplied in place of <span style="color:#ff0000;">your IP address</span> inside the UDP packet when we request the
    ANY record. This is known as spoofing <span style="color:#ff0000;">your IP address</span>, and it means that the
    server sends its UDP response not <span style="color:#ff0000;">to you</span> but to your <span
      style="color:#1e90ff;">victim</span><br />This is called a DOS attack because we are requesting an ANY record only
    to a single DNS that offer recursive name lookups.<br />Could become a DDOS attack if we are requesting an ANY
    record to multiple DNS! By spoofing the IP address all of these requests will be redirected to the
    victim<br /><br /><strong>
      <h3>How mitigate this problem?</h3>
    </strong><br />• Companies should have a separate DNS server that is used for outgoing DNS lookups and should not be
    publicly accessible<br />• limiting the number of responses that are sent out in a given
    time<br /><br /><br /><strong>
      <h3>Known vulnerable systems</h3>
    </strong><br />• <strong>ISC BIND before 9.4.1-P1</strong> → The default configuration of ISC BIND before 9.4.1-P1,
    when configured as a caching name server, allows recursive queries and provides additional delegation information to
    arbitrary IP addresses, which allows remote attackers to cause a denial of service (traffic amplification) via DNS
    queries with spoofed source IP addresses(<a
      href="https://www.cvedetails.com/cve/CVE-2006-0987/" target="_blank">CVE-2006-0987</a>)<br />• <strong>Windows Server 2003/2007
      and Microsoft DNS Server service on Windows NT 4.0</strong> → The default configuration of the DNS Server service
    on Windows Server 2003 and Windows 2000, and the Microsoft DNS Server service on Windows NT 4.0, allows recursive
    queries and provides additional delegation information to arbitrary IP addresses, which allows remote attackers to
    cause a denial of service (traffic amplification) via DNS queries with spoofed source IP addresses(<a
      href="https://www.cvedetails.com/cve/CVE-2006-0988/" target="_blank">CVE-2006-0988</a>)<br /><br /><strong>Solutions</strong><br /><a
      href="https://us-cert.cisa.gov/ncas/alerts/TA13-088A" target="_blank">https://us-cert.cisa.gov/ncas/alerts/TA13-088A</a><br /><br /><br />Bibliography:<br />•
    “Hands on Hacking: Become an Expert at Next Gen Penetration Testing and Purple Teaming” Matthew Hickey, Jennifer
    Arcuri<br />• <a
      href="https://us-cert.cisa.gov/ncas/alerts/TA13-088A" target="_blank">https://us-cert.cisa.gov/ncas/alerts/TA13-088A</a><br />• <a
      href="https://www.cloudflare.com/learning/ddos/dns-amplification-ddos-attack/" target="_blank">https://www.cloudflare.com/learning/ddos/dns-amplification-ddos-attack/</a><br />•
    <a href="https://www.cvedetails.com/cve/CVE-2006-0987/" target="_blank">https://www.cvedetails.com/cve/CVE-2006-0987/</a> <br />• <a
      href="https://www.cvedetails.com/cve/CVE-2006-0988/" target="_blank">https://www.cvedetails.com/cve/CVE-2006-0988/</a>
  </div>
</body>

</html>