<!doctype html>
<html>

<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <title>Whois Lookups</title>
  <meta name="generator" content="CherryTree">
  <link rel="stylesheet" href="res/styles3.css" type="text/css" />
</head>

<body>
  <div class='page'>
    <h1 class='title'>Whois Lookups</h1><br /><br />We can query the whois public database with the whois command(Linux
    and OSX) or we can use a website:<br />• <a href="http://whois.icann.org" target="_blank">http://whois.icann.org</a><br />• <a
      href="http://who.is" target="_blank">http://who.is</a><br />• <a
      href="http://whois.domaintools.com" target="_blank">http://whois.domaintools.com</a><br />• <a
      href="http://bgp.he.net/" target="_blank">http://bgp.he.net/</a><br />• <a
      href="http://networking.ringofsaturn.com/Tools/whois.php" target="_blank">http://networking.ringofsaturn.com/Tools/whois.php</a><br />•
    <a href="http://www.networksolutions.com/whois/index.jsp" target="_blank">http://www.networksolutions.com/whois/index.jsp</a><br />•
    <a href="http://www.betterwhois.com/" target="_blank">http://www.betterwhois.com/</a><br />• <div class="codebox">
      <div class="codebox">whois&nbsp;<span style="color:#000000;font-weight:400">&lt;</span>address<span
          style="color:#000000;font-weight:400">&gt;</span></div>
    </div> &lt;--<br />• <a href="https://lookup.icann.org/" target="_blank">https://lookup.icann.org/</a>
    &lt;--<br /><br /><strong>Informations that we can retrieve</strong><br />• <span
      style="text-decoration:underline;">Name Server(NS)</span>: the most important information that we can retrieve
    from WHOIS that can help us to determine the infrastructure of the organization are the <a
      href="Home--Pentesting_Basics--networking--protocols--protocol_layers--IP_protocol_suite_(TCP-IP)--Application_layer--DNS.html">Name
      Server</a> because these are the servers that store all the DNS related information (records) about the
    domain<br />• <span style="text-decoration:underline;">IPv4 and IPv6</span>: official address assignments of a
    domain or company name<br />• <span style="text-decoration:underline;">CIDR block</span> → (Classless Inter-Domain
    Routing) tell us the size of the target network. We have to be careful because some organizations get IP addresses
    from their ISP. we This mean that we may get back a giant block of addresses that do not apply to only the
    organization we searched for but instead apply to its entire ISP. So we have to verify that these addresses are
    actually within the scope of our test.<br />• <span style="text-decoration:underline;">Autonomous System (AS or
      ASN)</span>: it is a number that refer to a collection of IP networks and their associated routers under the
    control of a single technical administrator. The range of IP addresses that a given AS has control over is called
    their &quot;IP address space.&quot;<br />• <span style="text-decoration:underline;">Target ISP&#39;s</span>: <br />
    We need to check who belongs the Ip addresses of the target network. To do that we can also use <a
      href="Network_Pentest--Recoinnaissance_(OSINT_Open_Source_Information_Gathering)--Infrastructure_Information_Gathering--Whois_Lookups--netcraft.html">Netcraft</a><br />
    <a href=""><img src="images/257-1.png" alt="images/257-1.png" /></a><br /><br /><br />When a domain is registered,
    the registrar gathers a significant amount of information about the internet gateway and people associated with the
    domain. Most registrars put this information in publicly accessible <span style="text-decoration:underline;">Whois
      databases</span>.<br />In the world there are 5 main Regional Internet Registry(RIRs) organizations each with its
    <span style="text-decoration:underline;">Whois database</span>. <br />We usually do not know in advance the
    particular registrar used to register the target domain, by doing a generic whois query for the domain we can
    retrieve the registrar and then query directly the registrar&#39;s Whois database for more informations<br />The
    whois command will search the IP address in all of these databases<br /><br />The regional registrar WHOIS servers
    are:<br /> ◇ whois.afrinic.net (Africa)<br /> ◇ whois.apnic.net (Asia Pacific, India, China, and Australia)<br /> ◇
    whois.arin.net (US and Canada)<br /> ◇ whois.lacnic.net (Mexico and Latin America)<br /> ◇ whois.ripe.net (Europe,
    Greenland, Russia, and the Middle East)<br /><a
      href="file://C:/CherryTree/screenshots2/PTP-elearnsecurity/2. Network Security/1. Information Gathering/Regional_Internet_Registry.png"><img
        src="images/257-2.png" alt="images/257-2.png" /></a><br /><br /><strong>
      <h3>Who is the owner of the </h3>
    </strong><strong>
      <h3>Ip address</h3>
    </strong><strong>
      <h3>?</h3>
    </strong><br />Most versions of UNIX and Linux include a built-in whois client. It is also included by default in
    macOS but not Windows. Microsoft SysInternals includes a whois client, available at <a
      href="https://docs.microsoft.com/en-us/sysinternals/downloads/whois" target="_blank">https://docs.microsoft.com/en-us/sysinternals/downloads/whois</a><br />If
    we know the <span style="color:#ff8700;">Registrar WHOIS Server</span> of our domain(e.g.:
    godaddy,markmonitor,corporatedomains...) we can instruct the whois command to use a different whois server with the
    <strong>-h</strong> option and so retrieve maybe more informations<br /><span
      style="color:#a5452a;">example:</span><br />1. <div class="codebox">
      <div class="codebox">whois&nbsp;netflix.com</div>
    </div><br /> <a href=""><img src="images/257-3.png" alt="images/257-3.png" /></a> <br />2. <div class="codebox">
      <div class="codebox">whois&nbsp;-h&nbsp;whois.markmonitor.com&nbsp;netflix.com</div>
    </div><br /><br /><strong><span style="color:#ff00e0;">Netblocks</span></strong>: range or set of IP
    addresses.<br /> Larger netblocks are given to larger organizations, such as <span style="color:#ff1b00;">Internet
      Service Providers (ISP) and Governments <br /> While individuals or small organizations usually buy </span><span
      style="color:#00ff00;">one or more IP addresses</span> from the <span style="color:#ff1b00;">ISP</span> and this
    is why running WHOIS on these <span style="color:#00ff00;">smaller netblocks</span>, point to the <span
      style="color:#ff1b00;">ISP</span> and not to the individual or the smaller organization leased the <span
      style="color:#00ff00;">netblock</span><br /> <span style="color:#a5452a;">example:</span><br /> 192.168.0.0 –
    192.168.255.255 → 192.168.0.0/16 (CIDR notation) → 192.168.0.0 netmask 255.255.0.0<br /> <br /><strong>Autonomous
      Systems</strong>: they are made of one or more <span style="color:#ff00e0;">netblocks</span>(ip networks) under
    the same administrative control<br /> Big organizations and ISP’s have an autonomous system, while smaller companies
    will probably have a <span style="color:#ff00e0;">netblock</span><br /> When we run WHOIS(<a
      href="hodology--Network_Pentest--Recoinnaissance_(OSINT_Open_Source_Information_Gathering)--Infrastructure_Information_Gathering--Whois_Lookups.html">here</a>
    for more) we can find the <span style="color:#1e90ff;">owner</span> of an address under &quot;<span
      style="color:#1e90ff;">Registrar</span>&quot; or “<span style="color:#1e90ff;">Name</span>” depends which
    tool/website we use.<br /> In the example below is GoDaddy hosting provider that lease the IP address to our target
    organization.<br /> <a href=""><img src="images/257-4.png" alt="images/257-4.png" /></a><br /><br /><br /><br />
  </div>
</body>

</html>