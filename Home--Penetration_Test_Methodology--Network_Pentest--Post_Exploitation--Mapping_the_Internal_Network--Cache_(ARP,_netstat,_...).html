<!doctype html>
<html>

<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <title>Cache (ARP, netstat, ...)</title>
  <meta name="generator" content="CherryTree">
  <link rel="stylesheet" href="res/styles3.css" type="text/css" />
</head>

<body>
  <div class='page'>
    <h1 class='title'>Cache (ARP, netstat, ...)</h1><br /><br /><strong>ARP </strong>(check the <a
      href="ome--Pentesting_Basics--networking--protocols--protocol_layers--IP_protocol_suite_(TCP-IP)--Link_Layer--Address_Resolution_Protocol_(ARP).html">ARP
      chapter</a> also)<br />Look in the ARP table give use remote hosts and devices, which the hosts has recently
    communicated<br />Check the ARP table again later, it may change. If it does this might be an indication of
    scheduled tasks, investigate later<br />
    <div class="codebox">
      <div class="codebox">
        msf&gt;&nbsp;use&nbsp;post/windows/gather/arp_scanner&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#needed&nbsp;meterpreter&nbsp;session<br />root@debian:/#&nbsp;arp&nbsp;-n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#Linux<br />C:\&gt;&nbsp;arp&nbsp;-a&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#Windows
      </div>
    </div><br /> -n → disable name resolution(without generate unnecessary network traffic)<br /> <a href=""><img
        src="images/959-1.png" alt="images/959-1.png" /></a><br />The first 24 bits (3 Bytes) of the HWaddress is the
    <strong>OUI(Organizational Unique Identifier) </strong>in this way is <span
      style="color:#ff0000;">Technicolor</span> a brand of routers<br />We can search who belong the OUI on <a
      href="https://macvendors.com/" target="_blank">https://macvendors.com/</a><br /><br /><strong>netBIOS</strong><br />if we want to
    check the NetBIOS cache of the exploited system<br />
    <div class="codebox">
      <div class="codebox">nbtstat&nbsp;-c&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#Windows</div>
    </div><br />if we want check the NetBIOS of a remote machine see <a
      href="Home--Penetration_Test_Methodology--Network_Pentest--Vulnerability_assessment--Manual_Testing--NetBIOS,_SMB.html">here</a><br />Explanation
    of NetBIOS <a
      href="Home--Penetration_Test_Methodology--Network_Pentest--Vulnerability_assessment--Manual_Testing--NetBIOS,_SMB---p137,139_NetBIOS.html">here</a><br /><br /><strong>TCP/UDP
      connections (netstat)</strong><br />We can check the listening ports on the local computer with
    <strong>netstat</strong> or <strong>TCPview</strong> (<a
      href="asics--networking--protocols--protocol_layers--IP_protocol_suite_(TCP-IP)--Transport_Layer--Ports--view_listening_ports_on_local_computer.html">see
      this chapter</a>)<br /> ◇ What other machines or devices we are currently connected to<br /> ◇ Which ports or
    services on other machines we are connected to<br /> ◇ What ports our current machine are listening on<br /> ◇ Are
    there other systems establishing connections with our current machine<br />
    <div class="codebox">
      <div class="codebox">
        root@debian:/#&nbsp;netstat&nbsp;-pantu&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#linux</div>
    </div><br /> <a href=""><img src="images/959-2.png" alt="images/959-2.png" /></a><br /> -p, --programs → display
    PID/Program name for sockets<br /> -a, --all → display all sockets (default: connected)<br /> -n, --numeric →
    don&#39;t resolve names<br /> -t, --tcp → tcp ports<br /> -u, --udp → udp ports<br /> <br />
    <div class="codebox">
      <div class="codebox">
        root@debian:/#&nbsp;ss&nbsp;-twurp&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#linux
      </div>
    </div><br /> An alternative to netstat<br /> <a href=""><img src="images/959-3.png"
        alt="images/959-3.png" /></a><br /><br />
    <div class="codebox">
      <div class="codebox">
        C:\&gt;&nbsp;netstat&nbsp;-anob&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#windows</div>
    </div><br /> -a → displays all connections and listening ports.<br /> -n → displays addresses and port numbers in
    numerical form.<br /> -o → displays the owning process ID associated with each connection.<br /> -b → displays the
    executable involved in creating each connection or listening port<br /><br /><strong>What if the system is
      restricted and not has netcat?</strong><br />We have to parse the informations from the files<br /> ◇
    /proc/net/tcp<br /> ◇ /proc/net/udp<br />Since the <span style="text-decoration:underline;">addresses and ports in
      these files are hex encoded</span>, they are not particularly user friendly (unless you do all your network
    addressing in hex). <br />awk, can be a swiss army knife for processing these files.<br />Check: <a
      href="https://staaldraad.github.io/2017/12/20/netstat-without-netstat/" target="_blank">https://staaldraad.github.io/2017/12/20/netstat-without-netstat/</a>
  </div>
</body>

</html>